var La=Object.defineProperty;var Ua=(o,e,t)=>e in o?La(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var zn=(o,e,t)=>(Ua(o,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function te(){}const Pa=o=>o;function Sn(o,e){for(const t in e)o[t]=e[t];return o}function ta(o){return o()}function Mo(){return Object.create(null)}function $e(o){o.forEach(ta)}function ht(o){return typeof o=="function"}function ke(o,e){return o!=o?e==e:o!==e||o&&typeof o=="object"||typeof o=="function"}let Nn;function Jt(o,e){return o===e?!0:(Nn||(Nn=document.createElement("a")),Nn.href=e,o===Nn.href)}function Ba(o){return Object.keys(o).length===0}function Qn(o,...e){if(o==null){for(const n of e)n(void 0);return te}const t=o.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function re(o){let e;return Qn(o,t=>e=t)(),e}function se(o,e,t){o.$$.on_destroy.push(Qn(e,t))}function sn(o,e,t,n){if(o){const i=na(o,e,t,n);return o[0](i)}}function na(o,e,t,n){return o[1]&&n?Sn(t.ctx.slice(),o[1](n(e))):t.ctx}function an(o,e,t,n){if(o[2]&&n){const i=o[2](n(t));if(e.dirty===void 0)return i;if(typeof i=="object"){const r=[],l=Math.max(e.dirty.length,i.length);for(let a=0;a<l;a+=1)r[a]=e.dirty[a]|i[a];return r}return e.dirty|i}return e.dirty}function cn(o,e,t,n,i,r){if(i){const l=na(e,t,n,r);o.p(l,i)}}function fn(o){if(o.ctx.length>32){const e=[],t=o.ctx.length/32;for(let n=0;n<t;n++)e[n]=-1;return e}return-1}function Ya(o){const e={};for(const t in o)t[0]!=="$"&&(e[t]=o[t]);return e}function Lo(o,e){const t={};e=new Set(e);for(const n in o)!e.has(n)&&n[0]!=="$"&&(t[n]=o[n]);return t}function Ha(o){const e={};for(const t in o)e[t]=!0;return e}function Et(o){return o??""}function Ga(o){return o&&ht(o.destroy)?o.destroy:te}const oa=typeof window<"u";let Fa=oa?()=>window.performance.now():()=>Date.now(),xn=oa?o=>requestAnimationFrame(o):te;const qt=new Set;function ia(o){qt.forEach(e=>{e.c(o)||(qt.delete(e),e.f())}),qt.size!==0&&xn(ia)}function ja(o){let e;return qt.size===0&&xn(ia),{promise:new Promise(t=>{qt.add(e={c:o,f:t})}),abort(){qt.delete(e)}}}const eo=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function b(o,e){o.appendChild(e)}function ra(o){if(!o)return document;const e=o.getRootNode?o.getRootNode():o.ownerDocument;return e&&e.host?e:o.ownerDocument}function za(o){const e=$("style");return e.textContent="/* empty */",Ka(ra(o),e),e.sheet}function Ka(o,e){return b(o.head||o,e),e.sheet}function _(o,e,t){o.insertBefore(e,t||null)}function g(o){o.parentNode&&o.parentNode.removeChild(o)}function me(o,e){for(let t=0;t<o.length;t+=1)o[t]&&o[t].d(e)}function $(o){return document.createElement(o)}function Ee(o){return document.createElementNS("http://www.w3.org/2000/svg",o)}function C(o){return document.createTextNode(o)}function D(){return C(" ")}function de(){return C("")}function ee(o,e,t,n){return o.addEventListener(e,t,n),()=>o.removeEventListener(e,t,n)}function Lt(o){return function(e){return e.preventDefault(),o.call(this,e)}}function Tt(o){return function(e){return e.stopPropagation(),o.call(this,e)}}function p(o,e,t){t==null?o.removeAttribute(e):o.getAttribute(e)!==t&&o.setAttribute(e,t)}const Wa=["width","height"];function Uo(o,e){const t=Object.getOwnPropertyDescriptors(o.__proto__);for(const n in e)e[n]==null?o.removeAttribute(n):n==="style"?o.style.cssText=e[n]:n==="__value"?o.value=o[n]=e[n]:t[n]&&t[n].set&&Wa.indexOf(n)===-1?o[n]=e[n]:p(o,n,e[n])}function qa(o){return Array.from(o.childNodes)}function J(o,e){e=""+e,o.data!==e&&(o.data=e)}function la(o,e){e=""+e,o.wholeText!==e&&(o.data=e)}function Ne(o,e){o.value=e??""}function ce(o,e,t,n){t==null?o.style.removeProperty(e):o.style.setProperty(e,t,"")}function dt(o,e,t){for(let n=0;n<o.options.length;n+=1){const i=o.options[n];if(i.__value===e){i.selected=!0;return}}(!t||e!==void 0)&&(o.selectedIndex=-1)}function to(o){const e=o.querySelector(":checked");return e&&e.__value}function Oe(o,e,t){o.classList.toggle(e,!!t)}function Va(o,e,{bubbles:t=!1,cancelable:n=!1}={}){return new CustomEvent(o,{detail:e,bubbles:t,cancelable:n})}const Cn=new Map;let Mn=0;function Xa(o){let e=5381,t=o.length;for(;t--;)e=(e<<5)-e^o.charCodeAt(t);return e>>>0}function Ja(o,e){const t={stylesheet:za(e),rules:{}};return Cn.set(o,t),t}function Za(o,e,t,n,i,r,l,a=0){const s=16.666/n;let c=`{
`;for(let w=0;w<=1;w+=s){const O=e+(t-e)*r(w);c+=w*100+`%{${l(O,1-O)}}
`}const f=c+`100% {${l(t,1-t)}}
}`,u=`__svelte_${Xa(f)}_${a}`,d=ra(o),{stylesheet:h,rules:m}=Cn.get(d)||Ja(d,o);m[u]||(m[u]=!0,h.insertRule(`@keyframes ${u} ${f}`,h.cssRules.length));const k=o.style.animation||"";return o.style.animation=`${k?`${k}, `:""}${u} ${n}ms linear ${i}ms 1 both`,Mn+=1,u}function Qa(o,e){const t=(o.style.animation||"").split(", "),n=t.filter(e?r=>r.indexOf(e)<0:r=>r.indexOf("__svelte")===-1),i=t.length-n.length;i&&(o.style.animation=n.join(", "),Mn-=i,Mn||xa())}function xa(){xn(()=>{Mn||(Cn.forEach(o=>{const{ownerNode:e}=o.stylesheet;e&&g(e)}),Cn.clear())})}function ec(o,e,t,n){if(!e)return te;const i=o.getBoundingClientRect();if(e.left===i.left&&e.right===i.right&&e.top===i.top&&e.bottom===i.bottom)return te;const{delay:r=0,duration:l=300,easing:a=Pa,start:s=Fa()+r,end:c=s+l,tick:f=te,css:u}=t(o,{from:e,to:i},n);let d=!0,h=!1,m;function k(){u&&(m=Za(o,0,1,l,r,a,u)),r||(h=!0)}function w(){u&&Qa(o,m),d=!1}return ja(O=>{if(!h&&O>=s&&(h=!0),h&&O>=c&&(f(1,0),w()),!d)return!1;if(h){const I=O-s,T=0+1*a(I/l);f(T,1-T)}return!0}),k(),f(0,1),w}function tc(o){const e=getComputedStyle(o);if(e.position!=="absolute"&&e.position!=="fixed"){const{width:t,height:n}=e,i=o.getBoundingClientRect();o.style.position="absolute",o.style.width=t,o.style.height=n,nc(o,i)}}function nc(o,e){const t=o.getBoundingClientRect();if(e.left!==t.left||e.top!==t.top){const n=getComputedStyle(o),i=n.transform==="none"?"":n.transform;o.style.transform=`${i} translate(${e.left-t.left}px, ${e.top-t.top}px)`}}let un;function rn(o){un=o}function no(){if(!un)throw new Error("Function called outside component initialization");return un}function mt(o){no().$$.on_mount.push(o)}function at(o){no().$$.on_destroy.push(o)}function oc(){const o=no();return(e,t,{cancelable:n=!1}={})=>{const i=o.$$.callbacks[e];if(i){const r=Va(e,t,{cancelable:n});return i.slice().forEach(l=>{l.call(o,r)}),!r.defaultPrevented}return!0}}function dn(o,e){const t=o.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const Wt=[],et=[];let Vt=[];const Po=[],sa=Promise.resolve();let qn=!1;function aa(){qn||(qn=!0,sa.then(fa))}function ca(){return aa(),sa}function Zt(o){Vt.push(o)}const Kn=new Set;let jt=0;function fa(){if(jt!==0)return;const o=un;do{try{for(;jt<Wt.length;){const e=Wt[jt];jt++,rn(e),ic(e.$$)}}catch(e){throw Wt.length=0,jt=0,e}for(rn(null),Wt.length=0,jt=0;et.length;)et.pop()();for(let e=0;e<Vt.length;e+=1){const t=Vt[e];Kn.has(t)||(Kn.add(t),t())}Vt.length=0}while(Wt.length);for(;Po.length;)Po.pop()();qn=!1,Kn.clear(),rn(o)}function ic(o){if(o.fragment!==null){o.update(),$e(o.before_update);const e=o.dirty;o.dirty=[-1],o.fragment&&o.fragment.p(o.ctx,e),o.after_update.forEach(Zt)}}function rc(o){const e=[],t=[];Vt.forEach(n=>o.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),Vt=e}const Tn=new Set;let St;function ne(){St={r:0,c:[],p:St}}function oe(){St.r||$e(St.c),St=St.p}function y(o,e){o&&o.i&&(Tn.delete(o),o.i(e))}function N(o,e,t,n){if(o&&o.o){if(Tn.has(o))return;Tn.add(o),St.c.push(()=>{Tn.delete(o),n&&(t&&o.d(1),n())}),o.o(e)}else n&&n()}function X(o){return(o==null?void 0:o.length)!==void 0?o:Array.from(o)}function oo(o,e){o.d(1),e.delete(o.key)}function Ve(o,e){N(o,1,1,()=>{e.delete(o.key)})}function lc(o,e){o.f(),oo(o,e)}function He(o,e,t,n,i,r,l,a,s,c,f,u){let d=o.length,h=r.length,m=d;const k={};for(;m--;)k[o[m].key]=m;const w=[],O=new Map,I=new Map,T=[];for(m=h;m--;){const A=u(i,r,m),M=t(A);let U=l.get(M);U?T.push(()=>U.p(A,e)):(U=c(M,A),U.c()),O.set(M,w[m]=U),M in k&&I.set(M,Math.abs(m-k[M]))}const E=new Set,R=new Set;function H(A){y(A,1),A.m(a,f),l.set(A.key,A),f=A.first,h--}for(;d&&h;){const A=w[h-1],M=o[d-1],U=A.key,v=M.key;A===M?(f=A.first,d--,h--):O.has(v)?!l.has(U)||E.has(U)?H(A):R.has(v)?d--:I.get(U)>I.get(v)?(R.add(U),H(A)):(E.add(v),d--):(s(M,l),d--)}for(;d--;){const A=o[d];O.has(A.key)||s(A,l)}for(;h;)H(w[h-1]);return $e(T),w}function sc(o,e){const t={},n={},i={$$scope:1};let r=o.length;for(;r--;){const l=o[r],a=e[r];if(a){for(const s in l)s in a||(n[s]=1);for(const s in a)i[s]||(t[s]=a[s],i[s]=1);o[r]=a}else for(const s in l)i[s]=1}for(const l in n)l in t||(t[l]=void 0);return t}function j(o){o&&o.c()}function G(o,e,t){const{fragment:n,after_update:i}=o.$$;n&&n.m(e,t),Zt(()=>{const r=o.$$.on_mount.map(ta).filter(ht);o.$$.on_destroy?o.$$.on_destroy.push(...r):$e(r),o.$$.on_mount=[]}),i.forEach(Zt)}function F(o,e){const t=o.$$;t.fragment!==null&&(rc(t.after_update),$e(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function ac(o,e){o.$$.dirty[0]===-1&&(Wt.push(o),aa(),o.$$.dirty.fill(0)),o.$$.dirty[e/31|0]|=1<<e%31}function we(o,e,t,n,i,r,l=null,a=[-1]){const s=un;rn(o);const c=o.$$={fragment:null,ctx:[],props:r,update:te,not_equal:i,bound:Mo(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(s?s.$$.context:[])),callbacks:Mo(),dirty:a,skip_bound:!1,root:e.target||s.$$.root};l&&l(c.root);let f=!1;if(c.ctx=t?t(o,e.props||{},(u,d,...h)=>{const m=h.length?h[0]:d;return c.ctx&&i(c.ctx[u],c.ctx[u]=m)&&(!c.skip_bound&&c.bound[u]&&c.bound[u](m),f&&ac(o,u)),d}):[],c.update(),f=!0,$e(c.before_update),c.fragment=n?n(c.ctx):!1,e.target){if(e.hydrate){const u=qa(e.target);c.fragment&&c.fragment.l(u),u.forEach(g)}else c.fragment&&c.fragment.c();e.intro&&y(o.$$.fragment),G(o,e.target,e.anchor),fa()}rn(s)}class ye{constructor(){zn(this,"$$");zn(this,"$$set")}$destroy(){F(this,1),this.$destroy=te}$on(e,t){if(!ht(t))return te;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!Ba(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const cc="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(cc);const zt=[];function fc(o,e){return{subscribe:Ae(o,e).subscribe}}function Ae(o,e=te){let t;const n=new Set;function i(a){if(ke(o,a)&&(o=a,t)){const s=!zt.length;for(const c of n)c[1](),zt.push(c,o);if(s){for(let c=0;c<zt.length;c+=2)zt[c][0](zt[c+1]);zt.length=0}}}function r(a){i(a(o))}function l(a,s=te){const c=[a,s];return n.add(c),n.size===1&&(t=e(i,r)||te),a(o),()=>{n.delete(c),n.size===0&&t&&(t(),t=null)}}return{set:i,update:r,subscribe:l}}function Me(o,e,t){const n=!Array.isArray(o),i=n?[o]:o;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const r=e.length<2;return fc(t,(l,a)=>{let s=!1;const c=[];let f=0,u=te;const d=()=>{if(f)return;u();const m=e(n?c[0]:c,l,a);r?l(m):u=ht(m)?m:te},h=i.map((m,k)=>Qn(m,w=>{c[k]=w,f&=~(1<<k),s&&d()},()=>{f|=1<<k}));return s=!0,d(),function(){$e(h),u(),s=!1}})}const it=[{id:"demon",text:"THIS IS THE DEMON",requiresRole:!1},{id:"minions",text:"THESE ARE YOUR MINIONS",requiresRole:!1},{id:"selected_you",text:"THIS CHARACTER SELECTED YOU *",requiresRole:!0},{id:"player_is",text:"THIS PLAYER IS *",requiresRole:!0},{id:"you_are",text:"YOU ARE *",requiresRole:!0},{id:"voted",text:"DID YOU VOTE TODAY?",requiresRole:!1},{id:"nominated",text:"DID YOU NOMINATE TODAY?",requiresRole:!1},{id:"roles_not_in_play",text:"THESE ROLES ARE NOT IN PLAY *",requiresRole:!0},{id:"use_your_ability",text:"USE YOUR ABILITY TONIGHT?",requiresRole:!1},{id:"we_should_chat",text:"WE SHOULD CHAT TOMORROW",requiresRole:!1},{id:"choose_for_your_ability",text:"CHOOSE FOR YOUR ABILITY",requiresRole:!1},{id:"meet_fellow_minions",text:"EYES OPEN AND MEET FELLOW MINIONS",requiresRole:!1},{id:"you_are_good",text:"YOU ARE GOOD",requiresRole:!1},{id:"you_are_evil",text:"YOU ARE EVIL",requiresRole:!1},{id:"role_is_in_play",text:"THIS CHARACTER IS IN PLAY",requiresRole:!1},{id:"mistake",text:"I MADE A MISTAKE, HERE IS MY CORRECTION",requiresRole:!1}],En={steward:{id:"steward",name:"Steward",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"You start knowing 1 good player.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Steward_icon.webp",associatedReminders:["steward.1.KNOW"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},knight:{id:"knight",name:"Knight",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"You start knowing 2 players that are not the Demon.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Knight_icon.webp",associatedReminders:["knight.1.KNOW","knight.2.KNOW"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},chef:{id:"chef",name:"Chef",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"You start knowing how many pairs of evil players there are.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/townsfolk/Chef_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},noble:{id:"noble",name:"Noble",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"You start knowing 3 players, 1 and only 1 of which is evil.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Noble_icon.webp",associatedReminders:["noble.1.KNOW","noble.2.KNOW","noble.3.KNOW"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},investigator:{id:"investigator",name:"Investigator",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"You start knowing that 1 of 2 players is a particular Minion.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/townsfolk/Investigator_icon.webp",associatedReminders:["investigator.1.WRONG","investigator.2.MINION"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},washerwoman:{id:"washerwoman",name:"Washerwoman",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"You start knowing that 1 of 2 players is a particular Townsfolk.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/townsfolk/Washerwoman_icon.webp",associatedReminders:["washerwoman.1.WRONG","washerwoman.2.TOWNSFOLK"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},clockmaker:{id:"clockmaker",name:"Clockmaker",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"You start knowing how many steps from the Demon to its nearest Minion.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/townsfolk/Clockmaker_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},grandmother:{id:"grandmother",name:"Grandmother",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"You start knowing a good player & their character. If the Demon kills them, you die too.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/townsfolk/Grandmother_icon.webp",associatedReminders:["grandmother.1.GRANDCHILD","grandmother.2.DEAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},librarian:{id:"librarian",name:"Librarian",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"You start knowing that 1 of 2 players is a particular Outsider. (Or that zero are in play.)",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/townsfolk/Librarian_icon.webp",associatedReminders:["librarian.1.OUTSIDER","librarian.2.WRONG"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},shugenja:{id:"shugenja",name:"Shugenja",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"You start knowing if your closest evil player is clockwise or anti-clockwise. If equidistant, this info is arbitrary.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Shugenja_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},pixie:{id:"pixie",name:"Pixie",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"You start knowing 1 in-play Townsfolk. If you were mad that you were this character, you gain their ability when they die.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Pixie_icon.webp",associatedReminders:["pixie.1.MAD","pixie.2.HAS ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},bountyhunter:{id:"bountyhunter",name:"Bounty Hunter",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"You start knowing 1 evil player. If the player you know dies, you learn another evil player tonight. [1 Townsfolk is evil]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Bounty%20Hunter_icon.webp",associatedReminders:["bountyhunter.1.KNOWN"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},empath:{id:"empath",name:"Empath",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night, you learn how many of your 2 alive neighbors are evil.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/townsfolk/Empath_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},highpriestess:{id:"highpriestess",name:"High Priestess",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night, learn which player the Storyteller believes you should talk to most.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/High%20Priestess_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},sailor:{id:"sailor",name:"Sailor",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night, choose an alive player: either you or they are drunk until dusk. You can't die.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/townsfolk/Sailor_icon.webp",associatedReminders:["sailor.1.DRUNK"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},balloonist:{id:"balloonist",name:"Balloonist",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night, you learn a player of a different character type than last night. [+0 or +1 Outsider]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Balloonist_icon.webp",associatedReminders:["balloonist.1.KNOWN"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},general:{id:"general",name:"General",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night, you learn which alignment the Storyteller believes is winning: good, evil, or neither.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/General_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},preacher:{id:"preacher",name:"Preacher",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night, choose a player: a Minion, if chosen, learns this. All chosen Minions have no ability.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Preacher_icon.webp",associatedReminders:["preacher.1.NO ABILITY","preacher.2.NO ABILITY","preacher.3.NO ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},chambermaid:{id:"chambermaid",name:"Chambermaid",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night, choose 2 alive players (not yourself): you learn how many woke tonight due to their ability.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/townsfolk/Chambermaid_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},villageidiot:{id:"villageidiot",name:"Village Idiot",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night, choose a player: you learn their alignment. [+0 to +2 Village Idiots. 1 of the extras is drunk]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Village%20Idiot_icon.webp",associatedReminders:["villageidiot.1.DRUNK"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},snakecharmer:{id:"snakecharmer",name:"Snake Charmer",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night, choose an alive player: a chosen Demon swaps characters & alignments with you & is then poisoned.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/townsfolk/Snake%20Charmer_icon.webp",associatedReminders:["snakecharmer.1.POISONED"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},mathematician:{id:"mathematician",name:"Mathematician",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night, you learn how many players' abilities worked abnormally (since dawn) due to another character's ability.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/townsfolk/Mathematician_icon.webp",associatedReminders:["mathematician.1.ABNORMAL","mathematician.2.ABNORMAL","mathematician.3.ABNORMAL","mathematician.4.ABNORMAL","mathematician.5.ABNORMAL"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},king:{id:"king",name:"King",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night, if the dead equal or outnumber the living, you learn 1 alive character. The Demon knows you are the King.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/King_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},dreamer:{id:"dreamer",name:"Dreamer",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night, choose a player (not yourself or Travellers): you learn 1 good & 1 evil character, 1 of which is correct.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/townsfolk/Dreamer_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},fortuneteller:{id:"fortuneteller",name:"Fortune Teller",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night, choose 2 players: you learn if either is a Demon. There is a good player that registers as a Demon to you.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/townsfolk/Fortune%20Teller_icon.webp",associatedReminders:["fortuneteller.1.RED HERRING"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},cultleader:{id:"cultleader",name:"Cult Leader",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night, you become the alignment of an alive neighbor. If all good players choose to join your cult, your team wins.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Cult%20Leader_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},flowergirl:{id:"flowergirl",name:"Flowergirl",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night*, you learn if a Demon voted today.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/townsfolk/Flowergirl_icon.webp",associatedReminders:["flowergirl.1.DEMON NOT VOTED","flowergirl.2.DEMON VOTED"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},towncrier:{id:"towncrier",name:"Town Crier",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night*, you learn if a Minion nominated today.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/townsfolk/Town%20Crier_icon.webp",associatedReminders:["towncrier.1.MINION NOMINATED","towncrier.2.MINIONS NOT NOMINATED"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},oracle:{id:"oracle",name:"Oracle",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night*, you learn how many dead players are evil.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/townsfolk/Oracle_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},undertaker:{id:"undertaker",name:"Undertaker",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night*, you learn which character died by execution today.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/townsfolk/Undertaker_icon.webp",associatedReminders:["undertaker.1.DIED TODAY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},innkeeper:{id:"innkeeper",name:"Innkeeper",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night*, choose 2 players: they can't die tonight, but 1 is drunk until dusk.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/townsfolk/Innkeeper_icon.webp",associatedReminders:["innkeeper.1.DRUNK","innkeeper.2.SAFE","innkeeper.3.SAFE"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},monk:{id:"monk",name:"Monk",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night*, choose a player (not yourself): they are safe from the Demon tonight.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/townsfolk/Monk_icon.webp",associatedReminders:["monk.1.SAFE"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},gambler:{id:"gambler",name:"Gambler",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night*, choose a player & guess their character: if you guess wrong, you die.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/townsfolk/Gambler_icon.webp",associatedReminders:["gambler.1.DEAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},acrobat:{id:"acrobat",name:"Acrobat",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night*, choose a player: if they are or become drunk or poisoned tonight, you die.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Acrobat_icon.webp",associatedReminders:["acrobat.1.DEAD","acrobat.2.CHOSEN"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},lycanthrope:{id:"lycanthrope",name:"Lycanthrope",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night*, choose an alive player. If good, they die & the Demon doesn’t kill tonight. One good player registers as evil.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Lycanthrope_icon.webp",associatedReminders:["lycanthrope.1.DEAD","lycanthrope.2.FAUX PAW"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},exorcist:{id:"exorcist",name:"Exorcist",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each night*, choose a player (different to last night): the Demon, if chosen, learns who you are then doesn't wake tonight.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/townsfolk/Exorcist_icon.webp",associatedReminders:["exorcist.1.CHOSEN"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},gossip:{id:"gossip",name:"Gossip",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each day, you may make a public statement. Tonight, if it was true, a player dies.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/townsfolk/Gossip_icon.webp",associatedReminders:["gossip.1.DEAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},savant:{id:"savant",name:"Savant",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each day, you may visit the Storyteller to learn 2 things in private: 1 is true & 1 is false.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/townsfolk/Savant_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},alsaahir:{id:"alsaahir",name:"Alsaahir",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Each day, if you publicly guess which players are Minion(s) and which are Demon(s), good wins.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Alsaahir_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},engineer:{id:"engineer",name:"Engineer",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Once per game, at night, choose which Minions or which Demon is in play.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Engineer_icon.webp",associatedReminders:["engineer.1.NO ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},nightwatchman:{id:"nightwatchman",name:"Nightwatchman",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Once per game, at night, choose a player: they learn you are the Nightwatchman.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Nightwatchman_icon.webp",associatedReminders:["nightwatchman.1.NO ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},courtier:{id:"courtier",name:"Courtier",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Once per game, at night, choose a character: they are drunk for 3 nights & 3 days.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/townsfolk/Courtier_icon.webp",associatedReminders:["courtier.1.DRUNK 1","courtier.2.NO ABILITY","courtier.3.DRUNK 3","courtier.4.DRUNK 2"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},seamstress:{id:"seamstress",name:"Seamstress",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Once per game, at night, choose 2 players (not yourself): you learn if they are the same alignment.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/townsfolk/Seamstress_icon.webp",associatedReminders:["seamstress.1.NO ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},philosopher:{id:"philosopher",name:"Philosopher",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Once per game, at night, choose a good character: gain that ability. If this character is in play, they are drunk.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/townsfolk/Philosopher_icon.webp",associatedReminders:["philosopher.1.IS THE PHILOSOPHER","philosopher.2.DRUNK"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},huntsman:{id:"huntsman",name:"Huntsman",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Once per game, at night, choose a living player: the Damsel, if chosen, becomes a not-in-play Townsfolk. [+the Damsel]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Huntsman_icon.webp",associatedReminders:["huntsman.1.NO ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},professor:{id:"professor",name:"Professor",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Once per game, at night*, choose a dead player: if they are a Townsfolk, they are resurrected.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/townsfolk/Professor_icon.webp",associatedReminders:["professor.1.NO ABILITY","professor.2.ALIVE"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},artist:{id:"artist",name:"Artist",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Once per game, during the day, privately ask the Storyteller any yes/no question.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/townsfolk/Artist_icon.webp",associatedReminders:["artist.1.NO ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},slayer:{id:"slayer",name:"Slayer",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Once per game, during the day, publicly choose a player: if they are the Demon, they die.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/townsfolk/Slayer_icon.webp",associatedReminders:["slayer.1.NO ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},fisherman:{id:"fisherman",name:"Fisherman",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Once per game, during the day, visit the Storyteller for some advice to help your team win.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Fisherman_icon.webp",associatedReminders:["fisherman.1.NO ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},princess:{id:"princess",name:"Princess",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"On your 1st day, if you nominated & executed a player, the Demon doesn’t kill tonight.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/princess.webp",associatedReminders:["princess.1.DOESN'T KILL"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},juggler:{id:"juggler",name:"Juggler",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"On your 1st day, publicly guess up to 5 players' characters. That night, you learn how many you got correct.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/townsfolk/Juggler_icon.webp",associatedReminders:["juggler.1.CORRECT","juggler.2.CORRECT","juggler.3.CORRECT","juggler.4.CORRECT","juggler.5.CORRECT"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},soldier:{id:"soldier",name:"Soldier",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"You are safe from the Demon.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/townsfolk/Soldier_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},alchemist:{id:"alchemist",name:"Alchemist",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"You have a Minion ability. When using this, the Storyteller may prompt you to choose differently.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Alchemist_icon.webp",associatedReminders:["alchemist.1.IS THE ALCHEMIST"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},cannibal:{id:"cannibal",name:"Cannibal",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"You have the ability of the recently killed executee. If they are evil, you are poisoned until a good player dies by execution.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Cannibal_icon.webp",associatedReminders:["cannibal.1.POISONED","cannibal.2.LUNCH"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},amnesiac:{id:"amnesiac",name:"Amnesiac",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"You do not know what your ability is. Each day, privately guess what it is: you learn how accurate you are.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Amnesiac_icon.webp",associatedReminders:["amnesiac.1.?","amnesiac.2.?","amnesiac.3.?"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},farmer:{id:"farmer",name:"Farmer",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"When you die at night, an alive good player becomes a Farmer.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Farmer_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},minstrel:{id:"minstrel",name:"Minstrel",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"When a Minion dies by execution, all other players (except Travellers) are drunk until dusk tomorrow.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/townsfolk/Minstrel_icon.webp",associatedReminders:["minstrel.1.EVERYONE IS DRUNK"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},ravenkeeper:{id:"ravenkeeper",name:"Ravenkeeper",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"If you die at night, you are woken to choose a player: you learn their character.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/townsfolk/Ravenkeeper_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},sage:{id:"sage",name:"Sage",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"If the Demon kills you, you learn that it is 1 of 2 players.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/townsfolk/Sage_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},choirboy:{id:"choirboy",name:"Choirboy",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"If the Demon kills the King, you learn which player is the Demon. [+the King]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Choirboy_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},banshee:{id:"banshee",name:"Banshee",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:'"If the Demon kills you, all players learn this. From now on, you may nominate twice per day and vote twice per nomination.”',iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Banshee_icon.webp",associatedReminders:["banshee.1.HAS ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},tealady:{id:"tealady",name:"Tea Lady",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"If both your alive neighbors are good, they can't die.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/townsfolk/Tea%20Lady_icon.webp",associatedReminders:["tealady.1.CANNOT DIE","tealady.2.CANNOT DIE"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},mayor:{id:"mayor",name:"Mayor",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"If only 3 players live & no execution occurs, your team wins. If you die at night, another player might die instead.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/townsfolk/Mayor_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},fool:{id:"fool",name:"Fool",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"The 1st time you die, you don't.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/townsfolk/Fool_icon.webp",associatedReminders:["fool.1.NO ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},virgin:{id:"virgin",name:"Virgin",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"The 1st time you are nominated, if the nominator is a Townsfolk, they are executed immediately.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/townsfolk/Virgin_icon.webp",associatedReminders:["virgin.1.NO ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},magician:{id:"magician",name:"Magician",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"The Demon thinks you are a Minion. Minions think you are a Demon.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Magician_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},poppygrower:{id:"poppygrower",name:"Poppy Grower",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Minions & Demons do not know each other. If you die, they learn who each other are that night.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Poppy%20Grower_icon.webp",associatedReminders:["poppygrower.1.EVIL WAKES"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},pacifist:{id:"pacifist",name:"Pacifist",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"Executed good players might not die.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/townsfolk/Pacifist_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},atheist:{id:"atheist",name:"Atheist",category:"Townsfolk",defaultAlignment:"Good",abilityDescription:"The Storyteller can break the game rules, and if executed, good wins, even if you are dead. [No evil characters]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/townsfolk/Atheist_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},hermit:{id:"hermit",name:"Hermit",category:"Outsider",defaultAlignment:"Good",abilityDescription:"You have all Outsider abilities. [-0 or -1 Outsider]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/outsider/hermit.webp",associatedReminders:["hermit.1.1","hermit.2.2","hermit.3.3"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},butler:{id:"butler",name:"Butler",category:"Outsider",defaultAlignment:"Good",abilityDescription:"Each night, choose a player (not yourself): tomorrow, you may only vote if they are voting too.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/outsider/Butler_icon.webp",associatedReminders:["butler.1.MASTER"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},goon:{id:"goon",name:"Goon",category:"Outsider",defaultAlignment:"Good",abilityDescription:"Each night, the 1st player to choose you with their ability is drunk until dusk. You become their alignment.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/outsider/Goon_icon.webp",associatedReminders:["goon.1.DRUNK"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},ogre:{id:"ogre",name:"Ogre",category:"Outsider",defaultAlignment:"Good",abilityDescription:`"On your 1st night, choose a player (not yourself): you become their alignment (you don't know which) even if drunk or poisoned.”`,iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/outsider/Ogre_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},lunatic:{id:"lunatic",name:"Lunatic",category:"Outsider",defaultAlignment:"Good",abilityDescription:"You think you are a Demon, but you are not. The Demon knows who you are & who you choose at night.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/outsider/Lunatic_icon.webp",associatedReminders:["lunatic.1.CHOSEN","lunatic.2.CHOSEN","lunatic.3.CHOSEN"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},drunk:{id:"drunk",name:"Drunk",category:"Outsider",defaultAlignment:"Good",abilityDescription:"You do not know you are the Drunk. You think you are a Townsfolk character, but you are not.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/outsider/Drunk_icon.webp",associatedReminders:["drunk.1.IS THE DRUNK"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},tinker:{id:"tinker",name:"Tinker",category:"Outsider",defaultAlignment:"Good",abilityDescription:"You might die at any time.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/outsider/Tinker_icon.webp",associatedReminders:["tinker.1.DEAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},recluse:{id:"recluse",name:"Recluse",category:"Outsider",defaultAlignment:"Good",abilityDescription:"You might register as evil & as a Minion or Demon, even if dead.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/outsider/Recluse_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},golem:{id:"golem",name:"Golem",category:"Outsider",defaultAlignment:"Good",abilityDescription:"You may only nominate once per game. When you do, if the nominee is not the Demon, they die.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/outsider/Golem_icon.webp",associatedReminders:["golem.1.MAY NOT NOMINATE"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},sweetheart:{id:"sweetheart",name:"Sweetheart",category:"Outsider",defaultAlignment:"Good",abilityDescription:"When you die, 1 player is drunk from now on.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/outsider/Sweetheart_icon.webp",associatedReminders:["sweetheart.1.DRUNK"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},plaguedoctor:{id:"plaguedoctor",name:"Plague Doctor",category:"Outsider",defaultAlignment:"Good",abilityDescription:"When you die, the Storyteller gains a Minion ability.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/outsider/Plague%20Doctor_icon.webp",associatedReminders:["plaguedoctor.1.STORYTELLER ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},klutz:{id:"klutz",name:"Klutz",category:"Outsider",defaultAlignment:"Good",abilityDescription:"When you learn that you died, publicly choose 1 alive player: if they are evil, your team loses.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/outsider/Klutz_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},moonchild:{id:"moonchild",name:"Moonchild",category:"Outsider",defaultAlignment:"Good",abilityDescription:"When you learn that you died, publicly choose 1 alive player. Tonight, if it was a good player, they die.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/outsider/Moonchild_icon.webp",associatedReminders:["moonchild.1.DEAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},saint:{id:"saint",name:"Saint",category:"Outsider",defaultAlignment:"Good",abilityDescription:"If you die by execution, your team loses.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/outsider/Saint_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},barber:{id:"barber",name:"Barber",category:"Outsider",defaultAlignment:"Good",abilityDescription:"If you died today or tonight, the Demon may choose 2 players (not another Demon) to swap characters.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/outsider/Barber_icon.webp",associatedReminders:["barber.1.HAIRCUTS TONIGHT"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},hatter:{id:"hatter",name:"Hatter",category:"Outsider",defaultAlignment:"Good",abilityDescription:"If you died today or tonight, the Minion & Demon players may choose new Minion & Demon characters to be.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/outsider/Hatter_icon.webp",associatedReminders:["hatter.1.TEA PARTY TONIGHT"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},mutant:{id:"mutant",name:"Mutant",category:"Outsider",defaultAlignment:"Good",abilityDescription:'If you are "mad" about being an Outsider, you might be executed.',iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/outsider/Mutant_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},politician:{id:"politician",name:"Politician",category:"Outsider",defaultAlignment:"Good",abilityDescription:"If you were the player most responsible for your team losing, you change alignment & win, even if dead.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/outsider/Politician_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},zealot:{id:"zealot",name:"Zealot",category:"Outsider",defaultAlignment:"Good",abilityDescription:"If there are 5 or more players alive, you must vote for every nomination.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/outsider/Zealot_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},damsel:{id:"damsel",name:"Damsel",category:"Outsider",defaultAlignment:"Good",abilityDescription:"All Minions know a Damsel is in play. If a Minion publicly guesses you (once), your team loses.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/outsider/Damsel_icon.webp",associatedReminders:["damsel.1.GUESS USED"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},snitch:{id:"snitch",name:"Snitch",category:"Outsider",defaultAlignment:"Good",abilityDescription:"Each Minion gets 3 bluffs.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/outsider/Snitch_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},heretic:{id:"heretic",name:"Heretic",category:"Outsider",defaultAlignment:"Good",abilityDescription:"Whoever wins, loses & whoever loses, wins, even if you are dead.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/outsider/Heretic_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},puzzlemaster:{id:"puzzlemaster",name:"Puzzlemaster",category:"Outsider",defaultAlignment:"Good",abilityDescription:"1 player is drunk, even if you die. If you guess (once) who it is, learn the Demon player, but guess wrong & get false info.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/outsider/Puzzlemaster_icon.webp",associatedReminders:["puzzlemaster.1.DRUNK","puzzlemaster.2.GUESS USED"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},mezepheles:{id:"mezepheles",name:"Mezepheles",category:"Minion",defaultAlignment:"Evil",abilityDescription:"You start knowing a secret word. The 1st good player to say this word becomes evil that night.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/minion/Mezepheles_icon.webp",associatedReminders:["mezepheles.1.NO ABILITY","mezepheles.2.TURNS EVIL"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},godfather:{id:"godfather",name:"Godfather",category:"Minion",defaultAlignment:"Evil",abilityDescription:"You start knowing which Outsiders are in play. If 1 died today, choose a player tonight: they die. [-1 or +1 Outsider]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/minion/Godfather_icon.webp",associatedReminders:["godfather.1.DEAD","godfather.2.DIED TODAY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},poisoner:{id:"poisoner",name:"Poisoner",category:"Minion",defaultAlignment:"Evil",abilityDescription:"Each night, choose a player: they are poisoned tonight and tomorrow day.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/minion/Poisoner_icon.webp",associatedReminders:["poisoner.1.POISONED"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},devilsadvocate:{id:"devilsadvocate",name:"Devil's Advocate",category:"Minion",defaultAlignment:"Evil",abilityDescription:"Each night, choose a living player (different to last night): if executed tomorrow, they don't die.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/minion/Devil's%20Advocate_icon.webp",associatedReminders:["devilsadvocate.1.SURVIVES EXECUTION"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},spy:{id:"spy",name:"Spy",category:"Minion",defaultAlignment:"Evil",abilityDescription:"Each night, you see the Grimoire. You might register as good & as a Townsfolk or Outsider, even if dead.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/minion/Spy_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},harpy:{id:"harpy",name:"Harpy",category:"Minion",defaultAlignment:"Evil",abilityDescription:"Each night, choose 2 players: tomorrow, the 1st player is mad that the 2nd is evil, or one or both might die.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/minion/Harpy_icon.webp",associatedReminders:["harpy.1.MAD","harpy.2.2ND"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},witch:{id:"witch",name:"Witch",category:"Minion",defaultAlignment:"Evil",abilityDescription:"Each night, choose a player: if they nominate tomorrow, they die. If just 3 players live, you lose this ability.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/minion/Witch_icon.webp",associatedReminders:["witch.1.CURSED"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},cerenovus:{id:"cerenovus",name:"Cerenovus",category:"Minion",defaultAlignment:"Evil",abilityDescription:'Each night, choose a player & a good character: they are "mad" they are this character tomorrow, or might be executed.',iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/minion/Cerenovus_icon.webp",associatedReminders:["cerenovus.1.MAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},fearmonger:{id:"fearmonger",name:"Fearmonger",category:"Minion",defaultAlignment:"Evil",abilityDescription:"Each night, choose a player: if you nominate & execute them, their team loses. All players know if you choose a new player.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/minion/Fearmonger_icon.webp",associatedReminders:["fearmonger.1.FEAR"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},pithag:{id:"pithag",name:"Pit-Hag",category:"Minion",defaultAlignment:"Evil",abilityDescription:"Each night*, choose a player & a character they become (if not in play). If a Demon is made, deaths tonight are arbitrary.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/minion/Pit-Hag_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},psychopath:{id:"psychopath",name:"Psychopath",category:"Minion",defaultAlignment:"Evil",abilityDescription:"Each day, before nominations, you may publicly choose a player: they die. If executed, you only die if you lose roshambo.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/minion/Psychopath_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},assassin:{id:"assassin",name:"Assassin",category:"Minion",defaultAlignment:"Evil",abilityDescription:"Once per game, at night*, choose a player: they die, even if for some reason they could not.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/minion/Assassin_icon.webp",associatedReminders:["assassin.1.DEAD","assassin.2.NO ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},wizard:{id:"wizard",name:"Wizard",category:"Minion",defaultAlignment:"Evil",abilityDescription:"Once per game, choose to make a wish. If granted, it might have a price & leave a clue as to its nature.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/minion/wizard.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},widow:{id:"widow",name:"Widow",category:"Minion",defaultAlignment:"Evil",abilityDescription:"On your 1st night, look at the Grimoire & choose a player: they are poisoned. 1 good player knows a Widow is in play.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/minion/Widow_icon.webp",associatedReminders:["widow.1.POISONED","widow.2.KNOWS"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},xaan:{id:"xaan",name:"Xaan",category:"Minion",defaultAlignment:"Evil",abilityDescription:"On night X, all Townsfolk are poisoned until dusk. [X Outsiders]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/minion/xaan.webp",associatedReminders:["xaan.1.NIGHT 1","xaan.2.NIGHT 2","xaan.3.NIGHT 3","xaan.4.X"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},marionette:{id:"marionette",name:"Marionette",category:"Minion",defaultAlignment:"Evil",abilityDescription:"You think you are a good character, but you are not. The Demon knows who you are. [You neighbor the Demon]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/minion/Marionette_icon.webp",associatedReminders:["marionette.1.IS THE MARIONETTE"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},wraith:{id:"wraith",name:"Wraith",category:"Minion",defaultAlignment:"Evil",abilityDescription:"You may choose to open your eyes at night. You wake when other evil players do.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/minion/wraith.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},summoner:{id:"summoner",name:"Summoner",category:"Minion",defaultAlignment:"Evil",abilityDescription:"You get 3 bluffs. On the 3rd night, choose a player: they become an evil Demon of your choice. [No Demon]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/minion/Summoner_icon.webp",associatedReminders:["summoner.1.NIGHT 1","summoner.2.NIGHT 2","summoner.3.NIGHT 3"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},eviltwin:{id:"eviltwin",name:"Evil Twin",category:"Minion",defaultAlignment:"Evil",abilityDescription:"You & an opposing player know each other. If the good player is executed, evil wins. Good can't win if you both live.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/minion/Evil%20Twin_icon.webp",associatedReminders:["eviltwin.1.TWIN"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},goblin:{id:"goblin",name:"Goblin",category:"Minion",defaultAlignment:"Evil",abilityDescription:"If you publicly claim to be the Goblin when nominated & are executed that day, your team wins.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/minion/Goblin_icon.webp",associatedReminders:["goblin.1.CLAIMED"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},boomdandy:{id:"boomdandy",name:"Boomdandy",category:"Minion",defaultAlignment:"Evil",abilityDescription:"If you are executed, all but 3 players die. After a 10 to 1 countdown, the player with the most players pointing at them, dies.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/minion/Boomdandy_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},mastermind:{id:"mastermind",name:"Mastermind",category:"Minion",defaultAlignment:"Evil",abilityDescription:"If the Demon dies by execution (ending the game), play for 1 more day. If a player is then executed, their team loses.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/minion/Mastermind_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},scarletwoman:{id:"scarletwoman",name:"Scarlet Woman",category:"Minion",defaultAlignment:"Evil",abilityDescription:"If there are 5 or more players alive & the Demon dies, you become the Demon. (Travellers don't count.)",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/minion/Scarlet%20Woman_icon.webp",associatedReminders:["scarletwoman.1.IS THE DEMON"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},vizier:{id:"vizier",name:"Vizier",category:"Minion",defaultAlignment:"Evil",abilityDescription:"All players know you are the Vizier. You cannot die during the day. If good voted, you may choose to execute immediately.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/minion/Vizier_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},organgrinder:{id:"organgrinder",name:"Organ Grinder",category:"Minion",defaultAlignment:"Evil",abilityDescription:"All players keep their eyes closed when voting and the vote tally is secret. Each night, choose if you are drunk until dusk.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/minion/Organ%20Grinder_icon.webp",associatedReminders:["organgrinder.1.ABOUT TO DIE","organgrinder.2.DRUNK"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},boffin:{id:"boffin",name:"Boffin",category:"Minion",defaultAlignment:"Evil",abilityDescription:"The Demon (even if drunk or poisoned) has a not-in-play good character's ability. You both know which.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/minion/boffin.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},baron:{id:"baron",name:"Baron",category:"Minion",defaultAlignment:"Evil",abilityDescription:"There are extra Outsiders in play. [+2 Outsiders]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/minion/Baron_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},yaggababble:{id:"yaggababble",name:"Yaggababble",category:"Demon",defaultAlignment:"Evil",abilityDescription:"You start knowing a secret phrase. For each time you said it publicly today, a player might die.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/demon/Yaggababble_icon.webp",associatedReminders:["yaggababble.1.DEAD","yaggababble.2.DEAD","yaggababble.3.DEAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},pukka:{id:"pukka",name:"Pukka",category:"Demon",defaultAlignment:"Evil",abilityDescription:"Each night, choose a player: they are poisoned. The previously poisoned player dies then becomes healthy.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/demon/Pukka_icon.webp",associatedReminders:["pukka.1.POISONED","pukka.2.DEAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},lilmonsta:{id:"lilmonsta",name:"Lil' Monsta",category:"Demon",defaultAlignment:"Evil",abilityDescription:`Each night, Minions choose who babysits Lil' Monsta & "is the Demon". Each night*, a player might die. [+1 Minion]`,iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/demon/Lil'%20Monsta_icon.webp",associatedReminders:["lilmonsta.1.Lil' Monsta","lilmonsta.2.DEAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},nodashii:{id:"nodashii",name:"No Dashii",category:"Demon",defaultAlignment:"Evil",abilityDescription:"Each night*, choose a player: they die. Your 2 Townsfolk neighbors are poisoned.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/demon/No%20Dashii_icon.webp",associatedReminders:["nodashii.1.POISONED","nodashii.2.POISONED","nodashii.3.DEAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},imp:{id:"imp",name:"Imp",category:"Demon",defaultAlignment:"Evil",abilityDescription:"Each night*, choose a player: they die. If you kill yourself this way, a Minion becomes the Imp.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/1%20-%20Trouble%20Brewing/demon/Imp_icon.webp",associatedReminders:["imp.1.DEAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},shabaloth:{id:"shabaloth",name:"Shabaloth",category:"Demon",defaultAlignment:"Evil",abilityDescription:"Each night*, choose 2 players: they die. A dead player you chose last night might be regurgitated.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/demon/Shabaloth_icon.webp",associatedReminders:["shabaloth.1.DEAD","shabaloth.2.DEAD","shabaloth.3.ALIVE"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},ojo:{id:"ojo",name:"Ojo",category:"Demon",defaultAlignment:"Evil",abilityDescription:"Each night*, choose a character: they die. If they are not in play, the Storyteller chooses who dies.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/demon/Ojo_icon.webp",associatedReminders:["ojo.1.DEAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},kazali:{id:"kazali",name:"Kazali",category:"Demon",defaultAlignment:"Evil",abilityDescription:"Each night*, choose a player: they die. [You choose which players are which Minions. -? to +? Outsiders]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/demon/Kazali_icon.webp",associatedReminders:["kazali.1.DEAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},po:{id:"po",name:"Po",category:"Demon",defaultAlignment:"Evil",abilityDescription:"Each night*, you may choose a player: they die. If your last choice was no-one, choose 3 players tonight.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/demon/Po_icon.webp",associatedReminders:["po.1.DEAD","po.2.DEAD","po.3.DEAD","po.4.3 ATTACKS"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},zombuul:{id:"zombuul",name:"Zombuul",category:"Demon",defaultAlignment:"Evil",abilityDescription:"Each night*, if no-one died today, choose a player: they die. The 1st time you die, you live but register as dead.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/2%20-%20Bad%20Moon%20Rising/demon/Zombuul_icon.webp",associatedReminders:["zombuul.1.DEAD","zombuul.2.DIED TODAY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},vigormortis:{id:"vigormortis",name:"Vigormortis",category:"Demon",defaultAlignment:"Evil",abilityDescription:"Each night*, choose a player: they die. Minions you kill keep their ability & poison 1 Townsfolk neighbor. [-1 Outsider]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/demon/Vigormortis_icon.webp",associatedReminders:["vigormortis.1.POISONED","vigormortis.2.POISONED","vigormortis.3.POISONED","vigormortis.4.DEAD","vigormortis.5.HAS ABILITY","vigormortis.6.HAS ABILITY","vigormortis.7.HAS ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},vortox:{id:"vortox",name:"Vortox",category:"Demon",defaultAlignment:"Evil",abilityDescription:"Each night*, choose a player: they die. Townsfolk abilities yield false info. Each day, if no-one is executed, evil wins.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/demon/Vortox_icon.webp",associatedReminders:["vortox.1.DEAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},legion:{id:"legion",name:"Legion",category:"Demon",defaultAlignment:"Evil",abilityDescription:"Each night*, a player might die. Executions fail if only evil voted. You register as a Minion too. [Most players are Legion]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/demon/Legion_icon.webp",associatedReminders:["legion.1.ABOUT TO DIE","legion.2.DEAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},fanggu:{id:"fanggu",name:"Fang Gu",category:"Demon",defaultAlignment:"Evil",abilityDescription:"Each night*, choose a player: they die. The 1st Outsider this kills becomes an evil Fang Gu & you die instead. [+1 Outsider]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/3%20-%20Sects%20and%20Violets/demon/Fang%20Gu_icon.webp",associatedReminders:["fanggu.1.DEAD","fanggu.2.ONCE"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},lordoftyphon:{id:"lordoftyphon",name:"Lord of Typhon",category:"Demon",defaultAlignment:"Evil",abilityDescription:"Each night*, choose a player: they die. [Evil characters are in a line. You are in the middle. +1 Minion. -? to +? Outsiders]",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/demon/lordoftyphon_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},lleech:{id:"lleech",name:"Lleech",category:"Demon",defaultAlignment:"Evil",abilityDescription:"Each night*, choose a player: they die. You start by choosing a player: they are poisoned. You die if & only if they are dead.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/demon/Lleech_icon.webp",associatedReminders:["lleech.1.POISONED","lleech.2.DEAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},alhadikhia:{id:"alhadikhia",name:"Al-Hadikhia",category:"Demon",defaultAlignment:"Evil",abilityDescription:"Each night*, you may choose 3 players (all players learn who): each silently chooses to live or die, but if all live, all die.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/demon/Al-Hadikhia_icon.webp",associatedReminders:["alhadikhia.1.1","alhadikhia.2.2","alhadikhia.3.3"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},riot:{id:"riot",name:"Riot",category:"Demon",defaultAlignment:"Evil",abilityDescription:"On day 3, Minions become Riot & nominees die but nominate an alive player immediately. This must happen.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/demon/Riot_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},leviathan:{id:"leviathan",name:"Leviathan",category:"Demon",defaultAlignment:"Evil",abilityDescription:"If more than 1 good player is executed, evil wins. All players know you are in play. After day 5, evil wins.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/4%20-%20Experimental/demon/Leviathan_icon.webp",associatedReminders:["leviathan.1.DAY 5","leviathan.2.DAY 2","leviathan.3.DAY 4","leviathan.4.GOOD PLAYER EXECUTED","leviathan.5.DAY 3","leviathan.6.DAY 1"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},thief:{id:"thief",name:"Thief",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"Each night, choose a player (not yourself): their vote counts negatively tomorrow.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/Thief_icon.webp",associatedReminders:["thief.1.NEGATIVE VOTE"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},bureaucrat:{id:"bureaucrat",name:"Bureaucrat",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"Each night, choose a player (not yourself): their vote counts as 3 votes tomorrow.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/Bureaucrat_icon.webp",associatedReminders:["bureaucrat.1.3 VOTES"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},barista:{id:"barista",name:"Barista",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"Each night, until dusk, 1) a player becomes sober, healthy & gets true info, or 2) their ability works twice. They learn which.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/Barista_icon.webp",associatedReminders:["barista.1.SOBER AND HEALTHY","barista.2.ACTS TWICE"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},harlot:{id:"harlot",name:"Harlot",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"Each night*, choose a living player: if they agree, you learn their character, but you both might die.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/Harlot_icon.webp",associatedReminders:["harlot.1.DEAD","harlot.2.DEAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},butcher:{id:"butcher",name:"Butcher",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"Each day, after the 1st execution, you may nominate again.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/Butcher_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},cacklejack:{id:"cacklejack",name:"Cacklejack",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"Each day, choose a player: a different player changes character tonight.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/cacklejack.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},gunslinger:{id:"gunslinger",name:"Gunslinger",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"Each day, after the 1st vote has been tallied, you may choose a player that voted: they die.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/Gunslinger_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},matron:{id:"matron",name:"Matron",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"Each day, you may choose up to 3 sets of 2 players to swap seats. Players may not leave their seats to talk in private.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/Matron_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},gangster:{id:"gangster",name:"Gangster",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"Once per day, you may choose to kill an alive neighbor, if your other alive neighbor agrees.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/Gangster_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},bonecollector:{id:"bonecollector",name:"Bone Collector",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"Once per game, at night*, choose a dead player: they regain their ability until dusk.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/Bone%20Collector_icon.webp",associatedReminders:["bonecollector.1.NO ABILITY","bonecollector.2.HAS ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},judge:{id:"judge",name:"Judge",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"Once per game, if another player nominated, you may choose to force the current execution to pass or fail.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/Judge_icon.webp",associatedReminders:["judge.1.NO ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},apprentice:{id:"apprentice",name:"Apprentice",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"On your 1st night, you gain a Townsfolk ability (if good) or a Minion ability (if evil).",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/Apprentice_icon.webp",associatedReminders:["apprentice.1.IS THE APPRENTICE"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},beggar:{id:"beggar",name:"Beggar",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"You must use a vote token to vote. If a dead player gives you theirs, you learn their alignment. You are sober and healthy.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/Beggar_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},deviant:{id:"deviant",name:"Deviant",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"If you were funny today, you cannot die by exile.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/Deviant_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},scapegoat:{id:"scapegoat",name:"Scapegoat",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"If a player of your alignment is executed, you might be executed instead.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/Scapegoat_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},gnome:{id:"gnome",name:"Gnome",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"All players start knowing a player of your alignment. You may choose to kill anyone who nominates them.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/gnome_icon.webp",associatedReminders:["gnome.1.AMIGO"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},bishop:{id:"bishop",name:"Bishop",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"Only the Storyteller can nominate. At least 1 opposing player must be nominated each day.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/Bishop_icon.webp",associatedReminders:["bishop.1.NOMINATE EVIL","bishop.2.NOMINATE GOOD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},voudon:{id:"voudon",name:"Voudon",category:"Travellers",defaultAlignment:"Unknown",abilityDescription:"Only you & the dead can vote. They don't need a vote token to do so. A 50% majority isn't required.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/travellers/Voudon_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},angel:{id:"angel",name:"Angel",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"Something bad might happen to whoever is most responsible for the death of a new player.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/Angel_icon.webp",associatedReminders:["angel.1.SOMETHING BAD","angel.2.PROTECTED"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},bootlegger:{id:"bootlegger",name:"Bootlegger",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"This script has homebrew characters or rules.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/Bootlegger_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},buddhist:{id:"buddhist",name:"Buddhist",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"For the first 2 minutes of each day, veteran players may not talk.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/Buddhist_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},deusexfiasco:{id:"deusexfiasco",name:"Deus ex Fiasco",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"At least once per game, the Storyteller will make a mistake, correct it, and publicly admit to it. ",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/deusexfiasco.webp",associatedReminders:["deusexfiasco.1.WHOOPSIE"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},djinn:{id:"djinn",name:"Djinn",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"Use the Djinn's special rule. All players know what it is.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/Djinn_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},doomsayer:{id:"doomsayer",name:"Doomsayer",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"If 4 or more players live, each living player may publicly choose (once per game) that a player of their own alignment dies.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/Doomsayer_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},duchess:{id:"duchess",name:"Duchess",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"Each day, 3 players may choose to visit you. At night*, each visitor learns how many visitors are evil, but 1 gets false info.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/Duchess_icon.webp",associatedReminders:["duchess.1.FALSE INFO","duchess.2.VISITOR","duchess.3.VISITOR"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},ferryman:{id:"ferryman",name:"Ferryman",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"On the final day, all dead players regain their vote token.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/Ferryman_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},fibbin:{id:"fibbin",name:"Fibbin",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"Once per game, 1 good player might get incorrect information.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/Fibbin_icon.webp",associatedReminders:["fibbin.1.NO ABILITY"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},fiddler:{id:"fiddler",name:"Fiddler",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"Once per game, the Demon secretly chooses an opposing player: all players choose which of these 2 players win.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/Fiddler_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},gardener:{id:"gardener",name:"Gardener",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"The Storyteller assigns 1 or more players' characters.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/Gardener_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},hellslibrarian:{id:"hellslibrarian",name:"Hell's Librarian",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"Something bad might happen to whoever talks when the Storyteller has asked for silence.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/Hell's%20Librarian_icon.webp",associatedReminders:["hellslibrarian.1.SOMETHING BAD"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},revolutionary:{id:"revolutionary",name:"Revolutionary",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"2 neighboring players are known to be the same alignment. Once per game, 1 of them registers falsely.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/Revolutionary_icon.webp",associatedReminders:["revolutionary.1.REGISTER FALSELY?"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},sentinel:{id:"sentinel",name:"Sentinel",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"There might be 1 extra or 1 fewer Outsider in play.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/Sentinel_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},spiritofivory:{id:"spiritofivory",name:"Spirit of Ivory",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"There can't be more than 1 extra evil player.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/Spirit%20Of%20Ivory_icon.webp",associatedReminders:[],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},stormcatcher:{id:"stormcatcher",name:"Storm Catcher",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"Name a good character. If in play, they can only die by execution, but evil players learn which player it is.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/Storm%20Catcher_icon.webp",associatedReminders:["stormcatcher.1.SAFE"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""},toymaker:{id:"toymaker",name:"Toymaker",category:"Fabled",defaultAlignment:"Unknown",abilityDescription:"The Demon may choose not to attack & must do this at least once per game. Evil players get normal starting info.",iconUrl:"https://script.bloodontheclocktower.com/images/icon/Extras/fabled/Toymaker_icon.webp",associatedReminders:["toymaker.1.FINAL NIGHT: NO ATTACK"],firstNightOrder:0,otherNightOrder:0,firstNightInstruction:"",otherNightInstruction:""}},Bn=[{meta:{id:"meta_",name:"Trouble Brewing",author:""},roles:["chef","investigator","washerwoman","librarian","empath","fortuneteller","undertaker","monk","slayer","soldier","ravenkeeper","mayor","virgin","butler","drunk","recluse","saint","poisoner","spy","scarletwoman","baron","imp"]},{meta:{id:"meta_",name:"Bad Moon Rising",author:""},roles:["grandmother","sailor","chambermaid","innkeeper","gambler","exorcist","gossip","courtier","professor","minstrel","tealady","fool","pacifist","goon","lunatic","tinker","moonchild","godfather","devilsadvocate","assassin","mastermind","pukka","shabaloth","po","zombuul"]},{meta:{id:"meta_",name:"Sects & Violets",author:""},roles:["clockmaker","snakecharmer","mathematician","dreamer","flowergirl","towncrier","oracle","savant","seamstress","philosopher","artist","juggler","sage","sweetheart","klutz","barber","mutant","witch","cerenovus","pithag","eviltwin","nodashii","vigormortis","vortox","fanggu"]}],uc={focusMode:!0,activeSessionUuid:null,draggingPlayer:null,draggingReminder:null,showEditModal:!1,showAddPlayerModal:!1,showAddReminderModal:!1,showNightOrderModal:!1,showCardSelectionModal:!1,showCardModal:!1,showRoleSelectionModal:!1,showSetupModal:!1,showSettingsModal:!1,showRulesModal:!1,showScriptAlmanacModal:!1,showToolsModal:!1,showScriptSelectionModal:!1,showSetPlayerCountModal:!1,showArrangePlayersModal:!1,showTokenBagModal:!1,showSessionsModal:!1,showAddTravellers:!1,showNameAssignerModal:!1,showNotesModal:!1,showNametags:!0,showRolenames:!0,showAbilityTags:!1,showNightLines:!0,showReminderLines:!0,showBackground:!0,iconSource:"scripttool",showHiddenTokens:!0,misregisterIndicators:{},currentCard:null,roleSelectionContext:null,selectedRoles:[],showReminderContextModal:!1,showMoveReminderModal:!1,currentReminder:null,editingPlayer:null,addingPlayerRole:"washerwoman",addingReminderId:"poisoned",addingReminderAttachedTo:null,currentNightType:"first",selectedRoleForCard:null,previouslySelectedRoles:[],playerExplanationId:null,nightOrderScrollFirst:0,nightOrderScrollOther:0,counters:{playerId:1,reminderId:1},tokenBagOrder:[],tokenBagSwiped:[],showBluffsModal:!1,pendingInsertRoles:[]},q=Ae(uc),ua="botc-gameState",da="botc-customCards",dc=Bn.find(o=>o.meta.name==="Trouble Brewing"),hc={playerTokens:[],ReminderTokens:[],script:dc,basePlayersCount:7,bluffSets:[]};let ut=hc;var xs;if(typeof window<"u"){const o=localStorage.getItem(ua);if(o)try{ut=JSON.parse(o)}catch{console.warn("Invalid gameState in localStorage, using defaults")}if((xs=ut.playerTokens)!=null&&xs.length&&!ut.ReminderTokens){const e=[];for(const t of ut.playerTokens)for(const n of t.out_reminders??[])e.push({id:n.id,reminderId:n.reminderId,ownerId:t.id,attachedToId:t.id,customText:n.customText});ut.ReminderTokens=e,ut.playerTokens=ut.playerTokens.map(t=>({...t,in_reminders:[],out_reminders:[]}))}}const ae=Ae(ut);typeof window<"u"&&ae.subscribe(o=>{localStorage.setItem(ua,JSON.stringify(o))});let ha=ut;const mc=ae.subscribe(o=>ha=o);function _n(){return ha}const Re=Me(ae,o=>{const e={};for(const t of o.script.roles)En[t]&&(e[t]=En[t]);for(const[t,n]of Object.entries(En))(n.category==="Travellers"||n.category==="Fabled")&&(e[t]=n);return e});function pc(){if(typeof window>"u")return[];try{const o=localStorage.getItem(da)||"[]",e=JSON.parse(o);return Array.isArray(e)?e:[]}catch{return console.warn("Invalid customCards in localStorage, resetting to empty array"),[]}}const Dt=Ae(pc());typeof window<"u"&&Dt.subscribe(o=>{localStorage.setItem(da,JSON.stringify(o))});const io=Me(Dt,o=>{const e=new Set(o.map(n=>n.id));return[...it.filter(n=>!e.has(n.id)),...o]});function gc(o){Dt.update(e=>{const t=e.findIndex(n=>n.id===o.id);return t!==-1?[...e.slice(0,t),{...o},...e.slice(t+1)]:[...e,{...o}]})}function _c(o){Dt.update(e=>e.filter(t=>t.id!==o))}var ea;if(typeof window<"u"){const o=ut;if((ea=o.ReminderTokens)!=null&&ea.length){const e=Math.max(...o.ReminderTokens.map(t=>t.id));q.update(t=>({...t,counters:{...t.counters,reminderId:e+1}}))}}const bc={5:{Townsfolk:3,Outsiders:0,Minions:1,Demons:1},6:{Townsfolk:3,Outsiders:1,Minions:1,Demons:1},7:{Townsfolk:5,Outsiders:0,Minions:1,Demons:1},8:{Townsfolk:5,Outsiders:1,Minions:1,Demons:1},9:{Townsfolk:5,Outsiders:2,Minions:1,Demons:1},10:{Townsfolk:7,Outsiders:0,Minions:2,Demons:1},11:{Townsfolk:7,Outsiders:1,Minions:2,Demons:1},12:{Townsfolk:7,Outsiders:2,Minions:2,Demons:1},13:{Townsfolk:9,Outsiders:0,Minions:3,Demons:1},14:{Townsfolk:9,Outsiders:1,Minions:3,Demons:1},15:{Townsfolk:9,Outsiders:2,Minions:3,Demons:1}};function hn(o){const e=bc[o];if(!e)throw new RangeError(`Unsupported player count: ${o}`);return e}const ma="botc-layoutState";let pa={playerPositions:{},reminderPositions:{}};if(typeof window<"u"){const o=localStorage.getItem(ma);if(o)try{pa=JSON.parse(o)}catch{console.warn("Invalid layoutState in localStorage, using empty defaults")}}const Te=Ae(pa);typeof window<"u"&&Te.subscribe(o=>{try{localStorage.setItem(ma,JSON.stringify(o))}catch{console.warn("Failed to save layoutState to localStorage")}});function ga(o){const t=re(Re)[o];if(!t)throw new Error(`Unknown role "${o}"`);return t.category}function _t(o,e){return e.find(t=>t.id===o)}function Ln(o){const t=re(Re)[o];return(t==null?void 0:t.name)??o}function Vn(o){return _n().playerTokens.filter(t=>t.roleId===o)}function kc(o){return Bn.find(e=>e.meta.name===o)}const wc=Me([ae,Re],([o,e])=>o.playerTokens.filter(t=>{const n=e[t.roleId];return(n==null?void 0:n.category)!=="Travellers"}).length),yc=Me([ae,Re],([o,e])=>o.playerTokens.filter(t=>t.alive).filter(t=>{var n;return((n=e[t.roleId])==null?void 0:n.category)==="Demon"}).length);function Bo(o){q.update(e=>{const t={...e};return t.currentCard={...o},t.showCardSelectionModal=!1,t.showCardModal=!0,o.requiresRole&&(!o.roles||o.roles.length===0)&&(t.showRoleSelectionModal=!0,t.roleSelectionContext="card",t.selectedRoles=[]),t})}function In(o,e){ae.set({playerTokens:[],ReminderTokens:[],script:{meta:o,roles:e.map(t=>typeof t=="string"?t:t.id)},basePlayersCount:7,bluffSets:[]}),q.update(t=>({...t,counters:{playerId:1,reminderId:1}})),Te.set({playerPositions:{},reminderPositions:{}})}const _a="botc-sessions";function $c(){if(typeof window>"u")return[];try{const o=localStorage.getItem(_a);return o?JSON.parse(o):[]}catch{return console.warn("Invalid sessions in localStorage, resetting to empty array"),[]}}const Ke=Ae($c());typeof window<"u"&&Ke.subscribe(o=>{try{localStorage.setItem(_a,JSON.stringify(o))}catch{console.warn("Failed to save sessions to localStorage")}});function Yo(o){return o.name&&o.name.trim()?o.name.trim():o.gameState.script.meta.name||"Untitled Session"}function on(o=!1){const e=re(Ke);let t=re(q).activeSessionUuid??null;if(!t&&typeof window<"u"){const r=localStorage.getItem("botc-active-session");r&&(t=r,q.update(l=>({...l,activeSessionUuid:r})))}if(!o&&t){const r=e.find(l=>l.uuid===t);if(r)return Xn(r.uuid),r}if(!o&&e.length>0){const r=e.at(-1);return Xn(r.uuid),q.update(l=>({...l,activeSessionUuid:r.uuid})),typeof window<"u"&&localStorage.setItem("botc-active-session",r.uuid),r}const n={uuid:crypto.randomUUID(),name:null,gameState:structuredClone(re(ae)),layout:structuredClone(re(Te)),customCards:structuredClone(re(Dt)),notes:""},i=[...e,n];return Ke.set(i),q.update(r=>({...r,activeSessionUuid:n.uuid})),typeof window<"u"&&localStorage.setItem("botc-active-session",n.uuid),n}function Xn(o){const t=re(Ke).find(n=>n.uuid===o);return t?(ae.set(structuredClone(t.gameState)),Te.set(structuredClone(t.layout)),Dt.set(structuredClone(t.customCards)),q.update(n=>({...n,activeSessionUuid:o})),typeof window<"u"&&localStorage.setItem("botc-active-session",o),!0):!1}function Ct(){const o=re(Ke),e=re(q).activeSessionUuid;if(!e)return;const t=o.findIndex(r=>r.uuid===e);if(t===-1)return;const n={...o[t],gameState:structuredClone(re(ae)),layout:structuredClone(re(Te)),customCards:structuredClone(re(Dt))},i=[...o];i[t]=n,Ke.set(i)}function vc(o){const e=re(q).activeSessionUuid;o!==e&&Ke.update(t=>t.filter(n=>n.uuid!==o))}function Nc(o,e){Ke.update(t=>t.map(n=>n.uuid===o?{...n,name:e.trim()||null}:n))}function Ic(){return JSON.stringify(re(Ke),null,2)}function Oc(o){try{const e=JSON.parse(o),t=re(Ke),n=new Set(t.map(r=>r.uuid)),i=e.filter(r=>!n.has(r.uuid));return i.length>0&&Ke.set([...t,...i]),i.length}catch{return alert("Invalid sessions file."),0}}function Rc(o,e=400){let t;return(...n)=>{clearTimeout(t),t=window.setTimeout(()=>o(...n),e)}}if(typeof window<"u"){const o=Rc(Ct,400);ae.subscribe(o),Te.subscribe(o),Dt.subscribe(o),window.addEventListener("beforeunload",Ct)}function Ho(o){let e,t=o[0]&&Go();return{c(){e=$("span"),t&&t.c(),p(e,"class","tickbox svelte-hwatpq"),p(e,"aria-hidden","true")},m(n,i){_(n,e,i),t&&t.m(e,null)},p(n,i){n[0]?t||(t=Go(),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},d(n){n&&g(e),t&&t.d()}}}function Go(o){let e;return{c(){e=C("✓")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Tc(o){let e,t,n,i,r,l,a,s=o[1]==="checkbox"&&Ho(o);const c=o[6].default,f=sn(c,o,o[5],null);let u=[{class:n=`btn ${o[1]} ${o[0]?"checked":""}`},{disabled:o[2]},{"aria-pressed":i=o[1]==="checkbox"?o[0]:void 0},o[4]],d={};for(let h=0;h<u.length;h+=1)d=Sn(d,u[h]);return{c(){e=$("button"),s&&s.c(),t=D(),f&&f.c(),Uo(e,d),Oe(e,"svelte-hwatpq",!0)},m(h,m){_(h,e,m),s&&s.m(e,null),b(e,t),f&&f.m(e,null),e.autofocus&&e.focus(),r=!0,l||(a=ee(e,"click",o[3]),l=!0)},p(h,[m]){h[1]==="checkbox"?s?s.p(h,m):(s=Ho(h),s.c(),s.m(e,t)):s&&(s.d(1),s=null),f&&f.p&&(!r||m&32)&&cn(f,c,h,h[5],r?an(c,h[5],m,null):fn(h[5]),null),Uo(e,d=sc(u,[(!r||m&3&&n!==(n=`btn ${h[1]} ${h[0]?"checked":""}`))&&{class:n},(!r||m&4)&&{disabled:h[2]},(!r||m&3&&i!==(i=h[1]==="checkbox"?h[0]:void 0))&&{"aria-pressed":i},m&16&&h[4]])),Oe(e,"svelte-hwatpq",!0)},i(h){r||(y(f,h),r=!0)},o(h){N(f,h),r=!1},d(h){h&&g(e),s&&s.d(),f&&f.d(h),l=!1,a()}}}function Ec(o,e,t){const n=["type","disabled","checked"];let i=Lo(e,n),{$$slots:r={},$$scope:l}=e,{type:a="primary"}=e,{disabled:s=!1}=e,{checked:c=!1}=e;const f=oc();function u(d){s||(a==="checkbox"&&(t(0,c=!c),f("toggle",c)),f("click",d))}return o.$$set=d=>{e=Sn(Sn({},e),Ya(d)),t(4,i=Lo(e,n)),"type"in d&&t(1,a=d.type),"disabled"in d&&t(2,s=d.disabled),"checked"in d&&t(0,c=d.checked),"$$scope"in d&&t(5,l=d.$$scope)},[c,a,s,u,i,l,r]}class Z extends ye{constructor(e){super(),we(this,e,Ec,Tc,ke,{type:1,disabled:2,checked:0})}}const Dc=o=>({}),Fo=o=>({}),Ac=o=>({}),jo=o=>({}),Sc=o=>({}),zo=o=>({});function Ko(o){let e,t,n,i,r,l,a,s,c=!o[3]&&Wo(o);const f=o[16].default,u=sn(f,o,o[20],null);let d=(!o[3]&&(o[9]["footer-left"]||o[9].footer)||o[3]&&o[4]&&(o[9]["footer-left"]||o[9].footer))&&qo(o);return{c(){e=$("dialog"),c&&c.c(),t=D(),n=$("section"),u&&u.c(),i=D(),d&&d.c(),p(n,"class","modal-body svelte-1gfk8"),p(e,"class",r="modal "+(o[3]?"fullscreen":"")+" "+(o[3]&&o[4]&&(o[9]["footer-left"]||o[9].footer)?"has-footer":"")+" svelte-1gfk8"),p(e,"aria-labelledby","modal-title"),p(e,"aria-modal","true"),ce(e,"--backdrop-alpha",o[2]&&o[6]?1:o[3]?.95:.8)},m(h,m){_(h,e,m),c&&c.m(e,null),b(e,t),b(e,n),u&&u.m(n,null),b(e,i),d&&d.m(e,null),o[19](e),l=!0,a||(s=[Ga(o[8].call(null,e)),ee(e,"cancel",Lt(o[7]))],a=!0)},p(h,m){h[3]?c&&(ne(),N(c,1,1,()=>{c=null}),oe()):c?(c.p(h,m),m&8&&y(c,1)):(c=Wo(h),c.c(),y(c,1),c.m(e,t)),u&&u.p&&(!l||m&1048576)&&cn(u,f,h,h[20],l?an(f,h[20],m,null):fn(h[20]),null),!h[3]&&(h[9]["footer-left"]||h[9].footer)||h[3]&&h[4]&&(h[9]["footer-left"]||h[9].footer)?d?(d.p(h,m),m&536&&y(d,1)):(d=qo(h),d.c(),y(d,1),d.m(e,null)):d&&(ne(),N(d,1,1,()=>{d=null}),oe()),(!l||m&536&&r!==(r="modal "+(h[3]?"fullscreen":"")+" "+(h[3]&&h[4]&&(h[9]["footer-left"]||h[9].footer)?"has-footer":"")+" svelte-1gfk8"))&&p(e,"class",r),(!l||m&76)&&ce(e,"--backdrop-alpha",h[2]&&h[6]?1:h[3]?.95:.8)},i(h){l||(y(c),y(u,h),y(d),l=!0)},o(h){N(c),N(u,h),N(d),l=!1},d(h){h&&g(e),c&&c.d(),u&&u.d(h),d&&d.d(),o[19](null),a=!1,$e(s)}}}function Wo(o){let e,t,n,i,r;const l=o[16]["header-actions"],a=sn(l,o,o[20],zo);return{c(){e=$("header"),t=$("h2"),n=C(o[1]),i=D(),a&&a.c(),p(t,"id","modal-title"),p(t,"class","svelte-1gfk8"),p(e,"class","modal-header svelte-1gfk8")},m(s,c){_(s,e,c),b(e,t),b(t,n),b(e,i),a&&a.m(e,null),r=!0},p(s,c){(!r||c&2)&&J(n,s[1]),a&&a.p&&(!r||c&1048576)&&cn(a,l,s,s[20],r?an(l,s[20],c,Sc):fn(s[20]),zo)},i(s){r||(y(a,s),r=!0)},o(s){N(a,s),r=!1},d(s){s&&g(e),a&&a.d(s)}}}function qo(o){let e,t,n,i,r,l,a,s=o[2]&&Vo(o);const c=o[16]["footer-left"],f=sn(c,o,o[20],jo),u=o[16].footer,d=sn(u,o,o[20],Fo);return{c(){e=$("footer"),t=$("div"),s&&s.c(),n=D(),f&&f.c(),i=D(),r=$("div"),d&&d.c(),p(t,"class","footer-left svelte-1gfk8"),p(r,"class","footer-right svelte-1gfk8"),p(e,"class",l="modal-footer "+(o[3]?"fullscreen-footer":"")+" svelte-1gfk8")},m(h,m){_(h,e,m),b(e,t),s&&s.m(t,null),b(t,n),f&&f.m(t,null),b(e,i),b(e,r),d&&d.m(r,null),a=!0},p(h,m){h[2]?s?(s.p(h,m),m&4&&y(s,1)):(s=Vo(h),s.c(),y(s,1),s.m(t,n)):s&&(ne(),N(s,1,1,()=>{s=null}),oe()),f&&f.p&&(!a||m&1048576)&&cn(f,c,h,h[20],a?an(c,h[20],m,Ac):fn(h[20]),jo),d&&d.p&&(!a||m&1048576)&&cn(d,u,h,h[20],a?an(u,h[20],m,Dc):fn(h[20]),Fo),(!a||m&8&&l!==(l="modal-footer "+(h[3]?"fullscreen-footer":"")+" svelte-1gfk8"))&&p(e,"class",l)},i(h){a||(y(s),y(f,h),y(d,h),a=!0)},o(h){N(s),N(f,h),N(d,h),a=!1},d(h){h&&g(e),s&&s.d(),f&&f.d(h),d&&d.d(h)}}}function Vo(o){let e,t,n,i;const r=[Mc,Cc],l=[];function a(s,c){return s[6]?0:1}return e=a(o),t=l[e]=r[e](o),{c(){t.c(),n=de()},m(s,c){l[e].m(s,c),_(s,n,c),i=!0},p(s,c){let f=e;e=a(s),e!==f&&(ne(),N(l[f],1,1,()=>{l[f]=null}),oe(),t=l[e],t||(t=l[e]=r[e](s),t.c()),y(t,1),t.m(n.parentNode,n))},i(s){i||(y(t),i=!0)},o(s){N(t),i=!1},d(s){s&&g(n),l[e].d(s)}}}function Cc(o){let e,t;return e=new Z({props:{$$slots:{default:[Lc]},$$scope:{ctx:o}}}),e.$on("click",o[18]),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Mc(o){let e,t;return e=new Z({props:{type:"cancel",$$slots:{default:[Uc]},$$scope:{ctx:o}}}),e.$on("click",o[17]),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Lc(o){let e;return{c(){e=C("Focus")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Uc(o){let e;return{c(){e=C("Exit Focus")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Pc(o){let e,t,n=o[0]&&Ko(o);return{c(){n&&n.c(),e=de()},m(i,r){n&&n.m(i,r),_(i,e,r),t=!0},p(i,[r]){i[0]?n?(n.p(i,r),r&1&&y(n,1)):(n=Ko(i),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(ne(),N(n,1,1,()=>{n=null}),oe())},i(i){t||(y(n),t=!0)},o(i){N(n),t=!1},d(i){i&&g(e),n&&n.d(i)}}}function Bc(o,e,t){let n,i;se(o,q,P=>t(15,i=P));let{$$slots:r={},$$scope:l}=e;const a=Ha(r);let{show:s=!1}=e,{onClose:c=()=>{}}=e,{title:f=""}=e,{focusmodeAllowed:u=!1}=e,{fullscreen:d=!1}=e,{showFooterInFullscreen:h=!1}=e,{backdropClosable:m=!0}=e,{realFullscreen:k=!1}=e;const w=Ae([]);let O,I=0;function T(){u&&n?q.update(P=>({...P,focusMode:!1})):c()}function E(P){P.preventDefault(),T()}function R(P){function K(V){if(!m||performance.now()-I<150)return;const le=P.getBoundingClientRect();V.clientX>=le.left&&V.clientX<=le.right&&V.clientY>=le.top&&V.clientY<=le.bottom||T()}return P.addEventListener("pointerdown",K,{passive:!0}),{destroy:()=>P.removeEventListener("pointerdown",K)}}let H=!1;async function A(){var P;if(!(!O||!s||!d||!k))try{document.fullscreenElement!==O&&(await((P=O.requestFullscreen)==null?void 0:P.call(O)),H=!0)}catch{}}async function M(){var P;if(H&&document.fullscreenElement===O){try{await((P=document.exitFullscreen)==null?void 0:P.call(document))}catch{}H=!1}}at(()=>{var P;w.update(K=>{var le;const V=K.filter(he=>he!==O);return(le=V.at(-1))==null||le.focus(),V}),document.fullscreenElement===O&&((P=document.exitFullscreen)==null||P.call(document)),v==null||v(),Y(),O==null||O.classList.remove("auto-fade"),O==null||O.classList.remove("footer-visible")});let U=null,v=null;function Y(){U!==null&&(clearTimeout(U),U=null)}function W(){O&&(O.classList.add("auto-fade"),O.classList.add("footer-visible"),Y(),U=window.setTimeout(()=>{O==null||O.classList.remove("footer-visible"),U=null},1e3))}function z(){if(v)return;const P=()=>W();document.addEventListener("pointerdown",P,{passive:!0}),document.addEventListener("pointermove",P,{passive:!0}),document.addEventListener("touchstart",P,{passive:!0}),t(14,v=()=>{document.removeEventListener("pointerdown",P),document.removeEventListener("pointermove",P),document.removeEventListener("touchstart",P),t(14,v=null)})}const B=()=>q.update(P=>({...P,focusMode:!1})),L=()=>q.update(P=>({...P,focusMode:!0}));function S(P){et[P?"unshift":"push"](()=>{O=P,t(5,O)})}return o.$$set=P=>{"show"in P&&t(0,s=P.show),"onClose"in P&&t(10,c=P.onClose),"title"in P&&t(1,f=P.title),"focusmodeAllowed"in P&&t(2,u=P.focusmodeAllowed),"fullscreen"in P&&t(3,d=P.fullscreen),"showFooterInFullscreen"in P&&t(4,h=P.showFooterInFullscreen),"backdropClosable"in P&&t(11,m=P.backdropClosable),"realFullscreen"in P&&t(12,k=P.realFullscreen),"$$scope"in P&&t(20,l=P.$$scope)},o.$$.update=()=>{o.$$.dirty&32768&&t(6,n=i.focusMode),o.$$.dirty&33&&(s&&O?(O.open||(O.showModal(),I=performance.now()),w.update(P=>P.includes(O)?P:[...P,O]),O.focus()):O&&(O.open&&O.close(),w.update(P=>P.filter(K=>K!==O)))),o.$$.dirty&4105&&(s&&d&&k?A():M()),o.$$.dirty&16441&&(s&&O&&d&&h&&(!!a["footer-left"]||!!a.footer)?(z(),W()):(v==null||v(),Y(),O==null||O.classList.remove("auto-fade"),O==null||O.classList.remove("footer-visible")))},[s,f,u,d,h,O,n,E,R,a,c,m,k,w,v,i,r,B,L,S,l]}class De extends ye{constructor(e){super(),we(this,e,Bc,Pc,ke,{show:0,onClose:10,title:1,focusmodeAllowed:2,fullscreen:3,showFooterInFullscreen:4,backdropClosable:11,realFullscreen:12,openModals:13})}get openModals(){return this.$$.ctx[13]}}const Qt={"steward.1.KNOW":{id:"steward.1.KNOW",text:"KNOW",description:"Reminder token"},"knight.1.KNOW":{id:"knight.1.KNOW",text:"KNOW",description:"Reminder token"},"knight.2.KNOW":{id:"knight.2.KNOW",text:"KNOW",description:"Reminder token"},"noble.1.KNOW":{id:"noble.1.KNOW",text:"KNOW",description:"Reminder token"},"noble.2.KNOW":{id:"noble.2.KNOW",text:"KNOW",description:"Reminder token"},"noble.3.KNOW":{id:"noble.3.KNOW",text:"KNOW",description:"Reminder token"},"investigator.1.WRONG":{id:"investigator.1.WRONG",text:"WRONG",description:"Reminder token"},"investigator.2.MINION":{id:"investigator.2.MINION",text:"MINION",description:"Reminder token"},"washerwoman.1.WRONG":{id:"washerwoman.1.WRONG",text:"WRONG",description:"Reminder token"},"washerwoman.2.TOWNSFOLK":{id:"washerwoman.2.TOWNSFOLK",text:"TOWNSFOLK",description:"Reminder token"},"grandmother.1.GRANDCHILD":{id:"grandmother.1.GRANDCHILD",text:"GRANDCHILD",description:"Reminder token"},"grandmother.2.DEAD":{id:"grandmother.2.DEAD",text:"DEAD",description:"Reminder token"},"librarian.1.OUTSIDER":{id:"librarian.1.OUTSIDER",text:"OUTSIDER",description:"Reminder token"},"librarian.2.WRONG":{id:"librarian.2.WRONG",text:"WRONG",description:"Reminder token"},"pixie.1.MAD":{id:"pixie.1.MAD",text:"MAD",description:"Reminder token"},"pixie.2.HAS ABILITY":{id:"pixie.2.HAS ABILITY",text:"HAS ABILITY",description:"Reminder token"},"bountyhunter.1.KNOWN":{id:"bountyhunter.1.KNOWN",text:"KNOWN",description:"Reminder token"},"sailor.1.DRUNK":{id:"sailor.1.DRUNK",text:"DRUNK",description:"Reminder token"},"balloonist.1.KNOWN":{id:"balloonist.1.KNOWN",text:"KNOWN",description:"Reminder token"},"preacher.1.NO ABILITY":{id:"preacher.1.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"preacher.2.NO ABILITY":{id:"preacher.2.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"preacher.3.NO ABILITY":{id:"preacher.3.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"villageidiot.1.DRUNK":{id:"villageidiot.1.DRUNK",text:"DRUNK",description:"Reminder token"},"snakecharmer.1.POISONED":{id:"snakecharmer.1.POISONED",text:"POISONED",description:"Reminder token"},"mathematician.1.ABNORMAL":{id:"mathematician.1.ABNORMAL",text:"ABNORMAL",description:"Reminder token"},"mathematician.2.ABNORMAL":{id:"mathematician.2.ABNORMAL",text:"ABNORMAL",description:"Reminder token"},"mathematician.3.ABNORMAL":{id:"mathematician.3.ABNORMAL",text:"ABNORMAL",description:"Reminder token"},"mathematician.4.ABNORMAL":{id:"mathematician.4.ABNORMAL",text:"ABNORMAL",description:"Reminder token"},"mathematician.5.ABNORMAL":{id:"mathematician.5.ABNORMAL",text:"ABNORMAL",description:"Reminder token"},"fortuneteller.1.RED HERRING":{id:"fortuneteller.1.RED HERRING",text:"RED HERRING",description:"Reminder token"},"flowergirl.1.DEMON NOT VOTED":{id:"flowergirl.1.DEMON NOT VOTED",text:"DEMON NOT VOTED",description:"Reminder token"},"flowergirl.2.DEMON VOTED":{id:"flowergirl.2.DEMON VOTED",text:"DEMON VOTED",description:"Reminder token"},"towncrier.1.MINION NOMINATED":{id:"towncrier.1.MINION NOMINATED",text:"MINION NOMINATED",description:"Reminder token"},"towncrier.2.MINIONS NOT NOMINATED":{id:"towncrier.2.MINIONS NOT NOMINATED",text:"MINIONS NOT NOMINATED",description:"Reminder token"},"undertaker.1.DIED TODAY":{id:"undertaker.1.DIED TODAY",text:"DIED TODAY",description:"Reminder token"},"innkeeper.1.DRUNK":{id:"innkeeper.1.DRUNK",text:"DRUNK",description:"Reminder token"},"innkeeper.2.SAFE":{id:"innkeeper.2.SAFE",text:"SAFE",description:"Reminder token"},"innkeeper.3.SAFE":{id:"innkeeper.3.SAFE",text:"SAFE",description:"Reminder token"},"monk.1.SAFE":{id:"monk.1.SAFE",text:"SAFE",description:"Reminder token"},"gambler.1.DEAD":{id:"gambler.1.DEAD",text:"DEAD",description:"Reminder token"},"acrobat.1.DEAD":{id:"acrobat.1.DEAD",text:"DEAD",description:"Reminder token"},"acrobat.2.CHOSEN":{id:"acrobat.2.CHOSEN",text:"CHOSEN",description:"Reminder token"},"lycanthrope.1.DEAD":{id:"lycanthrope.1.DEAD",text:"DEAD",description:"Reminder token"},"lycanthrope.2.FAUX PAW":{id:"lycanthrope.2.FAUX PAW",text:"FAUX PAW",description:"Reminder token"},"exorcist.1.CHOSEN":{id:"exorcist.1.CHOSEN",text:"CHOSEN",description:"Reminder token"},"gossip.1.DEAD":{id:"gossip.1.DEAD",text:"DEAD",description:"Reminder token"},"engineer.1.NO ABILITY":{id:"engineer.1.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"nightwatchman.1.NO ABILITY":{id:"nightwatchman.1.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"courtier.1.DRUNK 1":{id:"courtier.1.DRUNK 1",text:"DRUNK 1",description:"Reminder token"},"courtier.2.NO ABILITY":{id:"courtier.2.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"courtier.3.DRUNK 3":{id:"courtier.3.DRUNK 3",text:"DRUNK 3",description:"Reminder token"},"courtier.4.DRUNK 2":{id:"courtier.4.DRUNK 2",text:"DRUNK 2",description:"Reminder token"},"seamstress.1.NO ABILITY":{id:"seamstress.1.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"philosopher.1.IS THE PHILOSOPHER":{id:"philosopher.1.IS THE PHILOSOPHER",text:"IS THE PHILOSOPHER",description:"Reminder token"},"philosopher.2.DRUNK":{id:"philosopher.2.DRUNK",text:"DRUNK",description:"Reminder token"},"huntsman.1.NO ABILITY":{id:"huntsman.1.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"professor.1.NO ABILITY":{id:"professor.1.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"professor.2.ALIVE":{id:"professor.2.ALIVE",text:"ALIVE",description:"Reminder token"},"artist.1.NO ABILITY":{id:"artist.1.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"slayer.1.NO ABILITY":{id:"slayer.1.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"fisherman.1.NO ABILITY":{id:"fisherman.1.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"princess.1.DOESN'T KILL":{id:"princess.1.DOESN'T KILL",text:"DOESN'T KILL",description:"Reminder token"},"juggler.1.CORRECT":{id:"juggler.1.CORRECT",text:"CORRECT",description:"Reminder token"},"juggler.2.CORRECT":{id:"juggler.2.CORRECT",text:"CORRECT",description:"Reminder token"},"juggler.3.CORRECT":{id:"juggler.3.CORRECT",text:"CORRECT",description:"Reminder token"},"juggler.4.CORRECT":{id:"juggler.4.CORRECT",text:"CORRECT",description:"Reminder token"},"juggler.5.CORRECT":{id:"juggler.5.CORRECT",text:"CORRECT",description:"Reminder token"},"alchemist.1.IS THE ALCHEMIST":{id:"alchemist.1.IS THE ALCHEMIST",text:"IS THE ALCHEMIST",description:"Reminder token"},"cannibal.1.POISONED":{id:"cannibal.1.POISONED",text:"POISONED",description:"Reminder token"},"cannibal.2.LUNCH":{id:"cannibal.2.LUNCH",text:"LUNCH",description:"Reminder token"},"amnesiac.1.?":{id:"amnesiac.1.?",text:"?",description:"Reminder token"},"amnesiac.2.?":{id:"amnesiac.2.?",text:"?",description:"Reminder token"},"amnesiac.3.?":{id:"amnesiac.3.?",text:"?",description:"Reminder token"},"minstrel.1.EVERYONE IS DRUNK":{id:"minstrel.1.EVERYONE IS DRUNK",text:"EVERYONE IS DRUNK",description:"Reminder token"},"banshee.1.HAS ABILITY":{id:"banshee.1.HAS ABILITY",text:"HAS ABILITY",description:"Reminder token"},"tealady.1.CANNOT DIE":{id:"tealady.1.CANNOT DIE",text:"CANNOT DIE",description:"Reminder token"},"tealady.2.CANNOT DIE":{id:"tealady.2.CANNOT DIE",text:"CANNOT DIE",description:"Reminder token"},"fool.1.NO ABILITY":{id:"fool.1.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"virgin.1.NO ABILITY":{id:"virgin.1.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"poppygrower.1.EVIL WAKES":{id:"poppygrower.1.EVIL WAKES",text:"EVIL WAKES",description:"Reminder token"},"hermit.1.1":{id:"hermit.1.1",text:"1",description:"Reminder token"},"hermit.2.2":{id:"hermit.2.2",text:"2",description:"Reminder token"},"hermit.3.3":{id:"hermit.3.3",text:"3",description:"Reminder token"},"butler.1.MASTER":{id:"butler.1.MASTER",text:"MASTER",description:"Reminder token"},"goon.1.DRUNK":{id:"goon.1.DRUNK",text:"DRUNK",description:"Reminder token"},"lunatic.1.CHOSEN":{id:"lunatic.1.CHOSEN",text:"CHOSEN",description:"Reminder token"},"lunatic.2.CHOSEN":{id:"lunatic.2.CHOSEN",text:"CHOSEN",description:"Reminder token"},"lunatic.3.CHOSEN":{id:"lunatic.3.CHOSEN",text:"CHOSEN",description:"Reminder token"},"drunk.1.IS THE DRUNK":{id:"drunk.1.IS THE DRUNK",text:"IS THE DRUNK",description:"Reminder token"},"tinker.1.DEAD":{id:"tinker.1.DEAD",text:"DEAD",description:"Reminder token"},"golem.1.MAY NOT NOMINATE":{id:"golem.1.MAY NOT NOMINATE",text:"MAY NOT NOMINATE",description:"Reminder token"},"sweetheart.1.DRUNK":{id:"sweetheart.1.DRUNK",text:"DRUNK",description:"Reminder token"},"plaguedoctor.1.STORYTELLER ABILITY":{id:"plaguedoctor.1.STORYTELLER ABILITY",text:"STORYTELLER ABILITY",description:"Reminder token"},"moonchild.1.DEAD":{id:"moonchild.1.DEAD",text:"DEAD",description:"Reminder token"},"barber.1.HAIRCUTS TONIGHT":{id:"barber.1.HAIRCUTS TONIGHT",text:"HAIRCUTS TONIGHT",description:"Reminder token"},"hatter.1.TEA PARTY TONIGHT":{id:"hatter.1.TEA PARTY TONIGHT",text:"TEA PARTY TONIGHT",description:"Reminder token"},"damsel.1.GUESS USED":{id:"damsel.1.GUESS USED",text:"GUESS USED",description:"Reminder token"},"puzzlemaster.1.DRUNK":{id:"puzzlemaster.1.DRUNK",text:"DRUNK",description:"Reminder token"},"puzzlemaster.2.GUESS USED":{id:"puzzlemaster.2.GUESS USED",text:"GUESS USED",description:"Reminder token"},"mezepheles.1.NO ABILITY":{id:"mezepheles.1.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"mezepheles.2.TURNS EVIL":{id:"mezepheles.2.TURNS EVIL",text:"TURNS EVIL",description:"Reminder token"},"godfather.1.DEAD":{id:"godfather.1.DEAD",text:"DEAD",description:"Reminder token"},"godfather.2.DIED TODAY":{id:"godfather.2.DIED TODAY",text:"DIED TODAY",description:"Reminder token"},"poisoner.1.POISONED":{id:"poisoner.1.POISONED",text:"POISONED",description:"Reminder token"},"devilsadvocate.1.SURVIVES EXECUTION":{id:"devilsadvocate.1.SURVIVES EXECUTION",text:"SURVIVES EXECUTION",description:"Reminder token"},"harpy.1.MAD":{id:"harpy.1.MAD",text:"MAD",description:"Reminder token"},"harpy.2.2ND":{id:"harpy.2.2ND",text:"2ND",description:"Reminder token"},"witch.1.CURSED":{id:"witch.1.CURSED",text:"CURSED",description:"Reminder token"},"cerenovus.1.MAD":{id:"cerenovus.1.MAD",text:"MAD",description:"Reminder token"},"fearmonger.1.FEAR":{id:"fearmonger.1.FEAR",text:"FEAR",description:"Reminder token"},"assassin.1.DEAD":{id:"assassin.1.DEAD",text:"DEAD",description:"Reminder token"},"assassin.2.NO ABILITY":{id:"assassin.2.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"widow.1.POISONED":{id:"widow.1.POISONED",text:"POISONED",description:"Reminder token"},"widow.2.KNOWS":{id:"widow.2.KNOWS",text:"KNOWS",description:"Reminder token"},"xaan.1.NIGHT 1":{id:"xaan.1.NIGHT 1",text:"NIGHT 1",description:"Reminder token"},"xaan.2.NIGHT 2":{id:"xaan.2.NIGHT 2",text:"NIGHT 2",description:"Reminder token"},"xaan.3.NIGHT 3":{id:"xaan.3.NIGHT 3",text:"NIGHT 3",description:"Reminder token"},"xaan.4.X":{id:"xaan.4.X",text:"X",description:"Reminder token"},"marionette.1.IS THE MARIONETTE":{id:"marionette.1.IS THE MARIONETTE",text:"IS THE MARIONETTE",description:"Reminder token"},"summoner.1.NIGHT 1":{id:"summoner.1.NIGHT 1",text:"NIGHT 1",description:"Reminder token"},"summoner.2.NIGHT 2":{id:"summoner.2.NIGHT 2",text:"NIGHT 2",description:"Reminder token"},"summoner.3.NIGHT 3":{id:"summoner.3.NIGHT 3",text:"NIGHT 3",description:"Reminder token"},"eviltwin.1.TWIN":{id:"eviltwin.1.TWIN",text:"TWIN",description:"Reminder token"},"goblin.1.CLAIMED":{id:"goblin.1.CLAIMED",text:"CLAIMED",description:"Reminder token"},"scarletwoman.1.IS THE DEMON":{id:"scarletwoman.1.IS THE DEMON",text:"IS THE DEMON",description:"Reminder token"},"organgrinder.1.ABOUT TO DIE":{id:"organgrinder.1.ABOUT TO DIE",text:"ABOUT TO DIE",description:"Reminder token"},"organgrinder.2.DRUNK":{id:"organgrinder.2.DRUNK",text:"DRUNK",description:"Reminder token"},"yaggababble.1.DEAD":{id:"yaggababble.1.DEAD",text:"DEAD",description:"Reminder token"},"yaggababble.2.DEAD":{id:"yaggababble.2.DEAD",text:"DEAD",description:"Reminder token"},"yaggababble.3.DEAD":{id:"yaggababble.3.DEAD",text:"DEAD",description:"Reminder token"},"pukka.1.POISONED":{id:"pukka.1.POISONED",text:"POISONED",description:"Reminder token"},"pukka.2.DEAD":{id:"pukka.2.DEAD",text:"DEAD",description:"Reminder token"},"lilmonsta.1.Lil' Monsta":{id:"lilmonsta.1.Lil' Monsta",text:"Lil' Monsta",description:"Reminder token"},"lilmonsta.2.DEAD":{id:"lilmonsta.2.DEAD",text:"DEAD",description:"Reminder token"},"nodashii.1.POISONED":{id:"nodashii.1.POISONED",text:"POISONED",description:"Reminder token"},"nodashii.2.POISONED":{id:"nodashii.2.POISONED",text:"POISONED",description:"Reminder token"},"nodashii.3.DEAD":{id:"nodashii.3.DEAD",text:"DEAD",description:"Reminder token"},"imp.1.DEAD":{id:"imp.1.DEAD",text:"DEAD",description:"Reminder token"},"shabaloth.1.DEAD":{id:"shabaloth.1.DEAD",text:"DEAD",description:"Reminder token"},"shabaloth.2.DEAD":{id:"shabaloth.2.DEAD",text:"DEAD",description:"Reminder token"},"shabaloth.3.ALIVE":{id:"shabaloth.3.ALIVE",text:"ALIVE",description:"Reminder token"},"ojo.1.DEAD":{id:"ojo.1.DEAD",text:"DEAD",description:"Reminder token"},"kazali.1.DEAD":{id:"kazali.1.DEAD",text:"DEAD",description:"Reminder token"},"po.1.DEAD":{id:"po.1.DEAD",text:"DEAD",description:"Reminder token"},"po.2.DEAD":{id:"po.2.DEAD",text:"DEAD",description:"Reminder token"},"po.3.DEAD":{id:"po.3.DEAD",text:"DEAD",description:"Reminder token"},"po.4.3 ATTACKS":{id:"po.4.3 ATTACKS",text:"3 ATTACKS",description:"Reminder token"},"zombuul.1.DEAD":{id:"zombuul.1.DEAD",text:"DEAD",description:"Reminder token"},"zombuul.2.DIED TODAY":{id:"zombuul.2.DIED TODAY",text:"DIED TODAY",description:"Reminder token"},"vigormortis.1.POISONED":{id:"vigormortis.1.POISONED",text:"POISONED",description:"Reminder token"},"vigormortis.2.POISONED":{id:"vigormortis.2.POISONED",text:"POISONED",description:"Reminder token"},"vigormortis.3.POISONED":{id:"vigormortis.3.POISONED",text:"POISONED",description:"Reminder token"},"vigormortis.4.DEAD":{id:"vigormortis.4.DEAD",text:"DEAD",description:"Reminder token"},"vigormortis.5.HAS ABILITY":{id:"vigormortis.5.HAS ABILITY",text:"HAS ABILITY",description:"Reminder token"},"vigormortis.6.HAS ABILITY":{id:"vigormortis.6.HAS ABILITY",text:"HAS ABILITY",description:"Reminder token"},"vigormortis.7.HAS ABILITY":{id:"vigormortis.7.HAS ABILITY",text:"HAS ABILITY",description:"Reminder token"},"vortox.1.DEAD":{id:"vortox.1.DEAD",text:"DEAD",description:"Reminder token"},"legion.1.ABOUT TO DIE":{id:"legion.1.ABOUT TO DIE",text:"ABOUT TO DIE",description:"Reminder token"},"legion.2.DEAD":{id:"legion.2.DEAD",text:"DEAD",description:"Reminder token"},"fanggu.1.DEAD":{id:"fanggu.1.DEAD",text:"DEAD",description:"Reminder token"},"fanggu.2.ONCE":{id:"fanggu.2.ONCE",text:"ONCE",description:"Reminder token"},"lleech.1.POISONED":{id:"lleech.1.POISONED",text:"POISONED",description:"Reminder token"},"lleech.2.DEAD":{id:"lleech.2.DEAD",text:"DEAD",description:"Reminder token"},"alhadikhia.1.1":{id:"alhadikhia.1.1",text:"1",description:"Reminder token"},"alhadikhia.2.2":{id:"alhadikhia.2.2",text:"2",description:"Reminder token"},"alhadikhia.3.3":{id:"alhadikhia.3.3",text:"3",description:"Reminder token"},"leviathan.1.DAY 5":{id:"leviathan.1.DAY 5",text:"DAY 5",description:"Reminder token"},"leviathan.2.DAY 2":{id:"leviathan.2.DAY 2",text:"DAY 2",description:"Reminder token"},"leviathan.3.DAY 4":{id:"leviathan.3.DAY 4",text:"DAY 4",description:"Reminder token"},"leviathan.4.GOOD PLAYER EXECUTED":{id:"leviathan.4.GOOD PLAYER EXECUTED",text:"GOOD PLAYER EXECUTED",description:"Reminder token"},"leviathan.5.DAY 3":{id:"leviathan.5.DAY 3",text:"DAY 3",description:"Reminder token"},"leviathan.6.DAY 1":{id:"leviathan.6.DAY 1",text:"DAY 1",description:"Reminder token"},"thief.1.NEGATIVE VOTE":{id:"thief.1.NEGATIVE VOTE",text:"NEGATIVE VOTE",description:"Reminder token"},"bureaucrat.1.3 VOTES":{id:"bureaucrat.1.3 VOTES",text:"3 VOTES",description:"Reminder token"},"barista.1.SOBER AND HEALTHY":{id:"barista.1.SOBER AND HEALTHY",text:"SOBER AND HEALTHY",description:"Reminder token"},"barista.2.ACTS TWICE":{id:"barista.2.ACTS TWICE",text:"ACTS TWICE",description:"Reminder token"},"harlot.1.DEAD":{id:"harlot.1.DEAD",text:"DEAD",description:"Reminder token"},"harlot.2.DEAD":{id:"harlot.2.DEAD",text:"DEAD",description:"Reminder token"},"bonecollector.1.NO ABILITY":{id:"bonecollector.1.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"bonecollector.2.HAS ABILITY":{id:"bonecollector.2.HAS ABILITY",text:"HAS ABILITY",description:"Reminder token"},"judge.1.NO ABILITY":{id:"judge.1.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"apprentice.1.IS THE APPRENTICE":{id:"apprentice.1.IS THE APPRENTICE",text:"IS THE APPRENTICE",description:"Reminder token"},"gnome.1.AMIGO":{id:"gnome.1.AMIGO",text:"AMIGO",description:"Reminder token"},"bishop.1.NOMINATE EVIL":{id:"bishop.1.NOMINATE EVIL",text:"NOMINATE EVIL",description:"Reminder token"},"bishop.2.NOMINATE GOOD":{id:"bishop.2.NOMINATE GOOD",text:"NOMINATE GOOD",description:"Reminder token"},"angel.1.SOMETHING BAD":{id:"angel.1.SOMETHING BAD",text:"SOMETHING BAD",description:"Reminder token"},"angel.2.PROTECTED":{id:"angel.2.PROTECTED",text:"PROTECTED",description:"Reminder token"},"deusexfiasco.1.WHOOPSIE":{id:"deusexfiasco.1.WHOOPSIE",text:"WHOOPSIE",description:"Reminder token"},"duchess.1.FALSE INFO":{id:"duchess.1.FALSE INFO",text:"FALSE INFO",description:"Reminder token"},"duchess.2.VISITOR":{id:"duchess.2.VISITOR",text:"VISITOR",description:"Reminder token"},"duchess.3.VISITOR":{id:"duchess.3.VISITOR",text:"VISITOR",description:"Reminder token"},"fibbin.1.NO ABILITY":{id:"fibbin.1.NO ABILITY",text:"NO ABILITY",description:"Reminder token"},"hellslibrarian.1.SOMETHING BAD":{id:"hellslibrarian.1.SOMETHING BAD",text:"SOMETHING BAD",description:"Reminder token"},"revolutionary.1.REGISTER FALSELY?":{id:"revolutionary.1.REGISTER FALSELY?",text:"REGISTER FALSELY?",description:"Reminder token"},"stormcatcher.1.SAFE":{id:"stormcatcher.1.SAFE",text:"SAFE",description:"Reminder token"},"toymaker.1.FINAL NIGHT: NO ATTACK":{id:"toymaker.1.FINAL NIGHT: NO ATTACK",text:"FINAL NIGHT: NO ATTACK",description:"Reminder token"}};function Yn({reminderId:o,ownerId:e,attachedToId:t,customText:n}){var E,R;const i=re(ae),r=re(Te),l=(((E=re(q).counters)==null?void 0:E.reminderId)??Math.max(0,...i.ReminderTokens.map(H=>H.id)))+1,a=t??e,s=80,c=40,f=60,u=((R=r.playerPositions)==null?void 0:R[a])??{x:0,y:0},d={x:u.x+s/2,y:u.y+s/2},h=Math.random()*Math.PI*2,m=Math.cos(h)*f,k=Math.sin(h)*f,w={x:d.x+m,y:d.y+k},O=w.x-c/2,I=w.y-c/2;Te.update(H=>({...H,reminderPositions:{...H.reminderPositions,[l]:{x:O-u.x,y:I-u.y}}}));const T={id:l,reminderId:o,ownerId:e,attachedToId:a,customText:n,enabled:!0};return ae.update(H=>({...H,ReminderTokens:[...H.ReminderTokens,T]})),q.update(H=>({...H,counters:{...H.counters,reminderId:l+1}})),T}function Jn(o){q.update(e=>({...e,currentReminder:o,showReminderContextModal:!0}))}function Yc(){q.update(o=>o.currentReminder?{...o,showMoveReminderModal:!0}:o)}function ro(o){const e=re(ae),t=e.ReminderTokens.find(n=>n.id===o);return t?e.playerTokens.find(n=>n.id===t.ownerId):void 0}function lo(o){const e=re(ae),t=e.ReminderTokens.find(n=>n.id===o);return t?e.playerTokens.find(n=>n.id===t.attachedToId):void 0}function Hc(o){const e=ro(o.id);if(!e)return;const n=re(Re)[e.roleId];n&&q.update(i=>({...i,currentCard:{..._t("you_are",it),roles:[n]},showCardModal:!0,showReminderContextModal:!1}))}function Gc(o){const e=lo(o.id);if(!e)return;const n=re(Re)[e.roleId];n&&q.update(i=>({...i,currentCard:{..._t("player_is",it),roles:[n]},showCardModal:!0,showReminderContextModal:!1}))}function Fc(o){const e=re(q).currentReminder;e&&(ae.update(t=>({...t,ReminderTokens:t.ReminderTokens.map(n=>n.id===e.id?{...n,attachedToId:o}:n)})),q.update(t=>({...t,showMoveReminderModal:!1,showReminderContextModal:!1,currentReminder:null})))}function jc(o){ae.update(e=>({...e,ReminderTokens:e.ReminderTokens.filter(t=>t.id!==o)}))}function zc(o,e){ae.update(t=>({...t,ReminderTokens:t.ReminderTokens.map(n=>n.id===o?{...n,attachedToId:e}:n)}))}function Kc(o,e){ae.update(t=>({...t,ReminderTokens:t.ReminderTokens.filter(n=>!(n.ownerId===o&&n.id===e))}))}function Wc(o){const[e]=o.reminderId.split(".");if(!e)return;const n=re(Re)[e];n&&q.update(i=>({...i,currentCard:{..._t("player_is",it),roles:[n]},showCardModal:!0,showReminderContextModal:!1}))}function Xo(o){var l;const e=re(Re),t=re(ae),n=t.playerTokens.find(a=>a.id===o);if(!n)return;const i=((l=e[n.roleId])==null?void 0:l.associatedReminders)??[],r=new Set(t.ReminderTokens.filter(a=>a.ownerId===o).map(a=>a.reminderId));for(const a of i)r.has(a)||Yn({reminderId:a,ownerId:o,attachedToId:o})}function qc(o){q.update(e=>({...e,addingReminderAttachedTo:o,showAddReminderModal:!0}))}function xt(o){const e=Qt[o];return e?e.text.replace(/:\s*/,`:
`):""}function Vc(o){ae.update(e=>(e.ReminderTokens.find(t=>t.id===o),{...e,ReminderTokens:e.ReminderTokens.map(t=>t.id===o?{...t,enabled:!t.enabled}:t)}))}function Xc(o,e){ae.update(t=>({...t,ReminderTokens:t.ReminderTokens.map(n=>n.id===o?{...n,customText:e}:n)}))}function so(){const e=_n().playerTokens,t=e.length;if(t===0)return;const n=window.innerWidth,i=window.innerHeight,r=n/2,l=i/2,a=Math.min(n,i)*.4,c=80/2,f={},u=Math.PI/2;e.forEach((d,h)=>{const m=2*Math.PI*h/t+u;f[d.id]={x:r+a*Math.cos(m)-c,y:l+a*Math.sin(m)-c}}),Te.update(d=>({...d,playerPositions:f}))}function Jc(){const{playerTokens:o}=_n();if(o.length===0)return;const e=o.map(l=>{const a=re(Te).playerPositions[l.id]||{x:0,y:0};return{id:l.id,px:a.x+40,py:a.y+40}}),t=e.reduce((l,a)=>l+a.px,0)/e.length,n=e.reduce((l,a)=>l+a.py,0)/e.length,r=e.map(({id:l,px:a,py:s})=>{let c=Math.atan2(s-n,a-t)*180/Math.PI;return c=(c+360-90)%360,{id:l,θ:c}}).sort((l,a)=>l.θ-a.θ).map(l=>l.id);ae.update(l=>({...l,playerTokens:r.map(a=>l.playerTokens.find(s=>s.id===a))}))}const bt=Ae({x:0,y:0,scale:1,rotation:0});function Hn(o,e){const t=re(bt);let n=o-t.x,i=e-t.y;n/=t.scale,i/=t.scale;const r=-t.rotation*Math.PI/180,l=Math.cos(r),a=Math.sin(r),s=n*l-i*a,c=n*a+i*l;return{x:s,y:c}}function ba(o,e){return Math.hypot(o.clientX-e.clientX,o.clientY-e.clientY)}function ka(o,e){return Math.atan2(e.clientY-o.clientY,e.clientX-o.clientX)*180/Math.PI}function wa(o){return o instanceof HTMLElement&&o.closest("[data-interactive]")}const Zc=30,On=Zc/2;function Qc(o,e){const t=re(q);if(t.draggingPlayer||t.draggingReminder)return;const n=o.currentTarget;n.setPointerCapture(o.pointerId);const i=re(Te).playerPositions[e]||{x:0,y:0},r=Hn(o.clientX,o.clientY),l=r.x-i.x,a=r.y-i.y;q.update(s=>({...s,draggingPlayer:{id:e,startX:l,startY:a}})),n.addEventListener("pointermove",ya),n.addEventListener("pointerup",$a)}function ya(o){const e=re(q).draggingPlayer;if(!e)return;const t=Hn(o.clientX,o.clientY),n=t.x-e.startX,i=t.y-e.startY;Te.update(r=>({...r,playerPositions:{...r.playerPositions,[e.id]:{x:n,y:i}}}))}function $a(o){const e=o.currentTarget;e.releasePointerCapture(o.pointerId),e.removeEventListener("pointermove",ya),e.removeEventListener("pointerup",$a),q.update(t=>({...t,draggingPlayer:null})),Jc()}function xc(o,e,t){const n=re(q);if(n.draggingPlayer||n.draggingReminder)return;o.stopPropagation();const i=o.currentTarget;i.setPointerCapture(o.pointerId);const r=re(Te),l=r.playerPositions[e]||{x:0,y:0},a=r.reminderPositions[t]??{x:0,y:0},s={x:l.x+a.x,y:l.y+a.y},c=Hn(o.clientX,o.clientY),f=c.x-s.x,u=c.y-s.y;q.update(d=>({...d,draggingReminder:{id:t,tokenId:e,offset:{x:f,y:u},attachedTo:e}})),i.addEventListener("pointermove",va),i.addEventListener("pointerup",Na)}function va(o){const e=re(q).draggingReminder;if(!e)return;const t=Hn(o.clientX,o.clientY),n=t.x-e.offset.x,i=t.y-e.offset.y;Te.update(r=>{const l=r.playerPositions[e.attachedTo]||{x:0,y:0},a=n-l.x,s=i-l.y;return{...r,reminderPositions:{...r.reminderPositions,[e.id]:{x:a,y:s}}}})}function Na(o){const e=o.currentTarget;e.releasePointerCapture(o.pointerId),e.removeEventListener("pointermove",va),e.removeEventListener("pointerup",Na);const t=re(q).draggingReminder;if(t){const n=re(Te),i=n.playerPositions[t.attachedTo]||{x:0,y:0},r=n.reminderPositions[t.id]||{x:0,y:0},l=i.x+r.x+On,a=i.y+r.y+On;let s=null,c=1/0;const f=40;for(const[u,d]of Object.entries(n.playerPositions)){const h=parseInt(u,10),m=d.x+f,k=d.y+f,w=l-m,O=a-k,I=w*w+O*O;I<c&&(c=I,s=h)}if(s!==null){const u=n.playerPositions[s]||{x:0,y:0},d=l-u.x-On,h=a-u.y-On;Te.update(m=>({...m,reminderPositions:{...m.reminderPositions,[t.id]:{x:d,y:h}}})),zc(t.id,s)}}q.update(n=>({...n,draggingReminder:null}))}function ef(o){let e,t,n,i,r,l,a;return{c(){var s;e=$("div"),t=C(o[5]),p(e,"role","button"),p(e,"tabindex","0"),p(e,"aria-label",n=`Reminder token: ${o[5]}. Press Enter or Space to open options, or drag to move.`),p(e,"data-interactive",""),p(e,"class",i="reminder "+(o[4]?"dragging":"")+" "+(o[7]?"custom":"")+" "+(o[6]===!1?"disabled":"")+" svelte-jg8sh6"),ce(e,"left",o[2]+"px"),ce(e,"top",o[3]+"px"),ce(e,"border-color",o[7]?"darkgoldenrod":o[10]),ce(e,"background",o[7]?"darkgoldenrod":o[10]),p(e,"title",r=(s=Qt[o[1]])==null?void 0:s.description)},m(s,c){_(s,e,c),b(e,t),l||(a=[ee(e,"keydown",o[15]),ee(e,"pointerdown",Tt(o[11])),ee(e,"pointermove",Tt(o[12])),ee(e,"click",Tt(o[13]))],l=!0)},p(s,[c]){var f;c&32&&J(t,s[5]),c&32&&n!==(n=`Reminder token: ${s[5]}. Press Enter or Space to open options, or drag to move.`)&&p(e,"aria-label",n),c&208&&i!==(i="reminder "+(s[4]?"dragging":"")+" "+(s[7]?"custom":"")+" "+(s[6]===!1?"disabled":"")+" svelte-jg8sh6")&&p(e,"class",i),c&4&&ce(e,"left",s[2]+"px"),c&8&&ce(e,"top",s[3]+"px"),c&128&&ce(e,"border-color",s[7]?"darkgoldenrod":s[10]),c&128&&ce(e,"background",s[7]?"darkgoldenrod":s[10]),c&2&&r!==(r=(f=Qt[s[1]])==null?void 0:f.description)&&p(e,"title",r)},i:te,o:te,d(s){s&&g(e),l=!1,$e(a)}}}const Jo=5;function tf(o,e,t){let n,{tokenId:i}=e,{id:r}=e,{reminderId:l}=e,{x:a}=e,{y:s}=e,{isDragging:c=!1}=e,{text:f}=e,{enabled:u=!0}=e;const d=ro(r),h=lo(r),m=(d==null?void 0:d.id)??i,k=(h==null?void 0:h.id)??i,w=(d==null?void 0:d.alignment)==="Evil"?"#5c1a1a":(d==null?void 0:d.alignment)==="Good"?"#1a355c":"#444";let O=0,I=0,T=!1;function E(M){O=M.clientX,I=M.clientY,T=!1,xc(M,i,r)}function R(M){if(!T){const U=Math.abs(M.clientX-O),v=Math.abs(M.clientY-I);(U>Jo||v>Jo)&&(T=!0)}}function H(){T||Jn({id:r,reminderId:l,customText:f,enabled:u,ownerId:m,attachedToId:k})}const A=M=>{(M.key==="Enter"||M.key===" ")&&(M.preventDefault(),Jn({id:r,reminderId:l,customText:f,enabled:u,ownerId:m,attachedToId:k}))};return o.$$set=M=>{"tokenId"in M&&t(14,i=M.tokenId),"id"in M&&t(0,r=M.id),"reminderId"in M&&t(1,l=M.reminderId),"x"in M&&t(2,a=M.x),"y"in M&&t(3,s=M.y),"isDragging"in M&&t(4,c=M.isDragging),"text"in M&&t(5,f=M.text),"enabled"in M&&t(6,u=M.enabled)},o.$$.update=()=>{o.$$.dirty&2&&t(7,n=l==="custom")},[r,l,a,s,c,f,u,n,m,k,w,E,R,H,i,A]}class ao extends ye{constructor(e){super(),we(this,e,tf,ef,ke,{tokenId:14,id:0,reminderId:1,x:2,y:3,isDragging:4,text:5,enabled:6})}}function Zo(o,e,t){const n=o.slice();return n[12]=e[t].token,n[13]=e[t].target,n}function Qo(o,e,t){const n=o.slice();return n[12]=e[t].token,n[16]=e[t].origin,n}function nf(o){let e;return{c(){e=$("div"),e.textContent="none",p(e,"class","no-reminders svelte-119er8p")},m(t,n){_(t,e,n)},p:te,i:te,o:te,d(t){t&&g(e)}}}function of(o){let e,t=[],n=new Map,i,r=X(o[1]);const l=a=>a[12].id;for(let a=0;a<r.length;a+=1){let s=Qo(o,r,a),c=l(s);n.set(c,t[a]=xo(c,s))}return{c(){e=$("div");for(let a=0;a<t.length;a+=1)t[a].c();p(e,"class","reminders-list svelte-119er8p")},m(a,s){_(a,e,s);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);i=!0},p(a,s){s&14&&(r=X(a[1]),ne(),t=He(t,s,l,1,a,r,n,e,Ve,xo,null,Qo),oe())},i(a){if(!i){for(let s=0;s<r.length;s+=1)y(t[s]);i=!0}},o(a){for(let s=0;s<t.length;s+=1)N(t[s]);i=!1},d(a){a&&g(e);for(let s=0;s<t.length;s+=1)t[s].d()}}}function xo(o,e){let t,n,i,r,l,a,s=Ln(e[16].roleId)+"",c,f,u=e[16].playerName+"",d,h,m,k,w,O;r=new ao({props:{id:e[12].id,reminderId:e[12].reminderId,tokenId:e[12].attachedToId,x:0,y:0,isDragging:!1,text:e[12].customText??xt(e[12].reminderId),enabled:e[12].enabled??!0}});function I(){return e[8](e[12])}function T(...E){return e[9](e[12],...E)}return{key:o,first:null,c(){t=$("div"),n=$("div"),i=$("div"),j(r.$$.fragment),l=D(),a=$("span"),c=C(s),f=C(" ("),d=C(u),h=C(")"),m=D(),p(i,"class","reminder-proxy svelte-119er8p"),p(n,"class","token-holder svelte-119er8p"),p(n,"role","button"),p(n,"tabindex","0"),p(n,"aria-label","View reminder details"),p(a,"class","label-text svelte-119er8p"),p(t,"class","token-row svelte-119er8p"),this.first=t},m(E,R){_(E,t,R),b(t,n),b(n,i),G(r,i,null),b(t,l),b(t,a),b(a,c),b(a,f),b(a,d),b(a,h),b(t,m),k=!0,w||(O=[ee(n,"click",I),ee(n,"keydown",T)],w=!0)},p(E,R){e=E;const H={};R&2&&(H.id=e[12].id),R&2&&(H.reminderId=e[12].reminderId),R&2&&(H.tokenId=e[12].attachedToId),R&2&&(H.text=e[12].customText??xt(e[12].reminderId)),R&2&&(H.enabled=e[12].enabled??!0),r.$set(H),(!k||R&2)&&s!==(s=Ln(e[16].roleId)+"")&&J(c,s),(!k||R&2)&&u!==(u=e[16].playerName+"")&&J(d,u)},i(E){k||(y(r.$$.fragment,E),k=!0)},o(E){N(r.$$.fragment,E),k=!1},d(E){E&&g(t),F(r),w=!1,$e(O)}}}function rf(o){let e;return{c(){e=$("div"),e.textContent="none",p(e,"class","no-reminders svelte-119er8p")},m(t,n){_(t,e,n)},p:te,i:te,o:te,d(t){t&&g(e)}}}function lf(o){let e,t=[],n=new Map,i,r=X(o[0]);const l=a=>a[12].id;for(let a=0;a<r.length;a+=1){let s=Zo(o,r,a),c=l(s);n.set(c,t[a]=ei(c,s))}return{c(){e=$("div");for(let a=0;a<t.length;a+=1)t[a].c();p(e,"class","reminders-list svelte-119er8p")},m(a,s){_(a,e,s);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);i=!0},p(a,s){s&13&&(r=X(a[0]),ne(),t=He(t,s,l,1,a,r,n,e,Ve,ei,null,Zo),oe())},i(a){if(!i){for(let s=0;s<r.length;s+=1)y(t[s]);i=!0}},o(a){for(let s=0;s<t.length;s+=1)N(t[s]);i=!1},d(a){a&&g(e);for(let s=0;s<t.length;s+=1)t[s].d()}}}function ei(o,e){let t,n,i,r,l,a,s=Ln(e[13].roleId)+"",c,f,u=e[13].playerName+"",d,h,m,k,w,O;r=new ao({props:{id:e[12].id,reminderId:e[12].reminderId,tokenId:e[12].attachedToId,x:0,y:0,isDragging:!1,text:e[12].customText??xt(e[12].reminderId),enabled:e[12].enabled??!0}});function I(){return e[10](e[12])}function T(...E){return e[11](e[12],...E)}return{key:o,first:null,c(){t=$("div"),n=$("div"),i=$("div"),j(r.$$.fragment),l=D(),a=$("span"),c=C(s),f=C(" ("),d=C(u),h=C(")"),m=D(),p(i,"class","reminder-proxy svelte-119er8p"),p(n,"class","token-holder svelte-119er8p"),p(n,"role","button"),p(n,"tabindex","0"),p(n,"aria-label","View reminder details"),p(a,"class","label-text svelte-119er8p"),p(t,"class","token-row svelte-119er8p"),this.first=t},m(E,R){_(E,t,R),b(t,n),b(n,i),G(r,i,null),b(t,l),b(t,a),b(a,c),b(a,f),b(a,d),b(a,h),b(t,m),k=!0,w||(O=[ee(n,"click",I),ee(n,"keydown",T)],w=!0)},p(E,R){e=E;const H={};R&1&&(H.id=e[12].id),R&1&&(H.reminderId=e[12].reminderId),R&1&&(H.tokenId=e[12].attachedToId),R&1&&(H.text=e[12].customText??xt(e[12].reminderId)),R&1&&(H.enabled=e[12].enabled??!0),r.$set(H),(!k||R&1)&&s!==(s=Ln(e[13].roleId)+"")&&J(c,s),(!k||R&1)&&u!==(u=e[13].playerName+"")&&J(d,u)},i(E){k||(y(r.$$.fragment,E),k=!0)},o(E){N(r.$$.fragment,E),k=!1},d(E){E&&g(t),F(r),w=!1,$e(O)}}}function sf(o){let e,t,n,i,r,l,a,s,c,f,u,d,h;const m=[of,nf],k=[];function w(E,R){return E[1].length>0?0:1}r=w(o),l=k[r]=m[r](o);const O=[lf,rf],I=[];function T(E,R){return E[0].length>0?0:1}return u=T(o),d=I[u]=O[u](o),{c(){e=$("div"),t=$("div"),n=$("div"),n.textContent="incoming",i=D(),l.c(),a=D(),s=$("div"),c=$("div"),c.textContent="outgoing",f=D(),d.c(),p(n,"class","box-label svelte-119er8p"),p(t,"class","reminder-box svelte-119er8p"),p(c,"class","box-label svelte-119er8p"),p(s,"class","reminder-box svelte-119er8p"),p(e,"class","reminder-container svelte-119er8p")},m(E,R){_(E,e,R),b(e,t),b(t,n),b(t,i),k[r].m(t,null),b(e,a),b(e,s),b(s,c),b(s,f),I[u].m(s,null),h=!0},p(E,[R]){let H=r;r=w(E),r===H?k[r].p(E,R):(ne(),N(k[H],1,1,()=>{k[H]=null}),oe(),l=k[r],l?l.p(E,R):(l=k[r]=m[r](E),l.c()),y(l,1),l.m(t,null));let A=u;u=T(E),u===A?I[u].p(E,R):(ne(),N(I[A],1,1,()=>{I[A]=null}),oe(),d=I[u],d?d.p(E,R):(d=I[u]=O[u](E),d.c()),y(d,1),d.m(s,null))},i(E){h||(y(l),y(d),h=!0)},o(E){N(l),N(d),h=!1},d(E){E&&g(e),k[r].d(),I[u].d()}}}function af(o,e,t){let n,i,r,l,a;se(o,ae,k=>t(7,a=k));let{player:s}=e;function c(k){Jn(k)}function f(k,w){(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),c(w))}const u=k=>c(k),d=(k,w)=>f(w,k),h=k=>c(k),m=(k,w)=>f(w,k);return o.$$set=k=>{"player"in k&&t(4,s=k.player)},o.$$.update=()=>{o.$$.dirty&128&&t(6,n=a.ReminderTokens??[]),o.$$.dirty&208&&t(5,i=n.filter(k=>k.attachedToId===s.id&&k.ownerId!==s.id).map(k=>{const w=a.playerTokens.find(O=>O.id===k.ownerId);return w?{token:k,origin:w}:null}).filter(k=>!!k)),o.$$.dirty&208&&t(0,r=n.filter(k=>k.ownerId===s.id).map(k=>{const w=a.playerTokens.find(O=>O.id===k.attachedToId)||s;return{token:k,target:w}}).filter(k=>!!k)),o.$$.dirty&33&&t(1,l=i.filter(k=>!r.some(w=>w.token.id===k.token.id)))},[r,l,c,f,s,i,n,a,u,d,h,m]}class Ia extends ye{constructor(e){super(),we(this,e,af,sf,ke,{player:4})}}const cf="en",mn="https://dx.fr.to/cors/",pn="https://script.bloodontheclocktower.com",ff="https://wiki.bloodontheclocktower.com/Special:Export",ti="https://raw.githubusercontent.com/ThePandemoniumInstitute/botc-translations/refs/heads/main/game/",bn=Ae([]),uf=Ae([]),kn=Ae([]),co=Ae({firstNight:[],otherNight:[]}),Oa=Ae([]),ni=Ae(!0),Dn=Ae("Idle…"),Zn=Ae(cf),df={af:"Afrikaans",az:"Azerbaijani",bg:"Bulgarian",bn:"Bengali",cs:"Czech",da:"Danish",de:"German",de_AT:"German (Austria)",de_CH:"German (Switzerland)",el:"Greek",en:"English","en@pirate":"English (Pirate)",es:"Spanish",es_419:"Spanish (Latin America)",es_MX:"Spanish (Mexico)",es_PE:"Spanish (Peru)",fa:"Persian",fi:"Finnish",fil:"Filipino",fr:"French",fr_CA:"French (Canada)",gsw:"Swiss German",he:"Hebrew",hi:"Hindi",hr:"Croatian",hu:"Hungarian",id:"Indonesian",is:"Icelandic",it:"Italian",ja:"Japanese",ka:"Georgian",ko:"Korean",krl:"Karelian",la:"Latin",lt:"Lithuanian",nb_NO:"Norwegian Bokmål",nl:"Dutch",pl:"Polish",pt_BR:"Portuguese (Brazil)",pt_PT:"Portuguese (Portugal)",qpv:"Quechua (Peru Variant)",ro:"Romanian",ru:"Russian",se:"Sami (Northern)",sk:"Slovak",sl:"Slovenian",smi:"Sami (Generic)",sr:"Serbian",sv:"Swedish",th:"Thai",tlh:"Klingon",tok:"Toki Pona",tr:"Turkish",uk:"Ukrainian",vi:"Vietnamese",yi:"Yiddish",zh_Hans:"Chinese (Simplified)"},Ra=o=>new Function(`return '${o}'`)(),hf=o=>o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Ta=o=>o.replace(/<br\s*\/?>/gi,`
`).replace(/<\/?(p|table|tr|td|ul|ol|li|hr|h[1-6])[^>]*>/gi,`
`).replace(/&nbsp;/g," "),gn=o=>o.replace(/<\/?[^>]+>/g,""),mf=o=>o.replace(/<div[^>]*class=(?:"[^"]*\bexample\b[^"]*"|'[^']*\bexample\b[^']*')[^>]*>[\s\S]*?<\/div>/gi,""),Mt=o=>o.replace(/\{\{(?:Good|Evil|Traveller|Fabled)\|([^}]+)\}\}/g,"$1").replace(/\{\{[^}]+\}\}/g,"").replace(/\[\[([^\]|]+)\|?([^\]]*)\]\]/g,(e,t,n)=>n||t).replace(/'''|''/g,"").replace(/\s+/g," ").trim();function gt(o,e){const t=new RegExp(`(^|\\n)==\\s*${hf(e)}[^=]*==\\s*([\\s\\S]*?)(?=\\n==\\s*[^=]+==|$)`,"i"),n=o.match(t);return n?n[2]:""}function Kt(o){if(!o)return[];const e=o.replace(/([.!?])\s*\*\s+/g,`$1
* `).replace(/\r/g,"");return Array.from(e.matchAll(/^\s*\*\s+(.+?)\s*$/gm)).map(n=>Mt(n[1])).filter(Boolean)}function oi(o){return o?gn(Ta(o).replace(/\r/g,"")).replace(/[ \t]+\n/g,`
`).replace(/\n{3,}/g,`

`).trim().split(/\n{2,}/).map(t=>Mt(t)).filter(Boolean):[]}function ii(o){if(!o)return[];const e=document.createElement("div");e.innerHTML=o;const t=Array.from(e.querySelectorAll('div.example, div[class*="example"]')),n=[];for(const i of t){const r=i.querySelectorAll("p, li");if(r.length)r.forEach(l=>{const a=Mt(gn(l.innerHTML.replace(/<br\s*\/?>/gi,`
`).replace(/<\/p>\s*<p>/gi,`

`)));a&&n.push(a)});else{const l=Mt(gn(i.innerHTML.replace(/<br\s*\/?>/gi,`
`).replace(/<\/p>\s*<p>/gi,`

`)));l&&n.push(l)}}return n.filter(Boolean)}function pf(o){if(!o)return{ability:"",details:"",flavour_text:"",bullets:[],how_to_run:[],how_to_run_hint:[],examples:[],tips_and_tricks:[],bluffing_as:[],fighting_the:[],traveller_tips_good:[],traveller_tips_evil:[],fabled_explanation:[],jinxes:[]};let e="";const t=o.match(/<p[^>]*class=['"]flavour['"][^>]*>([\s\S]*?)(?:<\/p>|<p\b|$)/i);t&&(e=Mt(gn(t[1].replace(/<br\s*\/?>/gi,`
`).replace(/\r/g,""))));const n=gt(o,"Summary"),i=gt(o,"How to Run"),r=gt(o,"Examples"),l=gt(o,"Tips & Tricks"),a=gt(o,"Bluffing as"),s=gt(o,"Fighting the"),c=gt(o,"Tips & Tricks (if you are good)"),f=gt(o,"Tips & Tricks (if you are evil)"),u=gt(o,"Explanation");let d="",h="";if(n){const M=n.match(/"[^"]+"/);d=M?Mt(M[0]):"";const v=(M?n.slice(M.index+M[0].length):n).split(/\n\s*\*/)[0]||"";h=Mt(gn(Ta(v))).trim()}const m=Kt(n).map(M=>[{text:M}]),k=oi(mf(i)),w=ii(i),O=ii(r),I=Kt(l),T=Kt(a),E=Kt(s),R=Kt(c),H=Kt(f),A=oi(u);return{ability:d,details:h,flavour_text:e,bullets:m,how_to_run:k,how_to_run_hint:w,examples:O,tips_and_tricks:I,bluffing_as:T,fighting_the:E,traveller_tips_good:R,traveller_tips_evil:H,fabled_explanation:A,jinxes:[]}}function gf(o){var i,r;if(!o.edition||!o.id)return"";const e=o.edition.toLowerCase(),t=o.id.toLowerCase();let n="";return["townsfolk","outsider"].includes((i=o.type)==null?void 0:i.toLowerCase())?n="_g":["minion","demon"].includes((r=o.type)==null?void 0:r.toLowerCase())&&(n="_e"),`${pn}/src/assets/icons/${e}/${t}${n}.webp`}function _f(o){return["dusk","dawn","minioninfo","demoninfo"].map(t=>{const n=o[t]||{};return{id:t,name:n.name||t,type:"meta",ability:"",flavor:"",firstNightReminder:n.first||"",otherNightReminder:n.other||"",iconUrl:""}})}async function bf(o=re(Zn)){try{const e=await fetch(`${ti}${o}.json`);if(!e.ok)throw new Error(`Failed to fetch ${o}.json`);return e.json()}catch{return(await fetch(`${ti}en.json`)).json()}}async function kf(){Dn.set("Fetching workspace file…");const e=(await fetch(mn+encodeURIComponent(pn)).then(i=>i.text())).match(/<script[^>]*type=module[^>]*src=["']?(\/workspace\.[^"'\s>]+\.js)["']?/);if(!e)throw new Error("No workspace.<hash>.js found");const n=(await fetch(mn+encodeURIComponent(pn+e[1])).then(i=>i.text())).match(/JSON\.parse\('(\{"firstNight":\[.*?"otherNight":\[.*?\]\})'\)/s);if(!n)throw new Error("Missing night order JSON");return{nightOrders:JSON.parse(Ra(n[1]))}}async function wf(o){var s,c,f;const e=o.map(u=>u.name.replace(/ /g,"_").replace(/'/g,"%27")),t=new URLSearchParams({title:"Special:Export",pages:e.join(`
`),curonly:"1",wpEditToken:"+\\"}),n=await fetch(mn+encodeURIComponent(ff),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t.toString()}).then(u=>u.text()),i=new DOMParser().parseFromString(n,"text/xml"),r=Array.from(i.querySelectorAll("page")),l=new Map;for(const u of r){const d=(c=(s=u.querySelector("title"))==null?void 0:s.textContent)==null?void 0:c.trim().toLowerCase();if(!d)continue;const h=pf(((f=u.querySelector("text"))==null?void 0:f.textContent)??"");l.set(d,h)}return o.map(u=>{const d=u.name.toLowerCase(),h=l.get(d);return{roleId:u.id,ability:(h==null?void 0:h.ability)??"",details:(h==null?void 0:h.details)??"",flavour_text:(h==null?void 0:h.flavour_text)??"",bullets:(h==null?void 0:h.bullets)??[],how_to_run:(h==null?void 0:h.how_to_run)??[],how_to_run_hint:(h==null?void 0:h.how_to_run_hint)??[],examples:(h==null?void 0:h.examples)??[],tips_and_tricks:(h==null?void 0:h.tips_and_tricks)??[],bluffing_as:(h==null?void 0:h.bluffing_as)??[],fighting_the:(h==null?void 0:h.fighting_the)??[],traveller_tips_good:(h==null?void 0:h.traveller_tips_good)??[],traveller_tips_evil:(h==null?void 0:h.traveller_tips_evil)??[],fabled_explanation:(h==null?void 0:h.fabled_explanation)??[],jinxes:(h==null?void 0:h.jinxes)??[]}})}async function yf(o=re(Zn)){try{ni.set(!0);const{nightOrders:e}=await kf();Dn.set("Fetching workspace roles…");const n=(await fetch(mn+encodeURIComponent(pn)).then(d=>d.text())).match(/<script[^>]*type=module[^>]*src=["']?(\/workspace\.[^"'\s>]+\.js)["']?/);if(!n)throw new Error("No workspace.<hash>.js found");const i=await fetch(mn+encodeURIComponent(pn+n[1])).then(d=>d.text()),r=$f(i),a=(await bf(o)).roles||{},s=r.map(d=>{const h=a[d.id]||{};return{id:d.id,name:h.name||d.name||d.id,type:d.team||h.team||"unknown",edition:d.edition||"",setup:d.setup??!1,ability:h.ability||d.ability||"",flavor:h.flavor||d.flavor||"",firstNightReminder:h.first||d.firstNightReminder||"",otherNightReminder:h.other||d.otherNightReminder||"",reminders:d.reminders||[],iconUrl:gf({id:d.id,type:d.team||h.team||"",edition:d.edition||""})}});bn.set(s),co.set(e),Zn.set(o);const c=_f(a);Oa.set(c);const f=[];for(const d of s)(d.reminders??[]).forEach((h,m)=>{f.push({key:`${d.id}.${m}.${h}`,id:d.id,index:m,text:h})});uf.set(f);const u=await wf(s);kn.set(u),Dn.set(`Loaded ${s.length} roles, ${u.length} wiki entries, and special night entries (${df[o]||o}).`)}catch(e){console.error(e),Dn.set("Error: "+e)}finally{ni.set(!1)}}function $f(o){const e=/JSON\.parse\('(\[.*?\])'\)/gs;let t;for(;(t=e.exec(o))!==null;){const n=t[1];try{const i=Ra(n),r=JSON.parse(i);if(Array.isArray(r)&&r.length&&typeof r[0]=="object"){const l=r[0];if(typeof l.id=="string"&&(typeof l.team=="string"||typeof l.name=="string"||typeof l.edition=="string"))return r}}catch{}}throw new Error("No workspace role array found in workspace script")}class vf extends ye{constructor(e){super(),we(this,e,null,null,ke,{})}}function ri(o,e,t){const n=o.slice();return n[23]=e[t],n}function Nf(o){let e,t,n=[],i=new Map,r,l,a=X(o[4]);const s=c=>c[23].id;for(let c=0;c<a.length;c+=1){let f=ri(o,a,c),u=s(f);i.set(u,n[c]=ci(u,f))}return{c(){e=$("p"),e.textContent="Follow this list as the Storyteller to run the Night.",t=D();for(let c=0;c<n.length;c+=1)n[c].c();r=de(),p(e,"class","note svelte-7ank8z")},m(c,f){_(c,e,f),_(c,t,f);for(let u=0;u<n.length;u+=1)n[u]&&n[u].m(c,f);_(c,r,f),l=!0},p(c,f){f&144&&(a=X(c[4]),ne(),n=He(n,f,s,1,c,a,i,r.parentNode,Ve,ci,r,ri),oe())},i(c){if(!l){for(let f=0;f<a.length;f+=1)y(n[f]);l=!0}},o(c){for(let f=0;f<n.length;f+=1)N(n[f]);l=!1},d(c){c&&(g(e),g(t),g(r));for(let f=0;f<n.length;f+=1)n[f].d(c)}}}function If(o){let e,t;return{c(){e=$("p"),t=C(o[3]),ce(e,"color","red")},m(n,i){_(n,e,i),b(e,t)},p(n,i){i&8&&J(t,n[3])},i:te,o:te,d(n){n&&g(e)}}}function Of(o){let e;return{c(){e=$("p"),e.textContent="Loading data from catalogue..."},m(t,n){_(t,e,n)},p:te,i:te,o:te,d(t){t&&g(e)}}}function li(o){let e,t;return e=new Ia({props:{player:o[23].player}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&16&&(r.player=n[23].player),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function si(o){let e,t,n,i,r,l;return{c(){e=$("div"),t=$("button"),t.textContent="THIS IS THE DEMON",n=D(),i=$("button"),i.textContent="THESE ARE YOUR MINIONS",p(t,"class","card-button svelte-7ank8z"),p(i,"class","card-button svelte-7ank8z"),p(e,"class","button-container svelte-7ank8z")},m(a,s){_(a,e,s),b(e,t),b(e,n),b(e,i),r||(l=[ee(t,"click",o[15]),ee(i,"click",o[16])],r=!0)},p:te,d(a){a&&g(e),r=!1,$e(l)}}}function ai(o){let e,t,n,i,r,l;return{c(){e=$("div"),t=$("button"),t.textContent="THESE ARE YOUR MINIONS",n=D(),i=$("button"),i.textContent="THESE ROLES ARE NOT IN PLAY",p(t,"class","card-button svelte-7ank8z"),p(i,"class","card-button svelte-7ank8z"),p(e,"class","button-container svelte-7ank8z")},m(a,s){_(a,e,s),b(e,t),b(e,n),b(e,i),r||(l=[ee(t,"click",o[17]),ee(i,"click",o[18])],r=!0)},p:te,d(a){a&&g(e),r=!1,$e(l)}}}function ci(o,e){let t,n,i=e[23].name.toUpperCase()+"",r,l,a,s=e[23].instruction+"",c,f,u,d,h,m,k=e[23].player&&li(e),w=e[23].id==="minioninfo"&&si(e),O=e[23].id==="demoninfo"&&ai(e);return{key:o,first:null,c(){t=$("div"),n=$("div"),r=C(i),l=D(),a=$("div"),c=D(),k&&k.c(),f=D(),w&&w.c(),u=D(),O&&O.c(),d=D(),p(n,"class","step-name svelte-7ank8z"),p(a,"class","step-instruction svelte-7ank8z"),p(t,"class",h="night-step "+(e[23].player&&!e[23].player.alive?"dead-player":"")+" svelte-7ank8z"),this.first=t},m(I,T){_(I,t,T),b(t,n),b(n,r),b(t,l),b(t,a),a.innerHTML=s,b(t,c),k&&k.m(t,null),b(t,f),w&&w.m(t,null),b(t,u),O&&O.m(t,null),b(t,d),m=!0},p(I,T){e=I,(!m||T&16)&&i!==(i=e[23].name.toUpperCase()+"")&&J(r,i),(!m||T&16)&&s!==(s=e[23].instruction+"")&&(a.innerHTML=s),e[23].player?k?(k.p(e,T),T&16&&y(k,1)):(k=li(e),k.c(),y(k,1),k.m(t,f)):k&&(ne(),N(k,1,1,()=>{k=null}),oe()),e[23].id==="minioninfo"?w?w.p(e,T):(w=si(e),w.c(),w.m(t,u)):w&&(w.d(1),w=null),e[23].id==="demoninfo"?O?O.p(e,T):(O=ai(e),O.c(),O.m(t,d)):O&&(O.d(1),O=null),(!m||T&16&&h!==(h="night-step "+(e[23].player&&!e[23].player.alive?"dead-player":"")+" svelte-7ank8z"))&&p(t,"class",h)},i(I){m||(y(k),m=!0)},o(I){N(k),m=!1},d(I){I&&g(t),k&&k.d(),w&&w.d(),O&&O.d()}}}function Rf(o){let e,t,n,i,r,l;const a=[Of,If,Nf],s=[];function c(f,u){return f[0]?0:f[3]?1:2}return t=c(o),n=s[t]=a[t](o),{c(){e=$("div"),n.c(),p(e,"class","night-order-list svelte-7ank8z")},m(f,u){_(f,e,u),s[t].m(e,null),o[19](e),i=!0,r||(l=ee(e,"scroll",o[6]),r=!0)},p(f,u){let d=t;t=c(f),t===d?s[t].p(f,u):(ne(),N(s[d],1,1,()=>{s[d]=null}),oe(),n=s[t],n?n.p(f,u):(n=s[t]=a[t](f),n.c()),y(n,1),n.m(e,null))},i(f){i||(y(n),i=!0)},o(f){N(n),i=!1},d(f){f&&g(e),s[t].d(),o[19](null),r=!1,l()}}}function Tf(o){let e;return{c(){e=C("Cards")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Ef(o){let e,t;return e=new Z({props:{$$slots:{default:[Tf]},$$scope:{ctx:o}}}),e.$on("click",o[14]),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&67108864&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Df(o){let e=o[1].currentNightType==="first"?"Show Other Nights":"Show First Night",t;return{c(){t=C(e)},m(n,i){_(n,t,i)},p(n,i){i&2&&e!==(e=n[1].currentNightType==="first"?"Show Other Nights":"Show First Night")&&J(t,e)},d(n){n&&g(t)}}}function Af(o){let e;return{c(){e=C("Close")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Sf(o){let e,t,n,i;return e=new Z({props:{$$slots:{default:[Df]},$$scope:{ctx:o}}}),e.$on("click",o[13]),n=new Z({props:{$$slots:{default:[Af]},$$scope:{ctx:o}}}),n.$on("click",o[5]),{c(){j(e.$$.fragment),t=D(),j(n.$$.fragment)},m(r,l){G(e,r,l),_(r,t,l),G(n,r,l),i=!0},p(r,l){const a={};l&67108866&&(a.$$scope={dirty:l,ctx:r}),e.$set(a);const s={};l&67108864&&(s.$$scope={dirty:l,ctx:r}),n.$set(s)},i(r){i||(y(e.$$.fragment,r),y(n.$$.fragment,r),i=!0)},o(r){N(e.$$.fragment,r),N(n.$$.fragment,r),i=!1},d(r){r&&g(t),F(e,r),F(n,r)}}}function Cf(o){let e,t;return e=new De({props:{show:o[1].showNightOrderModal,onClose:o[5],title:`Night Order: ${o[1].currentNightType==="first"?"First Night":"Other Nights"}`,$$slots:{footer:[Sf],"footer-left":[Ef],default:[Rf]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,[i]){const r={};i&2&&(r.show=n[1].showNightOrderModal),i&2&&(r.title=`Night Order: ${n[1].currentNightType==="first"?"First Night":"Other Nights"}`),i&67108895&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Mf(o){return o.replace(/\*(.*?)\*/g,"<u>$1</u>")}function Lf(o){return Mf((o??"").replace(/\r/g,"").replace(/:reminder:/g,"◉").split(`
`).map(e=>e.startsWith("	")?"✦ "+e.replace(/^\t+/,""):e).join(`
`))}function Uf(o){const e=o.toLowerCase();return e==="dusk"?"Dusk":e==="dawn"?"Dawn":e==="minioninfo"?"Minion Info":e==="demoninfo"?"Demon Info":o.replace(/[_-]+/g," ").replace(/\b\w/g,t=>t.toUpperCase())}function Pf(o,e,t){let n,i,r,l,a;se(o,co,v=>t(10,i=v)),se(o,Oa,v=>t(11,r=v)),se(o,bn,v=>t(12,l=v)),se(o,q,v=>t(1,a=v));let s,c=!0,f=null,u=[],d=[];function h(){q.update(v=>({...v,showNightOrderModal:!1}))}function m(v){const Y=Vn(v);return Y&&Y.length>0}function k(v){const Y=[];for(const W of v){if(["dusk","dawn","minioninfo","demoninfo"].includes(W.id)){Y.push(W);continue}const z=Vn(W.id);if(z!=null&&z.length)for(const B of z)Y.push({...W,id:`${W.id}-${B.id}`,roleId:W.id,player:B,playerId:B.id,playerName:B.playerName,name:`${W.name} (${B.playerName})`})}return Y}function w(v,Y,W,z){if(!(v!=null&&v.length))return[];let B=v.map(L=>{const S=W[L.toLowerCase()]||z[L.toLowerCase()];if(!S)return null;const P=Y==="first"?S.firstNightReminder??"":S.otherNightReminder??"",K=Lf(P);return{id:S.id,name:S.name??Uf(S.id),instruction:K}}).filter(Boolean).filter(L=>["dusk","dawn","minioninfo","demoninfo"].includes(String(L.id).toLowerCase())||m(L.id));return B=k(B),B}mt(()=>{const{currentNightType:v,nightOrderScrollFirst:Y,nightOrderScrollOther:W}=re(q),z=v==="first"?Y:W;setTimeout(()=>{s&&t(2,s.scrollTop=z,s)},0)}),at(()=>{});function O(){const v=(s==null?void 0:s.scrollTop)??0;q.update(Y=>({...Y,...Y.currentNightType==="first"?{nightOrderScrollFirst:v}:{nightOrderScrollOther:v}}))}function I(v,Y=it){const W=_t(v,Y);W&&q.update(z=>({...z,currentCard:W,showCardModal:!0}))}const T=()=>q.update(v=>({...v,currentNightType:v.currentNightType==="first"?"other":"first"})),E=()=>q.update(v=>({...v,showCardSelectionModal:!0})),R=()=>I("demon",it),H=()=>I("minions",it),A=()=>I("minions",it),M=()=>I("roles_not_in_play",re(io));function U(v){et[v?"unshift":"push"](()=>{s=v,t(2,s)})}return o.$$.update=()=>{o.$$.dirty&7169&&function(){var Y,W;try{const z=l||[],B=r||[],L=i||{firstNight:[],otherNight:[]},S={};for(const K of z)K!=null&&K.id&&(S[String(K.id).toLowerCase()]=K);const P={};for(const K of B)K!=null&&K.id&&(P[String(K.id).toLowerCase()]=K);t(0,c=!(z.length&&((Y=L.firstNight)!=null&&Y.length||(W=L.otherNight)!=null&&W.length))),c||(t(8,u=w(L.firstNight||[],"first",S,P)),t(9,d=w(L.otherNight||[],"other",S,P)),t(3,f=null))}catch(z){console.error(z),t(3,f=(z==null?void 0:z.message)??"Unknown error"),t(0,c=!1)}}(),o.$$.dirty&770&&t(4,n=a.currentNightType==="first"?u:d)},[c,a,s,f,n,h,O,I,u,d,i,r,l,T,E,R,H,A,M,U]}class Bf extends ye{constructor(e){super(),we(this,e,Pf,Cf,ke,{})}}function Yf(o){let e,t,n,i,r,l,a,s,c,f;return{c(){e=Ee("svg"),t=Ee("defs"),n=Ee("path"),r=Ee("text"),l=Ee("textPath"),a=Ee("tspan"),s=C(o[0]),p(n,"id",o[15]),p(n,"d",i=`M ${o[13]-o[2]} ${o[13]} A ${o[2]} ${o[2]} 0 0,${o[14]} ${o[13]+o[2]} ${o[13]}`),p(a,"dy",o[16]),p(l,"href",`#${o[15]}`),p(l,"startOffset",o[3]),p(r,"font-size",o[5]),p(r,"font-family",o[6]),p(r,"font-weight",o[7]),p(r,"fill",o[8]),p(r,"text-anchor","middle"),p(r,"style",c=o[9]?`text-shadow: ${o[9]}`:void 0),p(r,"letter-spacing",o[4]),p(r,"class","svelte-w804wl"),Oe(r,"uppercase",o[10]),p(e,"class",o[11]),p(e,"style",o[17]),p(e,"width",o[1]),p(e,"height",o[1]),p(e,"viewBox",f=`0 0 ${o[1]} ${o[1]}`),p(e,"aria-hidden","true"),p(e,"pointer-events","none")},m(u,d){_(u,e,d),b(e,t),b(t,n),b(e,r),b(r,l),b(l,a),b(a,s)},p(u,d){d&4&&i!==(i=`M ${u[13]-u[2]} ${u[13]} A ${u[2]} ${u[2]} 0 0,${u[14]} ${u[13]+u[2]} ${u[13]}`)&&p(n,"d",i),d&1&&J(s,u[0]),d&8&&p(l,"startOffset",u[3]),d&32&&p(r,"font-size",u[5]),d&64&&p(r,"font-family",u[6]),d&128&&p(r,"font-weight",u[7]),d&256&&p(r,"fill",u[8]),d&512&&c!==(c=u[9]?`text-shadow: ${u[9]}`:void 0)&&p(r,"style",c),d&16&&p(r,"letter-spacing",u[4]),d&1024&&Oe(r,"uppercase",u[10]),d&2048&&p(e,"class",u[11]),d&2&&p(e,"width",u[1]),d&2&&p(e,"height",u[1]),d&2&&f!==(f=`0 0 ${u[1]} ${u[1]}`)&&p(e,"viewBox",f)},d(u){u&&g(e)}}}function Hf(o){let e,t,n,i,r,l,a,s,c;return{c(){e=Ee("g"),t=Ee("defs"),n=Ee("path"),r=Ee("text"),l=Ee("textPath"),a=Ee("tspan"),s=C(o[0]),p(n,"id",o[15]),p(n,"d",i=`M ${o[13]-o[2]} ${o[13]} A ${o[2]} ${o[2]} 0 0,${o[14]} ${o[13]+o[2]} ${o[13]}`),p(a,"dy",o[16]),p(l,"href",`#${o[15]}`),p(l,"startOffset",o[3]),p(r,"font-size",o[5]),p(r,"font-family",o[6]),p(r,"font-weight",o[7]),p(r,"fill",o[8]),p(r,"text-anchor","middle"),p(r,"style",c=o[9]?`text-shadow: ${o[9]}`:void 0),p(r,"letter-spacing",o[4]),p(r,"class","svelte-w804wl"),Oe(r,"uppercase",o[10])},m(f,u){_(f,e,u),b(e,t),b(t,n),b(e,r),b(r,l),b(l,a),b(a,s)},p(f,u){u&4&&i!==(i=`M ${f[13]-f[2]} ${f[13]} A ${f[2]} ${f[2]} 0 0,${f[14]} ${f[13]+f[2]} ${f[13]}`)&&p(n,"d",i),u&1&&J(s,f[0]),u&8&&p(l,"startOffset",f[3]),u&32&&p(r,"font-size",f[5]),u&64&&p(r,"font-family",f[6]),u&128&&p(r,"font-weight",f[7]),u&256&&p(r,"fill",f[8]),u&512&&c!==(c=f[9]?`text-shadow: ${f[9]}`:void 0)&&p(r,"style",c),u&16&&p(r,"letter-spacing",f[4]),u&1024&&Oe(r,"uppercase",f[10])},d(f){f&&g(e)}}}function Gf(o){let e;function t(r,l){return r[12]?Hf:Yf}let n=t(o),i=n(o);return{c(){i.c(),e=de()},m(r,l){i.m(r,l),_(r,e,l)},p(r,[l]){n===(n=t(r))&&i?i.p(r,l):(i.d(1),i=n(r),i&&(i.c(),i.m(e.parentNode,e)))},i:te,o:te,d(r){r&&g(e),i.d(r)}}}function Ff(o,e,t){let{text:n}=e,{diameter:i=80}=e,{radius:r=40}=e,{direction:l="bottom"}=e,{startOffset:a="50%"}=e,{letterSpacing:s=0}=e,{fontSize:c="1rem"}=e,{fontFamily:f="inherit"}=e,{fontWeight:u="normal"}=e,{fill:d="#fff"}=e,{textShadow:h=""}=e,{uppercase:m=!0}=e,{svgClass:k=""}=e,{asGroup:w=!1}=e;const O=i/2,I=l==="top"?1:0,T=`curve-${Math.random().toString(36).slice(2,8)}`,E=l==="top"?"0.85em":"-0.1em",H=`
    position:absolute;
    left:50%;
    transform:translateX(-50%);
    ${l==="top"?"top:0%":"bottom:0%"};
    width:${i}px;
    height:${i}px;
    z-index:1;
  `;return o.$$set=A=>{"text"in A&&t(0,n=A.text),"diameter"in A&&t(1,i=A.diameter),"radius"in A&&t(2,r=A.radius),"direction"in A&&t(18,l=A.direction),"startOffset"in A&&t(3,a=A.startOffset),"letterSpacing"in A&&t(4,s=A.letterSpacing),"fontSize"in A&&t(5,c=A.fontSize),"fontFamily"in A&&t(6,f=A.fontFamily),"fontWeight"in A&&t(7,u=A.fontWeight),"fill"in A&&t(8,d=A.fill),"textShadow"in A&&t(9,h=A.textShadow),"uppercase"in A&&t(10,m=A.uppercase),"svgClass"in A&&t(11,k=A.svgClass),"asGroup"in A&&t(12,w=A.asGroup)},[n,i,r,a,s,c,f,u,d,h,m,k,w,O,I,T,E,H,l]}class Un extends ye{constructor(e){super(),we(this,e,Ff,Gf,ke,{text:0,diameter:1,radius:2,direction:18,startOffset:3,letterSpacing:4,fontSize:5,fontFamily:6,fontWeight:7,fill:8,textShadow:9,uppercase:10,svgClass:11,asGroup:12})}}function jf(o){let e,t,n,i,r,l,a;return{c(){e=$("div"),t=$("i"),n=$("i"),i=D(),r=$("div"),l=$("span"),a=C(o[0]),p(t,"class","l svelte-15kigte"),p(n,"class","r svelte-15kigte"),p(l,"class","svelte-15kigte"),p(r,"class","text-wrapper svelte-15kigte"),p(e,"class","ability-inside svelte-15kigte"),ce(e,"font-size",o[1]),ce(e,"color",o[2])},m(s,c){_(s,e,c),b(e,t),b(e,n),b(e,i),b(e,r),b(r,l),b(l,a),o[7](l),o[8](r),o[9](e)},p(s,[c]){c&1&&J(a,s[0]),c&2&&ce(e,"font-size",s[1]),c&4&&ce(e,"color",s[2])},i:te,o:te,d(s){s&&g(e),o[7](null),o[8](null),o[9](null)}}}function zf(o,e,t){let{text:n}=e,{radius:i=100}=e,{fontSize:r="0.75rem"}=e,{color:l="white"}=e,a=null,s=null,c=null;async function f(){if(await ca(),!a||!s||!c)return;const m=i;let k=0;const w=1,O=m;for(t(4,s.style.paddingTop="0px",s);k<O;){t(4,s.style.paddingTop=k+"px",s);const I=c.getBoundingClientRect(),T=a.getBoundingClientRect();if(I.bottom-T.top>=m){const R=Math.max(0,(k-w)/2);t(4,s.style.paddingTop=R+"px",s);break}k+=w}}mt(()=>(f(),window.addEventListener("resize",f),()=>window.removeEventListener("resize",f)));function u(m){et[m?"unshift":"push"](()=>{c=m,t(5,c)})}function d(m){et[m?"unshift":"push"](()=>{s=m,t(4,s)})}function h(m){et[m?"unshift":"push"](()=>{a=m,t(3,a)})}return o.$$set=m=>{"text"in m&&t(0,n=m.text),"radius"in m&&t(6,i=m.radius),"fontSize"in m&&t(1,r=m.fontSize),"color"in m&&t(2,l=m.color)},[n,r,l,a,s,c,i,u,d,h]}class Kf extends ye{constructor(e){super(),we(this,e,zf,jf,ke,{text:0,radius:6,fontSize:1,color:2})}}function Wf(o){let e,t,n,i,r,l=o[9]&&fi(o),a=o[8]&&ui(o),s=o[6]&&di(o);return{c(){e=$("div"),l&&l.c(),t=D(),a&&a.c(),n=D(),s&&s.c(),p(e,"class",i="role-token "+o[1].toLowerCase()+" "+o[2]+" svelte-x2wwrb")},m(c,f){_(c,e,f),l&&l.m(e,null),b(e,t),a&&a.m(e,null),b(e,n),s&&s.m(e,null),r=!0},p(c,f){c[9]?l?(l.p(c,f),f&512&&y(l,1)):(l=fi(c),l.c(),y(l,1),l.m(e,t)):l&&(ne(),N(l,1,1,()=>{l=null}),oe()),c[8]?a?(a.p(c,f),f&256&&y(a,1)):(a=ui(c),a.c(),y(a,1),a.m(e,n)):a&&(ne(),N(a,1,1,()=>{a=null}),oe()),c[6]?s?s.p(c,f):(s=di(c),s.c(),s.m(e,null)):s&&(s.d(1),s=null),(!r||f&6&&i!==(i="role-token "+c[1].toLowerCase()+" "+c[2]+" svelte-x2wwrb"))&&p(e,"class",i)},i(c){r||(y(l),y(a),r=!0)},o(c){N(l),N(a),r=!1},d(c){c&&g(e),l&&l.d(),a&&a.d(),s&&s.d()}}}function qf(o){let e,t,n,i,r,l=o[0].name+"",a,s,c,f=o[0].abilityDescription+"",u,d;function h(w,O){return w[6]?Zf:Jf}let m=h(o),k=m(o);return{c(){e=$("div"),t=$("div"),k.c(),n=D(),i=$("div"),r=$("div"),a=C(l),s=D(),c=$("div"),u=C(f),p(t,"class","cell-icon svelte-x2wwrb"),p(r,"class","name svelte-x2wwrb"),p(c,"class","ability"),p(i,"class","cell-content svelte-x2wwrb"),p(e,"class",d="role-token cell "+o[1].toLowerCase()+" svelte-x2wwrb")},m(w,O){_(w,e,O),b(e,t),k.m(t,null),b(e,n),b(e,i),b(i,r),b(r,a),b(i,s),b(i,c),b(c,u)},p(w,O){m===(m=h(w))&&k?k.p(w,O):(k.d(1),k=m(w),k&&(k.c(),k.m(t,null))),O&1&&l!==(l=w[0].name+"")&&J(a,l),O&1&&f!==(f=w[0].abilityDescription+"")&&J(u,f),O&2&&d!==(d="role-token cell "+w[1].toLowerCase()+" svelte-x2wwrb")&&p(e,"class",d)},i:te,o:te,d(w){w&&g(e),k.d()}}}function fi(o){let e,t;return e=new Un({props:{svgClass:`role-tag-curve role-tag-curve-${o[2]}`,text:o[0].name,diameter:o[4],radius:o[7],startOffset:"50%",letterSpacing:o[2]==="big"?4:1,fontSize:o[2]==="big"?"1.8rem":"0.66rem",fontFamily:o[2]==="big"?"Dumbledore":"inherit",uppercase:!0,direction:(o[2]==="big","bottom")}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&4&&(r.svgClass=`role-tag-curve role-tag-curve-${n[2]}`),i&1&&(r.text=n[0].name),i&16&&(r.diameter=n[4]),i&128&&(r.radius=n[7]),i&4&&(r.letterSpacing=n[2]==="big"?4:1),i&4&&(r.fontSize=n[2]==="big"?"1.8rem":"0.66rem"),i&4&&(r.fontFamily=n[2]==="big"?"Dumbledore":"inherit"),i&4&&(r.direction=(n[2]==="big","bottom")),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function ui(o){let e,t,n,i;const r=[Xf,Vf],l=[];function a(s,c){return s[2]==="big"?0:1}return e=a(o),t=l[e]=r[e](o),{c(){t.c(),n=de()},m(s,c){l[e].m(s,c),_(s,n,c),i=!0},p(s,c){let f=e;e=a(s),e===f?l[e].p(s,c):(ne(),N(l[f],1,1,()=>{l[f]=null}),oe(),t=l[e],t?t.p(s,c):(t=l[e]=r[e](s),t.c()),y(t,1),t.m(n.parentNode,n))},i(s){i||(y(t),i=!0)},o(s){N(t),i=!1},d(s){s&&g(n),l[e].d(s)}}}function Vf(o){let e,t=o[0].abilityDescription+"",n;return{c(){e=$("div"),n=C(t),p(e,"class","ability-tag svelte-x2wwrb")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r&1&&t!==(t=i[0].abilityDescription+"")&&J(n,t)},i:te,o:te,d(i){i&&g(e)}}}function Xf(o){let e,t;return e=new Kf({props:{text:o[0].abilityDescription,radius:o[3],fontSize:"0.75rem",color:"white"}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&1&&(r.text=n[0].abilityDescription),i&8&&(r.radius=n[3]),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function di(o){let e,t,n,i,r;return{c(){e=$("img"),p(e,"class","role-icon svelte-x2wwrb"),Jt(e.src,t=o[6])||p(e,"src",t),p(e,"alt",n=o[0].name),p(e,"draggable","false"),ce(e,"transform","scale("+o[5]+")")},m(l,a){_(l,e,a),i||(r=ee(e,"dragstart",Lt(o[13])),i=!0)},p(l,a){a&64&&!Jt(e.src,t=l[6])&&p(e,"src",t),a&1&&n!==(n=l[0].name)&&p(e,"alt",n),a&32&&ce(e,"transform","scale("+l[5]+")")},d(l){l&&g(e),i=!1,r()}}}function Jf(o){let e,t=o[0].name.charAt(0)+"",n,i;return{c(){e=$("div"),n=C(t),p(e,"aria-label",i=o[0].name),p(e,"class","svelte-x2wwrb")},m(r,l){_(r,e,l),b(e,n)},p(r,l){l&1&&t!==(t=r[0].name.charAt(0)+"")&&J(n,t),l&1&&i!==(i=r[0].name)&&p(e,"aria-label",i)},d(r){r&&g(e)}}}function Zf(o){let e,t,n,i,r;return{c(){e=$("img"),Jt(e.src,t=o[6])||p(e,"src",t),p(e,"alt",n=o[0].name),p(e,"draggable","false"),ce(e,"transform","scale("+o[5]+")"),p(e,"class","svelte-x2wwrb")},m(l,a){_(l,e,a),i||(r=ee(e,"dragstart",Lt(o[12])),i=!0)},p(l,a){a&64&&!Jt(e.src,t=l[6])&&p(e,"src",t),a&1&&n!==(n=l[0].name)&&p(e,"alt",n),a&32&&ce(e,"transform","scale("+l[5]+")")},d(l){l&&g(e),i=!1,r()}}}function Qf(o){let e,t,n,i;const r=[qf,Wf],l=[];function a(s,c){return s[2]==="cell"?0:1}return e=a(o),t=l[e]=r[e](o),{c(){t.c(),n=de()},m(s,c){l[e].m(s,c),_(s,n,c),i=!0},p(s,[c]){let f=e;e=a(s),e===f?l[e].p(s,c):(ne(),N(l[f],1,1,()=>{l[f]=null}),oe(),t=l[e],t?t.p(s,c):(t=l[e]=r[e](s),t.c()),y(t,1),t.m(n.parentNode,n))},i(s){i||(y(t),i=!0)},o(s){N(t),i=!1},d(s){s&&g(n),l[e].d(s)}}}const xf=2;function eu(o,e,t){let n,i,r,l,a,s,c,f,u;se(o,bn,I=>t(10,f=I)),se(o,q,I=>t(11,u=I));let{role:d}=e,{alignment:h=d.defaultAlignment}=e,{size:m="normal"}=e;function k(I,T=f){const E=T.find(R=>R.id===I);return(E==null?void 0:E.iconUrl)||""}function w(I){dn.call(this,o,I)}function O(I){dn.call(this,o,I)}return o.$$set=I=>{"role"in I&&t(0,d=I.role),"alignment"in I&&t(1,h=I.alignment),"size"in I&&t(2,m=I.size)},o.$$.update=()=>{o.$$.dirty&2052&&t(9,n=m==="small"||m==="big"||m==="normal"&&u.showRolenames),o.$$.dirty&2052&&t(8,i=m==="small"||m==="big"||m==="normal"&&u.showAbilityTags),o.$$.dirty&4&&t(4,r=m==="small"?60:m==="big"?200:80),o.$$.dirty&16&&t(3,l=r/2),o.$$.dirty&8&&t(7,a=l-xf),o.$$.dirty&1025&&t(6,s=k(d.id,f))},t(5,c=1),[d,h,m,l,r,c,s,a,i,n,f,u,w,O]}class Ut extends ye{constructor(e){super(),we(this,e,eu,Qf,ke,{role:0,alignment:1,size:2})}}function tu(){const o=["Aisha","Kwame","Priya","Jian","Mateo","Fatima","Chen","Diego","Nia","Amara","Ravi","Sofia","Omar","Amina","Lian","Juan","Zara","Yusuf","Anya","Kimani","Layla","Manuel","Sakura","Bashir","Esra","Cai","Gabriela","Kofi","Mei","Pedro","Rania","Haruto","Isabella","Jabari","Naledi","Thabo","Chun","Daniela","Rajesh","Samira","Wei","Camila","Malik","Anika","Hassan","Lena","Carlos","Dara","Zola","Akira","Alice","Bob","Charlie","David","Eve","Frank","Grace","Heidi","Ivan","Judy","Karl","Liam","Mia","Noah","Olivia","Peter","Quinn","Rachel","Sam","Tina","Uma","Victor","Wendy","Xavier","Yara","Zoe","Aaron","Bella","Caleb","Daisy","Ethan","Fiona","George","Hannah","Isaac","Jasmine","Kevin","Laura","Mike","Nora","Oscar","Pamela","Quentin","Ruby","Steve","Tara","Violet","Will","Xenia","Zack"],e=Math.floor(Math.random()*o.length);return o[e]}function nu(o){var r;const t=re(Re)[o];if(!t)throw new Error(`Unknown roleId: ${o}`);let n;q.update(l=>(n=l.counters.playerId,{...l,counters:{...l.counters,playerId:n+1}}));const i={id:n,roleId:o,alignment:t.defaultAlignment,playerName:tu(),alive:!0,ghostVote:!0};if(ae.update(l=>(l.playerTokens.push(i),l)),(r=t.associatedReminders)!=null&&r.length)for(const l of t.associatedReminders)Yn({reminderId:l,ownerId:n,attachedToId:n});return i}function ou(o){ae.update(e=>(e.playerTokens.find(n=>n.id===o)&&(e.ReminderTokens=e.ReminderTokens.filter(n=>n.ownerId!==o&&n.attachedToId!==o),e.playerTokens=e.playerTokens.filter(n=>n.id!==o)),e)),Te.update(e=>{const{[o]:t,...n}=e.playerPositions;return{...e,playerPositions:n}})}function Wn(o,e){ae.update(t=>{const n=t.playerTokens.find(i=>i.id===o);return n&&Object.assign(n,e),t})}function iu(o){return _n().playerTokens.find(e=>e.id===o)}function hi(o){const e=iu(o);e&&q.update(t=>({...t,editingPlayer:e,showEditModal:!0}))}function ru(o,e){ae.update(t=>{var l;const i=re(Re)[e];if(!i)return t;const r=t.playerTokens.find(a=>a.id===o);if(!r)return t;if(t.ReminderTokens=t.ReminderTokens.filter(a=>a.ownerId!==o),r.roleId=e,r.alignment=i.defaultAlignment,(l=i.associatedReminders)!=null&&l.length)for(const a of i.associatedReminders)Yn({reminderId:a,ownerId:o,attachedToId:o});return t})}function Ea(o,e){ae.update(t=>{const n=t.playerTokens.find(r=>r.id===o),i=t.playerTokens.find(r=>r.id===e);return!n||!i||([n.roleId,i.roleId]=[i.roleId,n.roleId],[n.alignment,i.alignment]=[i.alignment,n.alignment],t.ReminderTokens=t.ReminderTokens.map(r=>r.ownerId===o?{...r,ownerId:e}:r.ownerId===e?{...r,ownerId:o}:r)),t})}function lu(o,e){Te.update(t=>{const n=t.playerPositions[o],i=t.playerPositions[e];return!n||!i?t:{...t,playerPositions:{...t.playerPositions,[o]:i,[e]:n}}})}function su(o){ae.update(e=>{const t=e.playerTokens.find(n=>n.id===o);return t&&(t.alive=!1,e.ReminderTokens=e.ReminderTokens.map(n=>n.ownerId===o?{...n,enabled:!1}:n)),e})}function au(o){ae.update(e=>{const t=e.playerTokens.find(n=>n.id===o);return t&&(t.alive=!0,e.ReminderTokens=e.ReminderTokens.map(n=>n.ownerId===o?{...n,enabled:!0}:n)),e})}function mi(o,e,t){const n=o.slice();return n[32]=e[t],n}function pi(o,e,t){const n=o.slice();return n[32]=e[t],n}function gi(o,e,t){const n=o.slice();return n[37]=e[t],n}function _i(o,e,t){const n=o.slice();return n[40]=e[t],n}function bi(o){let e,t;return e=new De({props:{show:!0,title:`Edit Player: ${o[0].playerName}`,onClose:o[13],focusmodeAllowed:!1,$$slots:{footer:[Nu],"footer-left":[$u],default:[ku]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i[0]&1&&(r.title=`Edit Player: ${n[0].playerName}`),i[0]&31|i[1]&4096&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function ki(o){let e,t,n,i=o[2].flavour_text+"",r;return{c(){e=$("div"),t=$("p"),n=$("em"),r=C(i),p(t,"class","flavor-text svelte-62u519"),p(e,"class","role-flavor-col svelte-62u519")},m(l,a){_(l,e,a),b(e,t),b(t,n),b(n,r)},p(l,a){a[0]&4&&i!==(i=l[2].flavour_text+"")&&J(r,i)},d(l){l&&g(e)}}}function wi(o){let e,t,n,i,r,l,a,s=X(o[2].how_to_run),c=[];for(let f=0;f<s.length;f+=1)c[f]=yi(_i(o,s,f));return l=new Z({props:{$$slots:{default:[cu]},$$scope:{ctx:o}}}),l.$on("click",o[22]),{c(){e=$("details"),t=$("summary"),t.textContent="How to run",n=D();for(let f=0;f<c.length;f+=1)c[f].c();i=D(),r=$("div"),j(l.$$.fragment),p(t,"class","svelte-62u519"),p(r,"class","explain-button svelte-62u519"),p(e,"class","how-to-run svelte-62u519")},m(f,u){_(f,e,u),b(e,t),b(e,n);for(let d=0;d<c.length;d+=1)c[d]&&c[d].m(e,null);b(e,i),b(e,r),G(l,r,null),a=!0},p(f,u){if(u[0]&4){s=X(f[2].how_to_run);let h;for(h=0;h<s.length;h+=1){const m=_i(f,s,h);c[h]?c[h].p(m,u):(c[h]=yi(m),c[h].c(),c[h].m(e,i))}for(;h<c.length;h+=1)c[h].d(1);c.length=s.length}const d={};u[1]&4096&&(d.$$scope={dirty:u,ctx:f}),l.$set(d)},i(f){a||(y(l.$$.fragment,f),a=!0)},o(f){N(l.$$.fragment,f),a=!1},d(f){f&&g(e),me(c,f),F(l)}}}function yi(o){let e,t=o[40]+"",n;return{c(){e=$("p"),n=C(t),p(e,"class","svelte-62u519")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r[0]&4&&t!==(t=i[40]+"")&&J(n,t)},d(i){i&&g(e)}}}function cu(o){let e;return{c(){e=C("Read Full Almanac Entry")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function fu(o){let e;return{c(){e=C("Alive")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function $i(o){let e,t;return e=new Z({props:{type:"checkbox",id:"ghostVoteStatus",checked:o[0].ghostVote,"aria-pressed":o[0].ghostVote,$$slots:{default:[uu]},$$scope:{ctx:o}}}),e.$on("toggle",o[24]),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i[0]&1&&(r.checked=n[0].ghostVote),i[0]&1&&(r["aria-pressed"]=n[0].ghostVote),i[1]&4096&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function uu(o){let e;return{c(){e=C("Ghost Vote")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function vi(o){let e,t=o[1][o[37]].name+"",n,i,r=o[3].playerTokens.some(s),l,a;function s(...u){return o[21](o[37],...u)}let c=r&&Ni();function f(...u){return o[25](o[37],...u)}return{c(){e=$("option"),n=C(t),i=D(),c&&c.c(),l=D(),e.__value=a=o[37],Ne(e,e.__value),Oe(e,"is-in-play",o[3].playerTokens.some(f))},m(u,d){_(u,e,d),b(e,n),b(e,i),c&&c.m(e,null),b(e,l)},p(u,d){o=u,d[0]&10&&t!==(t=o[1][o[37]].name+"")&&J(n,t),d[0]&9&&(r=o[3].playerTokens.some(s)),r?c||(c=Ni(),c.c(),c.m(e,l)):c&&(c.d(1),c=null),d[0]&8&&a!==(a=o[37])&&(e.__value=a,Ne(e,e.__value)),d[0]&9&&Oe(e,"is-in-play",o[3].playerTokens.some(f))},d(u){u&&g(e),c&&c.d()}}}function Ni(o){let e=" ",t,n;return{c(){t=C(e),n=C("— IN PLAY")},m(i,r){_(i,t,r),_(i,n,r)},d(i){i&&(g(t),g(n))}}}function Ii(o){let e,t=o[1][o[37]]&&vi(o);return{c(){t&&t.c(),e=de()},m(n,i){t&&t.m(n,i),_(n,e,i)},p(n,i){n[1][n[37]]?t?t.p(n,i):(t=vi(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(n){n&&g(e),t&&t.d(n)}}}function Oi(o){var c;let e,t=((c=o[1][o[32].roleId])==null?void 0:c.name)+"",n,i,r=o[32].playerName+"",l,a,s;return{c(){e=$("option"),n=C(t),i=C(" ("),l=C(r),a=C(")"),e.__value=s=o[32].id,Ne(e,e.__value)},m(f,u){_(f,e,u),b(e,n),b(e,i),b(e,l),b(e,a)},p(f,u){var d;u[0]&18&&t!==(t=((d=f[1][f[32].roleId])==null?void 0:d.name)+"")&&J(n,t),u[0]&16&&r!==(r=f[32].playerName+"")&&J(l,r),u[0]&16&&s!==(s=f[32].id)&&(e.__value=s,Ne(e,e.__value))},d(f){f&&g(e)}}}function Ri(o){var c;let e,t=((c=o[1][o[32].roleId])==null?void 0:c.name)+"",n,i,r=o[32].playerName+"",l,a,s;return{c(){e=$("option"),n=C(t),i=C(" ("),l=C(r),a=C(")"),e.__value=s=o[32].id,Ne(e,e.__value)},m(f,u){_(f,e,u),b(e,n),b(e,i),b(e,l),b(e,a)},p(f,u){var d;u[0]&18&&t!==(t=((d=f[1][f[32].roleId])==null?void 0:d.name)+"")&&J(n,t),u[0]&16&&r!==(r=f[32].playerName+"")&&J(l,r),u[0]&16&&s!==(s=f[32].id)&&(e.__value=s,Ne(e,e.__value))},d(f){f&&g(e)}}}function du(o){let e;return{c(){e=C("Add Missing Reminders")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function hu(o){let e;return{c(){e=C("Add Other Reminder")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function mu(o){let e,t=o[1][o[0].roleId].name+"",n;return{c(){e=C("You are "),n=C(t)},m(i,r){_(i,e,r),_(i,n,r)},p(i,r){r[0]&3&&t!==(t=i[1][i[0].roleId].name+"")&&J(n,t)},d(i){i&&(g(e),g(n))}}}function pu(o){let e,t=o[1][o[0].roleId].name+"",n;return{c(){e=C("This is "),n=C(t)},m(i,r){_(i,e,r),_(i,n,r)},p(i,r){r[0]&3&&t!==(t=i[1][i[0].roleId].name+"")&&J(n,t)},d(i){i&&(g(e),g(n))}}}function gu(o){let e;return{c(){e=C("You are ...")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function _u(o){let e;return{c(){e=C("This is ...")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function bu(o){let e,t=o[0].playerName+"",n;return{c(){e=C("Delete Player "),n=C(t)},m(i,r){_(i,e,r),_(i,n,r)},p(i,r){r[0]&1&&t!==(t=i[0].playerName+"")&&J(n,t)},d(i){i&&(g(e),g(n))}}}function ku(o){var $o,vo;let e,t,n,i,r,l,a,s,c,f=o[1][o[0].roleId].name+"",u,d,h=o[1][o[0].roleId].category+"",m,k,w=o[1][o[0].roleId].abilityDescription+"",O,I,T,E,R,H,A,M,U,v,Y,W,z,B,L,S,P,K,V,le,he,_e,Ie,rt,Xe,tt,pt,Be,Je,Ze,Qe,ue,Q,fe,ie,pe,xe,Se,We,kt,Ce,Ge,nt,Ye,lt,tn,st,wn,fo,At,uo,Pt,wt,ho,yt,mo,Bt,Fn,po,ct,$t,go,vt,_o,Nt,bo,It,ko,Yt,yn,wo,$n,Ot,ft,jn,yo;l=new Ut({props:{role:o[1][o[0].roleId],alignment:o[0].alignment,size:"small-notext"}});let qe=(($o=o[2])==null?void 0:$o.flavour_text)&&ki(o),Le=((vo=o[2])==null?void 0:vo.how_to_run)&&wi(o);B=new Z({props:{type:"checkbox",id:"aliveStatus",checked:o[0].alive,"aria-pressed":o[0].alive,$$slots:{default:[fu]},$$scope:{ctx:o}}}),B.$on("toggle",o[23]);let Ue=!o[0].alive&&$i(o),Ht=X(o[3].script.roles),Fe=[];for(let x=0;x<Ht.length;x+=1)Fe[x]=Ii(gi(o,Ht,x));let Gt=X(o[4]),je=[];for(let x=0;x<Gt.length;x+=1)je[x]=Oi(pi(o,Gt,x));let Ft=X(o[4]),ze=[];for(let x=0;x<Ft.length;x+=1)ze[x]=Ri(mi(o,Ft,x));return At=new Ia({props:{player:o[0]}}),wt=new Z({props:{$$slots:{default:[du]},$$scope:{ctx:o}}}),wt.$on("click",o[26]),yt=new Z({props:{$$slots:{default:[hu]},$$scope:{ctx:o}}}),yt.$on("click",o[27]),$t=new Z({props:{$$slots:{default:[mu]},$$scope:{ctx:o}}}),$t.$on("click",o[15]),vt=new Z({props:{$$slots:{default:[pu]},$$scope:{ctx:o}}}),vt.$on("click",o[16]),Nt=new Z({props:{$$slots:{default:[gu]},$$scope:{ctx:o}}}),Nt.$on("click",o[17]),It=new Z({props:{$$slots:{default:[_u]},$$scope:{ctx:o}}}),It.$on("click",o[18]),Ot=new Z({props:{type:"danger",$$slots:{default:[bu]},$$scope:{ctx:o}}}),Ot.$on("click",o[14]),{c(){e=$("div"),t=$("div"),n=$("div"),i=$("div"),r=$("div"),j(l.$$.fragment),a=D(),qe&&qe.c(),s=D(),c=$("p"),u=C(f),d=C(`
      (`),m=C(h),k=C("): "),O=C(w),I=D(),Le&&Le.c(),T=D(),E=$("div"),R=$("label"),R.textContent="Player Name:",H=D(),A=$("input"),U=D(),v=$("div"),Y=$("label"),Y.textContent="Status:",W=D(),z=$("div"),j(B.$$.fragment),L=D(),Ue&&Ue.c(),S=D(),P=$("div"),K=$("div"),V=$("label"),V.textContent="Change Role:",le=D(),he=$("select"),_e=$("option"),_e.textContent="Select a role…";for(let x=0;x<Fe.length;x+=1)Fe[x].c();rt=D(),Xe=$("div"),tt=$("label"),tt.textContent="Alignment:",pt=D(),Be=$("select"),Je=$("option"),Je.textContent="Good",Ze=$("option"),Ze.textContent="Evil",Qe=$("option"),Qe.textContent="Unknown",Q=D(),fe=$("div"),ie=$("div"),pe=$("label"),pe.textContent="Swap Role With:",xe=D(),Se=$("select"),We=$("option"),We.textContent="— Choose Player —";for(let x=0;x<je.length;x+=1)je[x].c();kt=D(),Ce=$("div"),Ge=$("label"),Ge.textContent="Swap Seat With:",nt=D(),Ye=$("select"),lt=$("option"),lt.textContent="— Choose Player —";for(let x=0;x<ze.length;x+=1)ze[x].c();tn=D(),st=$("div"),wn=$("h3"),wn.textContent="Reminders",fo=D(),j(At.$$.fragment),uo=D(),Pt=$("div"),j(wt.$$.fragment),ho=D(),j(yt.$$.fragment),mo=D(),Bt=$("div"),Fn=$("h3"),Fn.textContent="Quick Cards",po=D(),ct=$("div"),j($t.$$.fragment),go=D(),j(vt.$$.fragment),_o=D(),j(Nt.$$.fragment),bo=D(),j(It.$$.fragment),ko=D(),Yt=$("div"),yn=$("h3"),yn.textContent="Danger Zone",wo=D(),$n=$("div"),j(Ot.$$.fragment),p(r,"class","role-icon-col svelte-62u519"),p(i,"class","role-header-inner svelte-62u519"),p(n,"class","role-header svelte-62u519"),p(c,"class","role-line svelte-62u519"),p(t,"class","modal-section role-preview svelte-62u519"),p(R,"for","playerName"),p(R,"class","svelte-62u519"),p(A,"id","playerName"),p(A,"type","text"),p(A,"class","modal-input svelte-62u519"),A.value=M=o[0].playerName,p(E,"class","modal-section svelte-62u519"),p(Y,"for","aliveStatus"),p(Y,"class","svelte-62u519"),p(z,"class","checkbox-group svelte-62u519"),p(v,"class","modal-section svelte-62u519"),p(V,"for","changeRole"),p(V,"class","svelte-62u519"),_e.__value="",Ne(_e,_e.__value),_e.disabled=!0,p(he,"id","changeRole"),p(he,"class","modal-input svelte-62u519"),p(K,"class","modal-section svelte-62u519"),p(tt,"for","alignment"),p(tt,"class","svelte-62u519"),Je.__value="Good",Ne(Je,Je.__value),Ze.__value="Evil",Ne(Ze,Ze.__value),Qe.__value="Unknown",Ne(Qe,Qe.__value),p(Be,"id","alignment"),p(Be,"class","modal-input svelte-62u519"),p(Xe,"class","modal-section svelte-62u519"),p(P,"class","modal-grid svelte-62u519"),p(pe,"for","swapRole"),p(pe,"class","svelte-62u519"),We.__value="",Ne(We,We.__value),We.disabled=!0,We.selected=!0,p(Se,"id","swapRole"),p(Se,"class","modal-input svelte-62u519"),p(ie,"class","modal-section svelte-62u519"),p(Ge,"for","swapSeat"),p(Ge,"class","svelte-62u519"),lt.__value="",Ne(lt,lt.__value),lt.disabled=!0,lt.selected=!0,p(Ye,"id","swapSeat"),p(Ye,"class","modal-input svelte-62u519"),p(Ce,"class","modal-section svelte-62u519"),p(fe,"class","modal-grid svelte-62u519"),p(wn,"id","reminders-heading"),p(Pt,"class","card-buttons add-missing-btn svelte-62u519"),p(st,"class","modal-section"),p(ct,"class","modal-grid svelte-62u519"),p(Bt,"class","modal-section"),p(yn,"class","svelte-62u519"),p($n,"class","card-buttons svelte-62u519"),p(Yt,"class","modal-section delete-section svelte-62u519")},m(x,ge){_(x,e,ge),b(e,t),b(t,n),b(n,i),b(i,r),G(l,r,null),b(i,a),qe&&qe.m(i,null),b(t,s),b(t,c),b(c,u),b(c,d),b(c,m),b(c,k),b(c,O),b(t,I),Le&&Le.m(t,null),b(e,T),b(e,E),b(E,R),b(E,H),b(E,A),b(e,U),b(e,v),b(v,Y),b(v,W),b(v,z),G(B,z,null),b(z,L),Ue&&Ue.m(z,null),b(e,S),b(e,P),b(P,K),b(K,V),b(K,le),b(K,he),b(he,_e);for(let Pe=0;Pe<Fe.length;Pe+=1)Fe[Pe]&&Fe[Pe].m(he,null);dt(he,o[0].roleId),b(P,rt),b(P,Xe),b(Xe,tt),b(Xe,pt),b(Xe,Be),b(Be,Je),b(Be,Ze),b(Be,Qe),dt(Be,o[0].alignment),b(e,Q),b(e,fe),b(fe,ie),b(ie,pe),b(ie,xe),b(ie,Se),b(Se,We);for(let Pe=0;Pe<je.length;Pe+=1)je[Pe]&&je[Pe].m(Se,null);b(fe,kt),b(fe,Ce),b(Ce,Ge),b(Ce,nt),b(Ce,Ye),b(Ye,lt);for(let Pe=0;Pe<ze.length;Pe+=1)ze[Pe]&&ze[Pe].m(Ye,null);b(e,tn),b(e,st),b(st,wn),b(st,fo),G(At,st,null),b(st,uo),b(st,Pt),G(wt,Pt,null),b(Pt,ho),G(yt,Pt,null),b(e,mo),b(e,Bt),b(Bt,Fn),b(Bt,po),b(Bt,ct),G($t,ct,null),b(ct,go),G(vt,ct,null),b(ct,_o),G(Nt,ct,null),b(ct,bo),G(It,ct,null),b(e,ko),b(e,Yt),b(Yt,yn),b(Yt,wo),b(Yt,$n),G(Ot,$n,null),ft=!0,jn||(yo=[ee(A,"input",o[8]),ee(he,"change",o[10]),ee(Be,"change",o[9]),ee(Se,"change",o[11]),ee(Ye,"change",o[12])],jn=!0)},p(x,ge){var So,Co;const Pe={};ge[0]&3&&(Pe.role=x[1][x[0].roleId]),ge[0]&1&&(Pe.alignment=x[0].alignment),l.$set(Pe),(So=x[2])!=null&&So.flavour_text?qe?qe.p(x,ge):(qe=ki(x),qe.c(),qe.m(i,null)):qe&&(qe.d(1),qe=null),(!ft||ge[0]&3)&&f!==(f=x[1][x[0].roleId].name+"")&&J(u,f),(!ft||ge[0]&3)&&h!==(h=x[1][x[0].roleId].category+"")&&J(m,h),(!ft||ge[0]&3)&&w!==(w=x[1][x[0].roleId].abilityDescription+"")&&J(O,w),(Co=x[2])!=null&&Co.how_to_run?Le?(Le.p(x,ge),ge[0]&4&&y(Le,1)):(Le=wi(x),Le.c(),y(Le,1),Le.m(t,null)):Le&&(ne(),N(Le,1,1,()=>{Le=null}),oe()),(!ft||ge[0]&9&&M!==(M=x[0].playerName)&&A.value!==M)&&(A.value=M);const vn={};if(ge[0]&1&&(vn.checked=x[0].alive),ge[0]&1&&(vn["aria-pressed"]=x[0].alive),ge[1]&4096&&(vn.$$scope={dirty:ge,ctx:x}),B.$set(vn),x[0].alive?Ue&&(ne(),N(Ue,1,1,()=>{Ue=null}),oe()):Ue?(Ue.p(x,ge),ge[0]&1&&y(Ue,1)):(Ue=$i(x),Ue.c(),y(Ue,1),Ue.m(z,null)),ge[0]&11){Ht=X(x[3].script.roles);let be;for(be=0;be<Ht.length;be+=1){const Rt=gi(x,Ht,be);Fe[be]?Fe[be].p(Rt,ge):(Fe[be]=Ii(Rt),Fe[be].c(),Fe[be].m(he,null))}for(;be<Fe.length;be+=1)Fe[be].d(1);Fe.length=Ht.length}if((!ft||ge[0]&9&&Ie!==(Ie=x[0].roleId))&&dt(he,x[0].roleId),(!ft||ge[0]&9&&ue!==(ue=x[0].alignment))&&dt(Be,x[0].alignment),ge[0]&18){Gt=X(x[4]);let be;for(be=0;be<Gt.length;be+=1){const Rt=pi(x,Gt,be);je[be]?je[be].p(Rt,ge):(je[be]=Oi(Rt),je[be].c(),je[be].m(Se,null))}for(;be<je.length;be+=1)je[be].d(1);je.length=Gt.length}if(ge[0]&18){Ft=X(x[4]);let be;for(be=0;be<Ft.length;be+=1){const Rt=mi(x,Ft,be);ze[be]?ze[be].p(Rt,ge):(ze[be]=Ri(Rt),ze[be].c(),ze[be].m(Ye,null))}for(;be<ze.length;be+=1)ze[be].d(1);ze.length=Ft.length}const No={};ge[0]&1&&(No.player=x[0]),At.$set(No);const Io={};ge[1]&4096&&(Io.$$scope={dirty:ge,ctx:x}),wt.$set(Io);const Oo={};ge[1]&4096&&(Oo.$$scope={dirty:ge,ctx:x}),yt.$set(Oo);const Ro={};ge[0]&3|ge[1]&4096&&(Ro.$$scope={dirty:ge,ctx:x}),$t.$set(Ro);const To={};ge[0]&3|ge[1]&4096&&(To.$$scope={dirty:ge,ctx:x}),vt.$set(To);const Eo={};ge[1]&4096&&(Eo.$$scope={dirty:ge,ctx:x}),Nt.$set(Eo);const Do={};ge[1]&4096&&(Do.$$scope={dirty:ge,ctx:x}),It.$set(Do);const Ao={};ge[0]&1|ge[1]&4096&&(Ao.$$scope={dirty:ge,ctx:x}),Ot.$set(Ao)},i(x){ft||(y(l.$$.fragment,x),y(Le),y(B.$$.fragment,x),y(Ue),y(At.$$.fragment,x),y(wt.$$.fragment,x),y(yt.$$.fragment,x),y($t.$$.fragment,x),y(vt.$$.fragment,x),y(Nt.$$.fragment,x),y(It.$$.fragment,x),y(Ot.$$.fragment,x),ft=!0)},o(x){N(l.$$.fragment,x),N(Le),N(B.$$.fragment,x),N(Ue),N(At.$$.fragment,x),N(wt.$$.fragment,x),N(yt.$$.fragment,x),N($t.$$.fragment,x),N(vt.$$.fragment,x),N(Nt.$$.fragment,x),N(It.$$.fragment,x),N(Ot.$$.fragment,x),ft=!1},d(x){x&&g(e),F(l),qe&&qe.d(),Le&&Le.d(),F(B),Ue&&Ue.d(),me(Fe,x),me(je,x),me(ze,x),F(At),F(wt),F(yt),F($t),F(vt),F(Nt),F(It),F(Ot),jn=!1,$e(yo)}}}function wu(o){let e,t=o[1][o[0].roleId].name+"",n;return{c(){e=C("You are "),n=C(t)},m(i,r){_(i,e,r),_(i,n,r)},p(i,r){r[0]&3&&t!==(t=i[1][i[0].roleId].name+"")&&J(n,t)},d(i){i&&(g(e),g(n))}}}function yu(o){let e,t=o[1][o[0].roleId].name+"",n;return{c(){e=C("This is "),n=C(t)},m(i,r){_(i,e,r),_(i,n,r)},p(i,r){r[0]&3&&t!==(t=i[1][i[0].roleId].name+"")&&J(n,t)},d(i){i&&(g(e),g(n))}}}function $u(o){let e,t,n,i,r;return t=new Z({props:{$$slots:{default:[wu]},$$scope:{ctx:o}}}),t.$on("click",o[15]),i=new Z({props:{$$slots:{default:[yu]},$$scope:{ctx:o}}}),i.$on("click",o[16]),{c(){e=$("div"),j(t.$$.fragment),n=D(),j(i.$$.fragment),p(e,"class","footer-role-buttons")},m(l,a){_(l,e,a),G(t,e,null),b(e,n),G(i,e,null),r=!0},p(l,a){const s={};a[0]&3|a[1]&4096&&(s.$$scope={dirty:a,ctx:l}),t.$set(s);const c={};a[0]&3|a[1]&4096&&(c.$$scope={dirty:a,ctx:l}),i.$set(c)},i(l){r||(y(t.$$.fragment,l),y(i.$$.fragment,l),r=!0)},o(l){N(t.$$.fragment,l),N(i.$$.fragment,l),r=!1},d(l){l&&g(e),F(t),F(i)}}}function vu(o){let e;return{c(){e=C("Close")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Nu(o){let e,t;return e=new Z({props:{type:"cancel",$$slots:{default:[vu]},$$scope:{ctx:o}}}),e.$on("click",o[13]),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i[1]&4096&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Iu(o){let e,t,n=o[0]&&bi(o);return{c(){n&&n.c(),e=de()},m(i,r){n&&n.m(i,r),_(i,e,r),t=!0},p(i,r){i[0]?n?(n.p(i,r),r[0]&1&&y(n,1)):(n=bi(i),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(ne(),N(n,1,1,()=>{n=null}),oe())},i(i){t||(y(n),t=!0)},o(i){N(n),t=!1},d(i){i&&g(e),n&&n.d(i)}}}function Ou(o,e,t){let n,i,r,l,a,s,c;se(o,Re,L=>t(19,r=L)),se(o,kn,L=>t(20,a=L)),se(o,ae,L=>t(3,s=L));const f=Me(q,L=>{var S;return((S=L.editingPlayer)==null?void 0:S.id)??null}),u=Me([f,ae],([L,S])=>S.playerTokens.find(P=>P.id===L));se(o,u,L=>t(0,l=L));const d=Me([u,ae],([L,S])=>L?S.playerTokens.filter(P=>P.id!==L.id):[]);se(o,d,L=>t(4,c=L));function h(L){const S=re(f);S!=null&&Wn(S,{playerName:L.currentTarget.value})}function m(L){const S=re(f);S!=null&&Wn(S,{alignment:L.currentTarget.value})}function k(L){const S=re(f);S!=null&&(ru(S,L.currentTarget.value),Xo(S))}function w(L){const S=re(f),P=parseInt(L.currentTarget.value,10);S!=null&&P&&Ea(S,P)}function O(L){const S=re(f),P=parseInt(L.currentTarget.value,10);S!=null&&P&&lu(S,P)}Me([f,q],([L,S])=>L!=null?!!S.misregisterIndicators[L]:!1);function I(){q.update(L=>({...L,showEditModal:!1,editingPlayer:null}))}function T(){const L=re(f);L!=null&&(ou(L),I())}function E(){const L=re(u);if(!L)return;const S=_t("you_are",it);if(!S)return;const K=re(Re)[L.roleId];K&&q.update(V=>({...V,currentCard:{...S,roles:[K]},showCardModal:!0,focusMode:!0}))}function R(){const L=re(u);if(!L)return;const S=_t("player_is",it);if(!S)return;const K=re(Re)[L.roleId];K&&q.update(V=>({...V,currentCard:{...S,roles:[K]},showCardModal:!0,focusMode:!0}))}function H(){const L=_t("you_are",it);L&&Bo(L)}function A(){const L=_t("player_is",it);L&&Bo(L)}const M=(L,S)=>S.roleId===L&&S.id!==l.id,U=()=>{const L=re(u);L&&q.update(S=>({...S,showScriptAlmanacModal:!0,playerExplanationId:L.roleId}))},v=()=>{const L=re(f);L&&(l.alive?su(L):au(L))},Y=()=>{const L=re(f);L!=null&&Wn(L,{ghostVote:!l.ghostVote})},W=(L,S)=>S.roleId===L&&S.id!==l.id,z=()=>{const L=re(f);L!=null&&Xo(L)},B=()=>qc(l.id);return o.$$.update=()=>{o.$$.dirty[0]&1048577&&t(2,n=l?a.find(L=>L.roleId===l.roleId):void 0),o.$$.dirty[0]&524288&&t(1,i=r)},[l,i,n,s,c,f,u,d,h,m,k,w,O,I,T,E,R,H,A,r,a,M,U,v,Y,W,z,B]}class Ru extends ye{constructor(e){super(),we(this,e,Ou,Iu,ke,{},null,[-1,-1])}}function Ti(o,e,t){const n=o.slice();return n[7]=e[t],n}function Tu(o){let e=o[7].text+"",t,n;return{c(){t=C(e),n=D()},m(i,r){_(i,t,r),_(i,n,r)},p(i,r){r&1&&e!==(e=i[7].text+"")&&J(t,e)},d(i){i&&(g(t),g(n))}}}function Ei(o,e){let t,n,i;function r(){return e[5](e[7])}return n=new Z({props:{$$slots:{default:[Tu]},$$scope:{ctx:e}}}),n.$on("click",r),{key:o,first:null,c(){t=de(),j(n.$$.fragment),this.first=t},m(l,a){_(l,t,a),G(n,l,a),i=!0},p(l,a){e=l;const s={};a&1025&&(s.$$scope={dirty:a,ctx:e}),n.$set(s)},i(l){i||(y(n.$$.fragment,l),i=!0)},o(l){N(n.$$.fragment,l),i=!1},d(l){l&&g(t),F(n,l)}}}function Eu(o){let e,t=[],n=new Map,i,r=X(o[0]);const l=a=>a[7].id;for(let a=0;a<r.length;a+=1){let s=Ti(o,r,a),c=l(s);n.set(c,t[a]=Ei(c,s))}return{c(){e=$("div");for(let a=0;a<t.length;a+=1)t[a].c();p(e,"class","card-grid svelte-3nlf8h")},m(a,s){_(a,e,s);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);i=!0},p(a,s){s&5&&(r=X(a[0]),ne(),t=He(t,s,l,1,a,r,n,e,Ve,Ei,null,Ti),oe())},i(a){if(!i){for(let s=0;s<r.length;s+=1)y(t[s]);i=!0}},o(a){for(let s=0;s<t.length;s+=1)N(t[s]);i=!1},d(a){a&&g(e);for(let s=0;s<t.length;s+=1)t[s].d()}}}function Du(o){let e;return{c(){e=C("Close")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Au(o){let e,t;return e=new Z({props:{$$slots:{default:[Du]},$$scope:{ctx:o}}}),e.$on("click",o[4]),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&1024&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Su(o){let e,t;return e=new De({props:{show:o[1].showCardSelectionModal,onClose:o[6],title:"Select a Card",$$slots:{footer:[Au],default:[Eu]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,[i]){const r={};i&2&&(r.show=n[1].showCardSelectionModal),i&1025&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Cu(o,e,t){let n,i,r;se(o,io,f=>t(3,i=f)),se(o,q,f=>t(1,r=f));function l(f){q.update(u=>({...u,currentCard:f,showCardModal:!0,showCardSelectionModal:!1,focusMode:!1}))}const a=()=>q.update(f=>({...f,showCardSelectionModal:!1})),s=f=>l(f),c=()=>q.update(f=>({...f,showCardSelectionModal:!1}));return o.$$.update=()=>{o.$$.dirty&8&&t(0,n=i)},[n,r,l,i,a,s,c]}class Da extends ye{constructor(e){super(),we(this,e,Cu,Su,ke,{})}}function Di(o,e,t){const n=o.slice();return n[15]=e[t],n}function Ai(o){let e,t;return e=new De({props:{show:!0,fullscreen:!0,showFooterInFullscreen:!0,backdropClosable:!1,title:o[3]?"":"Card",focusmodeAllowed:!0,onClose:o[6],$$slots:{footer:[ju],default:[Uu]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&8&&(r.title=n[3]?"":"Card"),i&262175&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Mu(o){let e,t=o[0].text.replace("*","")+"",n;return{c(){e=$("h1"),n=C(t),p(e,"id","card-title"),p(e,"class","text-display svelte-ojne6f")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r&1&&t!==(t=i[0].text.replace("*","")+"")&&J(n,t)},d(i){i&&g(e)}}}function Lu(o){let e,t,n=o[0].text+"",i,r,l;return{c(){e=$("h1"),t=$("div"),i=C(n),p(t,"contenteditable","true"),p(t,"class","editable-text svelte-ojne6f"),p(t,"role","textbox"),p(t,"aria-label","Card title editor"),p(t,"aria-multiline","false"),p(e,"id","card-title"),p(e,"class","text-editor svelte-ojne6f")},m(a,s){_(a,e,s),b(e,t),b(t,i),r||(l=ee(t,"input",o[5]),r=!0)},p(a,s){s&1&&n!==(n=a[0].text+"")&&la(i,n)},d(a){a&&g(e),r=!1,l()}}}function Si(o){let e,t=[],n=new Map,i,r=X(o[0].roles);const l=a=>a[15].id;for(let a=0;a<r.length;a+=1){let s=Di(o,r,a),c=l(s);n.set(c,t[a]=Ci(c,s))}return{c(){e=$("div");for(let a=0;a<t.length;a+=1)t[a].c();p(e,"class","roles-container svelte-ojne6f")},m(a,s){_(a,e,s);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);i=!0},p(a,s){s&513&&(r=X(a[0].roles),ne(),t=He(t,s,l,1,a,r,n,e,Ve,Ci,null,Di),oe())},i(a){if(!i){for(let s=0;s<r.length;s+=1)y(t[s]);i=!0}},o(a){for(let s=0;s<t.length;s+=1)N(t[s]);i=!1},d(a){a&&g(e);for(let s=0;s<t.length;s+=1)t[s].d()}}}function Ci(o,e){let t,n,i,r,l,a,s,c;n=new Ut({props:{role:e[15],size:"big"}});function f(){return e[13](e[15])}return{key:o,first:null,c(){t=$("button"),j(n.$$.fragment),i=D(),p(t,"type","button"),p(t,"class","role-item svelte-ojne6f"),p(t,"aria-label",r=`Remove role ${e[15].name}`),p(t,"title",l=`Double-click to remove ${e[15].name}`),this.first=t},m(u,d){_(u,t,d),G(n,t,null),b(t,i),a=!0,s||(c=ee(t,"dblclick",f),s=!0)},p(u,d){e=u;const h={};d&1&&(h.role=e[15]),n.$set(h),(!a||d&1&&r!==(r=`Remove role ${e[15].name}`))&&p(t,"aria-label",r),(!a||d&1&&l!==(l=`Double-click to remove ${e[15].name}`))&&p(t,"title",l)},i(u){a||(y(n.$$.fragment,u),a=!0)},o(u){N(n.$$.fragment,u),a=!1},d(u){u&&g(t),F(n),s=!1,c()}}}function Mi(o){let e,t;return e=new Da({}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Uu(o){var h;let e,t,n,i,r,l,a;function s(m,k){return m[4]&&!m[3]?Lu:Mu}let c=s(o),f=c(o),u=((h=o[0].roles)==null?void 0:h.length)&&Si(o),d=o[2].showCardSelectionModal&&Mi();return{c(){e=$("div"),t=$("div"),n=$("div"),f.c(),i=D(),u&&u.c(),r=D(),d&&d.c(),l=de(),p(n,"class","card-content svelte-ojne6f"),p(t,"class","card-wrapper svelte-ojne6f"),p(e,"class","modal-section svelte-ojne6f")},m(m,k){_(m,e,k),b(e,t),b(t,n),f.m(n,null),b(n,i),u&&u.m(n,null),_(m,r,k),d&&d.m(m,k),_(m,l,k),a=!0},p(m,k){var w;c===(c=s(m))&&f?f.p(m,k):(f.d(1),f=c(m),f&&(f.c(),f.m(n,i))),(w=m[0].roles)!=null&&w.length?u?(u.p(m,k),k&1&&y(u,1)):(u=Si(m),u.c(),y(u,1),u.m(n,null)):u&&(ne(),N(u,1,1,()=>{u=null}),oe()),m[2].showCardSelectionModal?d?k&4&&y(d,1):(d=Mi(),d.c(),y(d,1),d.m(l.parentNode,l)):d&&(ne(),N(d,1,1,()=>{d=null}),oe())},i(m){a||(y(u),y(d),a=!0)},o(m){N(u),N(d),a=!1},d(m){m&&(g(e),g(r),g(l)),f.d(),u&&u.d(),d&&d.d(m)}}}function Pu(o){let e;return{c(){e=C("Insert Bluffs")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Li(o){let e,t,n,i;e=new Z({props:{$$slots:{default:[Bu]},$$scope:{ctx:o}}}),e.$on("click",o[7]);let r=o[1]&&Ui(o);return{c(){j(e.$$.fragment),t=D(),r&&r.c(),n=de()},m(l,a){G(e,l,a),_(l,t,a),r&&r.m(l,a),_(l,n,a),i=!0},p(l,a){const s={};a&262144&&(s.$$scope={dirty:a,ctx:l}),e.$set(s),l[1]?r?(r.p(l,a),a&2&&y(r,1)):(r=Ui(l),r.c(),y(r,1),r.m(n.parentNode,n)):r&&(ne(),N(r,1,1,()=>{r=null}),oe())},i(l){i||(y(e.$$.fragment,l),y(r),i=!0)},o(l){N(e.$$.fragment,l),N(r),i=!1},d(l){l&&(g(t),g(n)),F(e,l),r&&r.d(l)}}}function Bu(o){let e;return{c(){e=C("Save")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Ui(o){let e,t;return e=new Z({props:{type:"danger",$$slots:{default:[Yu]},$$scope:{ctx:o}}}),e.$on("click",o[8]),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&262144&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Yu(o){let e;return{c(){e=C("Delete")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Hu(o){let e;return{c(){e=C("Swap Card")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Pi(o){let e,t;return e=new Z({props:{$$slots:{default:[Gu]},$$scope:{ctx:o}}}),e.$on("click",o[10]),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&262145&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Gu(o){var n;let e=(n=o[0].roles)!=null&&n.length?"Edit Roles":"Add Role",t;return{c(){t=C(e)},m(i,r){_(i,t,r)},p(i,r){var l;r&1&&e!==(e=(l=i[0].roles)!=null&&l.length?"Edit Roles":"Add Role")&&J(t,e)},d(i){i&&g(t)}}}function Fu(o){let e;return{c(){e=C("Close")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function ju(o){let e,t,n,i,r,l,a,s,c;t=new Z({props:{$$slots:{default:[Pu]},$$scope:{ctx:o}}}),t.$on("click",o[12]);let f=o[4]&&Li(o);r=new Z({props:{$$slots:{default:[Hu]},$$scope:{ctx:o}}}),r.$on("click",o[11]);let u=o[0].requiresRole&&Pi(o);return s=new Z({props:{$$slots:{default:[Fu]},$$scope:{ctx:o}}}),s.$on("click",o[6]),{c(){e=$("div"),j(t.$$.fragment),n=D(),f&&f.c(),i=D(),j(r.$$.fragment),l=D(),u&&u.c(),a=D(),j(s.$$.fragment),p(e,"class","base-modal-footer svelte-ojne6f")},m(d,h){_(d,e,h),G(t,e,null),b(e,n),f&&f.m(e,null),b(e,i),G(r,e,null),b(e,l),u&&u.m(e,null),b(e,a),G(s,e,null),c=!0},p(d,h){const m={};h&262144&&(m.$$scope={dirty:h,ctx:d}),t.$set(m),d[4]?f?(f.p(d,h),h&16&&y(f,1)):(f=Li(d),f.c(),y(f,1),f.m(e,i)):f&&(ne(),N(f,1,1,()=>{f=null}),oe());const k={};h&262144&&(k.$$scope={dirty:h,ctx:d}),r.$set(k),d[0].requiresRole?u?(u.p(d,h),h&1&&y(u,1)):(u=Pi(d),u.c(),y(u,1),u.m(e,a)):u&&(ne(),N(u,1,1,()=>{u=null}),oe());const w={};h&262144&&(w.$$scope={dirty:h,ctx:d}),s.$set(w)},i(d){c||(y(t.$$.fragment,d),y(f),y(r.$$.fragment,d),y(u),y(s.$$.fragment,d),c=!0)},o(d){N(t.$$.fragment,d),N(f),N(r.$$.fragment,d),N(u),N(s.$$.fragment,d),c=!1},d(d){d&&g(e),F(t),f&&f.d(),F(r),u&&u.d(),F(s)}}}function zu(o){let e,t,n=o[2].showCardModal&&Ai(o);return{c(){n&&n.c(),e=de()},m(i,r){n&&n.m(i,r),_(i,e,r),t=!0},p(i,[r]){i[2].showCardModal?n?(n.p(i,r),r&4&&y(n,1)):(n=Ai(i),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(ne(),N(n,1,1,()=>{n=null}),oe())},i(i){t||(y(n),t=!0)},o(i){N(n),t=!1},d(i){i&&g(e),n&&n.d(i)}}}function Ku(o,e,t){let n,i,r,l,a;se(o,q,I=>t(2,a=I));function s(I){const E=I.currentTarget.textContent??"";q.update(R=>R.currentCard?{...R,currentCard:{...R.currentCard,text:E}}:R)}function c(){q.update(I=>({...I,focusMode:!1}))}function f(){q.update(I=>({...I,showCardModal:!1,focusMode:!1,currentCard:null}))}function u(){const{id:I,text:T,requiresRole:E,roles:R=[]}=re(q).currentCard;gc({id:I,text:T,requiresRole:E,roles:R})}function d(){_c(n.id),f()}function h(I){q.update(T=>{const E=T.currentCard;return E!=null&&E.roles?{...T,currentCard:{...E,roles:E.roles.filter(R=>R.id!==I)}}:T})}function m(){q.update(I=>({...I,showRoleSelectionModal:!0,roleSelectionContext:"card"}))}function k(){q.update(I=>({...I,showCardSelectionModal:!0,cardSelectionContext:"card-swap"}))}mt(()=>{q.update(T=>({...T,focusMode:!0}));const I=T=>{T.key==="Escape"&&c()};return window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I)});const w=()=>q.update(I=>({...I,showBluffsModal:!0})),O=I=>h(I.id);return o.$$.update=()=>{var I;if(o.$$.dirty&4&&t(0,n=a.currentCard),o.$$.dirty&1&&t(1,i=n.id.startsWith("custom-")),o.$$.dirty&3&&t(4,r=i||n.id==="roles_not_in_play"||n.id==="custom"),o.$$.dirty&4&&t(3,l=a.focusMode),o.$$.dirty&4&&(I=a.pendingInsertRoles)!=null&&I.length&&a.currentCard){const T=re(Re),E=a.pendingInsertRoles.map(R=>T[R]).filter(Boolean);q.update(R=>({...R,currentCard:{...R.currentCard,roles:E},pendingInsertRoles:[]}))}},[n,i,a,l,r,s,f,u,d,h,m,k,w,O]}class Wu extends ye{constructor(e){super(),we(this,e,Ku,zu,ke,{})}}function Bi(o,e,t){const n=o.slice();return n[10]=e[t],n[12]=t,n}function Yi(o,e,t){const n=o.slice();return n[13]=e[t],n}function Hi(o,e,t){const n=o.slice();return n[16]=e[t],n}function qu(o){var I;let e,t,n,i,r,l,a,s,c,f,u,d=X(Object.keys(o[2])),h=[];for(let T=0;T<d.length;T+=1)h[T]=Gi(Hi(o,d,T));let m=((I=o[2][o[5]])==null?void 0:I.description)&&Fi(o);const k=[Zu,Ju],w=[];function O(T,E){var R;return(R=T[2][T[5]])!=null&&R.scripts.length?1:0}return a=O(o),s=w[a]=k[a](o),{c(){e=$("div"),t=$("label"),t.textContent="Choose a collection:",n=D(),i=$("select");for(let T=0;T<h.length;T+=1)h[T].c();r=D(),m&&m.c(),l=D(),s.c(),p(t,"for","collection-select"),p(t,"class","svelte-19onli4"),p(i,"id","collection-select"),p(i,"class","svelte-19onli4"),o[5]===void 0&&Zt(()=>o[7].call(i)),p(e,"class","content svelte-19onli4")},m(T,E){_(T,e,E),b(e,t),b(e,n),b(e,i);for(let R=0;R<h.length;R+=1)h[R]&&h[R].m(i,null);dt(i,o[5],!0),b(e,r),m&&m.m(e,null),b(e,l),w[a].m(e,null),c=!0,f||(u=ee(i,"change",o[7]),f=!0)},p(T,E){var H;if(E&4){d=X(Object.keys(T[2]));let A;for(A=0;A<d.length;A+=1){const M=Hi(T,d,A);h[A]?h[A].p(M,E):(h[A]=Gi(M),h[A].c(),h[A].m(i,null))}for(;A<h.length;A+=1)h[A].d(1);h.length=d.length}E&36&&dt(i,T[5]),(H=T[2][T[5]])!=null&&H.description?m?m.p(T,E):(m=Fi(T),m.c(),m.m(e,l)):m&&(m.d(1),m=null);let R=a;a=O(T),a===R?w[a].p(T,E):(ne(),N(w[R],1,1,()=>{w[R]=null}),oe(),s=w[a],s?s.p(T,E):(s=w[a]=k[a](T),s.c()),y(s,1),s.m(e,null))},i(T){c||(y(s),c=!0)},o(T){N(s),c=!1},d(T){T&&g(e),me(h,T),m&&m.d(),w[a].d(),f=!1,u()}}}function Vu(o){let e,t;return{c(){e=$("p"),t=C(o[4]),p(e,"class","empty error svelte-19onli4")},m(n,i){_(n,e,i),b(e,t)},p(n,i){i&16&&J(t,n[4])},i:te,o:te,d(n){n&&g(e)}}}function Xu(o){let e;return{c(){e=$("p"),e.textContent="Loading custom scripts…",p(e,"class","empty svelte-19onli4")},m(t,n){_(t,e,n)},p:te,i:te,o:te,d(t){t&&g(e)}}}function Gi(o){let e,t=o[16]+"",n,i;return{c(){e=$("option"),n=C(t),e.__value=i=o[16],Ne(e,e.__value)},m(r,l){_(r,e,l),b(e,n)},p(r,l){l&4&&t!==(t=r[16]+"")&&J(n,t),l&4&&i!==(i=r[16])&&(e.__value=i,Ne(e,e.__value))},d(r){r&&g(e)}}}function Fi(o){let e,t=o[2][o[5]].description+"",n;return{c(){e=$("p"),n=C(t),p(e,"class","collection-desc svelte-19onli4")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r&36&&t!==(t=i[2][i[5]].description+"")&&J(n,t)},d(i){i&&g(e)}}}function Ju(o){let e,t,n=X(o[2][o[5]].scripts),i=[];for(let l=0;l<n.length;l+=1)i[l]=qi(Bi(o,n,l));const r=l=>N(i[l],1,1,()=>{i[l]=null});return{c(){e=$("div");for(let l=0;l<i.length;l+=1)i[l].c();p(e,"class","carousel-container svelte-19onli4")},m(l,a){_(l,e,a);for(let s=0;s<i.length;s+=1)i[s]&&i[s].m(e,null);t=!0},p(l,a){if(a&100){n=X(l[2][l[5]].scripts);let s;for(s=0;s<n.length;s+=1){const c=Bi(l,n,s);i[s]?(i[s].p(c,a),y(i[s],1)):(i[s]=qi(c),i[s].c(),y(i[s],1),i[s].m(e,null))}for(ne(),s=n.length;s<i.length;s+=1)r(s);oe()}},i(l){if(!t){for(let a=0;a<n.length;a+=1)y(i[a]);t=!0}},o(l){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)N(i[a]);t=!1},d(l){l&&g(e),me(i,l)}}}function Zu(o){let e;return{c(){e=$("p"),e.textContent="No scripts in this collection.",p(e,"class","empty svelte-19onli4")},m(t,n){_(t,e,n)},p:te,i:te,o:te,d(t){t&&g(e)}}}function Qu(o){let e;return{c(){e=$("h3"),e.textContent=`Script #${o[12]+1}`,p(e,"class","svelte-19onli4")},m(t,n){_(t,e,n)},p:te,d(t){t&&g(e)}}}function xu(o){let e,t=o[10].roles[0].name+"",n;return{c(){e=$("h3"),n=C(t),p(e,"class","svelte-19onli4")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r&36&&t!==(t=i[10].roles[0].name+"")&&J(n,t)},d(i){i&&g(e)}}}function ji(o){let e,t,n=o[10].roles[0].author+"",i;return{c(){e=$("small"),t=C("by "),i=C(n),p(e,"class","svelte-19onli4")},m(r,l){_(r,e,l),b(e,t),b(e,i)},p(r,l){l&36&&n!==(n=r[10].roles[0].author+"")&&J(i,n)},d(r){r&&g(e)}}}function zi(o){let e,t=(typeof o[13]=="string"?o[13]:o[13].id)+"",n;return{c(){e=$("li"),n=C(t),p(e,"class","svelte-19onli4")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r&36&&t!==(t=(typeof i[13]=="string"?i[13]:i[13].id)+"")&&J(n,t)},d(i){i&&g(e)}}}function Ki(o){let e,t,n=o[10].roles.length-6+"",i,r;return{c(){e=$("li"),t=C("…and "),i=C(n),r=C(" more"),p(e,"class","svelte-19onli4")},m(l,a){_(l,e,a),b(e,t),b(e,i),b(e,r)},p(l,a){a&36&&n!==(n=l[10].roles.length-6+"")&&J(i,n)},d(l){l&&g(e)}}}function Wi(o){let e,t=o[10].description.replace(/\n/g,"<br>")+"";return{c(){e=$("div"),p(e,"class","slide-description svelte-19onli4")},m(n,i){_(n,e,i),e.innerHTML=t},p(n,i){i&36&&t!==(t=n[10].description.replace(/\n/g,"<br>")+"")&&(e.innerHTML=t)},d(n){n&&g(e)}}}function ed(o){let e;return{c(){e=C("Load")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function qi(o){let e,t,n,i,r,l,a,s,c=o[10].roles.length-1+"",f,u,d,h,m,k,w,O,I,T;function E(z,B){return z[10].roles[0]&&typeof z[10].roles[0]!="string"&&z[10].roles[0].name?xu:Qu}let R=E(o),H=R(o),A=o[10].roles[0]&&typeof o[10].roles[0]!="string"&&o[10].roles[0].author&&ji(o),M=X(o[10].roles.slice(1,6)),U=[];for(let z=0;z<M.length;z+=1)U[z]=zi(Yi(o,M,z));let v=o[10].roles.length-1>5&&Ki(o),Y=o[10].description&&Wi(o);function W(){return o[8](o[10])}return O=new Z({props:{$$slots:{default:[ed]},$$scope:{ctx:o}}}),O.$on("click",W),{c(){e=$("div"),t=$("div"),H.c(),n=D(),A&&A.c(),i=D(),r=$("div"),l=$("p"),a=$("strong"),a.textContent="# Roles:",s=D(),f=C(c),u=D(),d=$("ul");for(let z=0;z<U.length;z+=1)U[z].c();h=D(),v&&v.c(),m=D(),Y&&Y.c(),k=D(),w=$("div"),j(O.$$.fragment),I=D(),p(t,"class","slide-header svelte-19onli4"),p(d,"class","svelte-19onli4"),p(r,"class","slide-body svelte-19onli4"),p(w,"class","slide-footer svelte-19onli4"),p(e,"class","slide svelte-19onli4")},m(z,B){_(z,e,B),b(e,t),H.m(t,null),b(t,n),A&&A.m(t,null),b(e,i),b(e,r),b(r,l),b(l,a),b(l,s),b(l,f),b(r,u),b(r,d);for(let L=0;L<U.length;L+=1)U[L]&&U[L].m(d,null);b(d,h),v&&v.m(d,null),b(r,m),Y&&Y.m(r,null),b(e,k),b(e,w),G(O,w,null),b(e,I),T=!0},p(z,B){if(o=z,R===(R=E(o))&&H?H.p(o,B):(H.d(1),H=R(o),H&&(H.c(),H.m(t,n))),o[10].roles[0]&&typeof o[10].roles[0]!="string"&&o[10].roles[0].author?A?A.p(o,B):(A=ji(o),A.c(),A.m(t,null)):A&&(A.d(1),A=null),(!T||B&36)&&c!==(c=o[10].roles.length-1+"")&&J(f,c),B&36){M=X(o[10].roles.slice(1,6));let S;for(S=0;S<M.length;S+=1){const P=Yi(o,M,S);U[S]?U[S].p(P,B):(U[S]=zi(P),U[S].c(),U[S].m(d,h))}for(;S<U.length;S+=1)U[S].d(1);U.length=M.length}o[10].roles.length-1>5?v?v.p(o,B):(v=Ki(o),v.c(),v.m(d,null)):v&&(v.d(1),v=null),o[10].description?Y?Y.p(o,B):(Y=Wi(o),Y.c(),Y.m(r,null)):Y&&(Y.d(1),Y=null);const L={};B&524288&&(L.$$scope={dirty:B,ctx:o}),O.$set(L)},i(z){T||(y(O.$$.fragment,z),T=!0)},o(z){N(O.$$.fragment,z),T=!1},d(z){z&&g(e),H.d(),A&&A.d(),me(U,z),v&&v.d(),Y&&Y.d(),F(O)}}}function td(o){let e,t,n,i;const r=[Xu,Vu,qu],l=[];function a(s,c){return s[3]?0:s[4]?1:2}return e=a(o),t=l[e]=r[e](o),{c(){t.c(),n=de()},m(s,c){l[e].m(s,c),_(s,n,c),i=!0},p(s,c){let f=e;e=a(s),e===f?l[e].p(s,c):(ne(),N(l[f],1,1,()=>{l[f]=null}),oe(),t=l[e],t?t.p(s,c):(t=l[e]=r[e](s),t.c()),y(t,1),t.m(n.parentNode,n))},i(s){i||(y(t),i=!0)},o(s){N(t),i=!1},d(s){s&&g(n),l[e].d(s)}}}function nd(o){let e;return{c(){e=C("Close")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function od(o){let e,t;return e=new Z({props:{type:"cancel",$$slots:{default:[nd]},$$scope:{ctx:o}}}),e.$on("click",function(){ht(o[1])&&o[1].apply(this,arguments)}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){o=n;const r={};i&524288&&(r.$$scope={dirty:i,ctx:o}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function id(o){let e,t;return e=new De({props:{show:o[0],title:"Custom Scripts",onClose:o[1],$$slots:{footer:[od],default:[td]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,[i]){const r={};i&1&&(r.show=n[0]),i&2&&(r.onClose=n[1]),i&524350&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function rd(o,e,t){let{show:n}=e,{onClose:i}=e,r={},l=!0,a=null,s="";const c="hhttps://dx.fr.to/cors/"+encodeURIComponent("https://pastebin.com/raw/6vqxHDwp");mt(async()=>{try{const h=await fetch(c);if(!h.ok)throw new Error(h.statusText);const m=await h.text(),k=JSON.parse(m);t(2,r=k),t(5,s=Object.keys(r)[0]||"")}catch(h){console.error(h),t(4,a="Failed to load custom scripts.")}finally{t(3,l=!1)}});function f(h){const m=h.roles.map(O=>typeof O=="string"?O:O.id);let k="Imported Script";const w=h.roles[0];typeof w!="string"&&w.name&&(k=w.name),ae.update(O=>({...O,playerTokens:[],script:{meta:{name:k},roles:m,author:""}})),i()}function u(){s=to(this),t(5,s),t(2,r)}const d=h=>f(h);return o.$$set=h=>{"show"in h&&t(0,n=h.show),"onClose"in h&&t(1,i=h.onClose)},[n,i,r,l,a,s,f,u,d]}class ld extends ye{constructor(e){super(),we(this,e,rd,id,ke,{show:0,onClose:1})}}const{Boolean:sd}=eo;function Vi(o,e,t){const n=o.slice();return n[15]=e[t],n}function ad(o){let e=o[15].meta.name+"",t,n;return{c(){t=C(e),n=D()},m(i,r){_(i,t,r),_(i,n,r)},p:te,d(i){i&&(g(t),g(n))}}}function Xi(o){let e,t;function n(){return o[10](o[15])}return e=new Z({props:{$$slots:{default:[ad]},$$scope:{ctx:o}}}),e.$on("click",n),{c(){j(e.$$.fragment)},m(i,r){G(e,i,r),t=!0},p(i,r){o=i;const l={};r&262144&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(i){t||(y(e.$$.fragment,i),t=!0)},o(i){N(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function cd(o){let e;return{c(){e=C("Browse Collections")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function fd(o){let e;return{c(){e=C("Load from JSON…")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function ud(o){let e;return{c(){e=C("Load Pasted JSON")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function dd(o){let e,t,n,i,r,l,a,s,c,f,u,d,h,m,k,w,O,I,T,E,R,H,A,M,U,v,Y,W=X(o[5]),z=[];for(let L=0;L<W.length;L+=1)z[L]=Xi(Vi(o,W,L));const B=L=>N(z[L],1,1,()=>{z[L]=null});return f=new Z({props:{$$slots:{default:[cd]},$$scope:{ctx:o}}}),f.$on("click",o[11]),k=new Z({props:{$$slots:{default:[fd]},$$scope:{ctx:o}}}),k.$on("click",o[7]),M=new Z({props:{disabled:!o[4].trim(),$$slots:{default:[ud]},$$scope:{ctx:o}}}),M.$on("click",o[9]),{c(){e=$("div"),t=$("h3"),t.textContent="Built-in Scripts",n=D(),i=$("i"),i.textContent="Choosing one will clear the board but save current session.",r=D();for(let L=0;L<z.length;L+=1)z[L].c();l=D(),a=$("div"),s=$("h3"),s.textContent="Custom Scripts",c=D(),j(f.$$.fragment),u=D(),d=$("div"),h=$("h3"),h.textContent="Or Import from File",m=D(),j(k.$$.fragment),w=D(),O=$("input"),I=D(),T=$("div"),E=$("h3"),E.textContent="Or Paste JSON",R=D(),H=$("textarea"),A=D(),j(M.$$.fragment),p(t,"class","svelte-1ikgt2k"),ce(i,"color","red"),p(i,"class","warning-text svelte-1ikgt2k"),p(e,"class","script-list svelte-1ikgt2k"),p(s,"class","svelte-1ikgt2k"),p(a,"class","custom-scripts-section svelte-1ikgt2k"),p(h,"class","svelte-1ikgt2k"),p(O,"type","file"),p(O,"accept",".json"),ce(O,"display","none"),p(d,"class","import-section svelte-1ikgt2k"),p(E,"class","svelte-1ikgt2k"),p(H,"placeholder",'["role1","role2",…]'),p(H,"rows","4"),p(H,"class","paste-input svelte-1ikgt2k"),p(T,"class","paste-section svelte-1ikgt2k")},m(L,S){_(L,e,S),b(e,t),b(e,n),b(e,i),b(e,r);for(let P=0;P<z.length;P+=1)z[P]&&z[P].m(e,null);_(L,l,S),_(L,a,S),b(a,s),b(a,c),G(f,a,null),_(L,u,S),_(L,d,S),b(d,h),b(d,m),G(k,d,null),b(d,w),b(d,O),o[12](O),_(L,I,S),_(L,T,S),b(T,E),b(T,R),b(T,H),Ne(H,o[4]),b(T,A),G(M,T,null),U=!0,v||(Y=[ee(O,"change",o[8]),ee(H,"input",o[13])],v=!0)},p(L,S){if(S&96){W=X(L[5]);let le;for(le=0;le<W.length;le+=1){const he=Vi(L,W,le);z[le]?(z[le].p(he,S),y(z[le],1)):(z[le]=Xi(he),z[le].c(),y(z[le],1),z[le].m(e,null))}for(ne(),le=W.length;le<z.length;le+=1)B(le);oe()}const P={};S&262144&&(P.$$scope={dirty:S,ctx:L}),f.$set(P);const K={};S&262144&&(K.$$scope={dirty:S,ctx:L}),k.$set(K),S&16&&Ne(H,L[4]);const V={};S&16&&(V.disabled=!L[4].trim()),S&262144&&(V.$$scope={dirty:S,ctx:L}),M.$set(V)},i(L){if(!U){for(let S=0;S<W.length;S+=1)y(z[S]);y(f.$$.fragment,L),y(k.$$.fragment,L),y(M.$$.fragment,L),U=!0}},o(L){z=z.filter(sd);for(let S=0;S<z.length;S+=1)N(z[S]);N(f.$$.fragment,L),N(k.$$.fragment,L),N(M.$$.fragment,L),U=!1},d(L){L&&(g(e),g(l),g(a),g(u),g(d),g(I),g(T)),me(z,L),F(f),F(k),o[12](null),F(M),v=!1,$e(Y)}}}function hd(o){let e;return{c(){e=C("Close")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function md(o){let e,t;return e=new Z({props:{$$slots:{default:[hd]},$$scope:{ctx:o}}}),e.$on("click",function(){ht(o[1])&&o[1].apply(this,arguments)}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){o=n;const r={};i&262144&&(r.$$scope={dirty:i,ctx:o}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Ji(o){let e,t;return e=new ld({props:{show:o[2],onClose:o[14]}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&4&&(r.show=n[2]),i&4&&(r.onClose=n[14]),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function pd(o){let e,t,n,i;e=new De({props:{show:o[0],title:"Choose a Script",onClose:o[1],$$slots:{footer:[md],default:[dd]},$$scope:{ctx:o}}});let r=o[2]&&Ji(o);return{c(){j(e.$$.fragment),t=D(),r&&r.c(),n=de()},m(l,a){G(e,l,a),_(l,t,a),r&&r.m(l,a),_(l,n,a),i=!0},p(l,[a]){const s={};a&1&&(s.show=l[0]),a&2&&(s.onClose=l[1]),a&262174&&(s.$$scope={dirty:a,ctx:l}),e.$set(s),l[2]?r?(r.p(l,a),a&4&&y(r,1)):(r=Ji(l),r.c(),y(r,1),r.m(n.parentNode,n)):r&&(ne(),N(r,1,1,()=>{r=null}),oe())},i(l){i||(y(e.$$.fragment,l),y(r),i=!0)},o(l){N(e.$$.fragment,l),N(r),i=!1},d(l){l&&(g(t),g(n)),F(e,l),r&&r.d(l)}}}function gd(o,e,t){let{show:n}=e,{onClose:i}=e,r=!1;const l=Bn;function a(I){Ct(),on(!0),In({id:I.meta.id,name:I.meta.name,author:I.meta.author},I.roles),i()}let s;function c(){s.click()}function f(I){var R;const T=(R=I.target.files)==null?void 0:R[0];if(!T)return;const E=new FileReader;E.onload=()=>{var H;try{const A=JSON.parse(E.result);if((H=A.meta)!=null&&H.name&&Array.isArray(A.roles))Ct(),on(!0),In(A.meta,A.roles),i();else throw new Error("Bad format")}catch{alert("Invalid script JSON! Must be { meta:{name,…}, roles:[…] }")}},E.readAsText(T),I.target.value=""}let u="";function d(){var T;let I;try{I=JSON.parse(u)}catch{return alert("Invalid JSON")}if(Array.isArray(I)&&I.length>0){const[E,...R]=I,H=R.map(A=>{let M="";if(typeof A=="string")M=A;else if(A&&typeof A.id=="string")M=A.id;else return"";return M.replace(/[\s_-]/g,"").toLowerCase()}).filter(Boolean);Ct(),on(!0),In({id:E.id||"imported",name:E.name||"Imported Script",author:E.author||""},H.map(A=>({id:A}))),i()}else(T=I.meta)!=null&&T.name&&Array.isArray(I.roles)?(Ct(),on(!0),In(I.meta,I.roles),i()):alert("JSON must be either [meta, …roles] or { meta:{…}, roles:[…] }")}const h=I=>a(I),m=()=>t(2,r=!0);function k(I){et[I?"unshift":"push"](()=>{s=I,t(3,s)})}function w(){u=this.value,t(4,u)}const O=()=>t(2,r=!1);return o.$$set=I=>{"show"in I&&t(0,n=I.show),"onClose"in I&&t(1,i=I.onClose)},[n,i,r,s,u,l,a,c,f,d,h,m,k,w,O]}class _d extends ye{constructor(e){super(),we(this,e,gd,pd,ke,{show:0,onClose:1})}}function Zi(o,e,t){const n=o.slice();return n[17]=e[t][0],n[18]=e[t][1],n}function Qi(o,e,t){const n=o.slice();return n[21]=e[t],n[23]=t,n}function xi(o,e,t){const n=o.slice();return n[24]=e[t],n[25]=e,n[23]=t,n}function bd(o){let e;return{c(){e=C("–")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function kd(o){let e;return{c(){e=C("+")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function er(o){let e,t=o[23],n,i;const r=()=>o[13](e,t),l=()=>o[13](null,t);function a(){return o[14](o[24])}return{c(){e=$("th"),e.textContent=`${o[24]} `,p(e,"class","svelte-la2h00")},m(s,c){_(s,e,c),r(),n||(i=ee(e,"click",a),n=!0)},p(s,c){o=s,t!==o[23]&&(l(),t=o[23],r())},d(s){s&&g(e),l(),n=!1,i()}}}function tr(o){let e,t=o[21]+"",n,i,r;function l(){return o[15](o[23])}return{c(){e=$("td"),n=C(t),p(e,"class","svelte-la2h00")},m(a,s){_(a,e,s),b(e,n),i||(r=ee(e,"click",l),i=!0)},p(a,s){o=a,s&8&&t!==(t=o[21]+"")&&J(n,t)},d(a){a&&g(e),i=!1,r()}}}function nr(o){let e,t,n=o[17]+"",i,r,l,a,s=X(o[18]),c=[];for(let f=0;f<s.length;f+=1)c[f]=tr(Qi(o,s,f));return{c(){e=$("tr"),t=$("td"),i=C(n),r=D();for(let f=0;f<c.length;f+=1)c[f].c();l=D(),p(t,"class","role-name svelte-la2h00"),p(e,"class",a=Et(o[17].toLowerCase())+" svelte-la2h00")},m(f,u){_(f,e,u),b(e,t),b(t,i),b(e,r);for(let d=0;d<c.length;d+=1)c[d]&&c[d].m(e,null);b(e,l)},p(f,u){if(u&8&&n!==(n=f[17]+"")&&J(i,n),u&328){s=X(f[18]);let d;for(d=0;d<s.length;d+=1){const h=Qi(f,s,d);c[d]?c[d].p(h,u):(c[d]=tr(h),c[d].c(),c[d].m(e,l))}for(;d<c.length;d+=1)c[d].d(1);c.length=s.length}u&8&&a!==(a=Et(f[17].toLowerCase())+" svelte-la2h00")&&p(e,"class",a)},d(f){f&&g(e),me(c,f)}}}function wd(o){let e,t,n,i,r,l,a,s,c,f,u,d,h,m,k,w,O,I,T,E,R;i=new Z({props:{disabled:o[0]===5,$$slots:{default:[bd]},$$scope:{ctx:o}}}),i.$on("click",o[11]),c=new Z({props:{disabled:o[0]===15,$$slots:{default:[kd]},$$scope:{ctx:o}}}),c.$on("click",o[12]);let H=X(o[6]),A=[];for(let v=0;v<H.length;v+=1)A[v]=er(xi(o,H,v));let M=X(Object.entries(o[3])),U=[];for(let v=0;v<M.length;v+=1)U[v]=nr(Zi(o,M,v));return{c(){e=$("p"),e.textContent="Use this menu to see your role distribution given how many base (non-Traveller) players will be playing.",t=D(),n=$("div"),j(i.$$.fragment),r=D(),l=$("span"),a=C(o[0]),s=D(),j(c.$$.fragment),f=D(),u=$("div"),d=$("table"),h=$("thead"),m=$("tr"),k=$("th"),k.textContent="Players",w=D();for(let v=0;v<A.length;v+=1)A[v].c();O=D(),I=$("tbody");for(let v=0;v<U.length;v+=1)U[v].c();T=D(),E=$("div"),p(e,"class","instruction-note svelte-la2h00"),p(l,"class","count svelte-la2h00"),p(n,"class","picker svelte-la2h00"),p(k,"class","svelte-la2h00"),p(h,"class","svelte-la2h00"),p(I,"class","svelte-la2h00"),p(d,"class","svelte-la2h00"),p(E,"class","column-highlight svelte-la2h00"),ce(E,"left",o[4]+"px"),ce(E,"width",o[5]+"px"),p(u,"class","table-container svelte-la2h00")},m(v,Y){_(v,e,Y),_(v,t,Y),_(v,n,Y),G(i,n,null),b(n,r),b(n,l),b(l,a),b(n,s),G(c,n,null),_(v,f,Y),_(v,u,Y),b(u,d),b(d,h),b(h,m),b(m,k),b(m,w);for(let W=0;W<A.length;W+=1)A[W]&&A[W].m(m,null);b(d,O),b(d,I);for(let W=0;W<U.length;W+=1)U[W]&&U[W].m(I,null);b(u,T),b(u,E),R=!0},p(v,Y){const W={};Y&1&&(W.disabled=v[0]===5),Y&67108864&&(W.$$scope={dirty:Y,ctx:v}),i.$set(W),(!R||Y&1)&&J(a,v[0]);const z={};if(Y&1&&(z.disabled=v[0]===15),Y&67108864&&(z.$$scope={dirty:Y,ctx:v}),c.$set(z),Y&322){H=X(v[6]);let B;for(B=0;B<H.length;B+=1){const L=xi(v,H,B);A[B]?A[B].p(L,Y):(A[B]=er(L),A[B].c(),A[B].m(m,null))}for(;B<A.length;B+=1)A[B].d(1);A.length=H.length}if(Y&328){M=X(Object.entries(v[3]));let B;for(B=0;B<M.length;B+=1){const L=Zi(v,M,B);U[B]?U[B].p(L,Y):(U[B]=nr(L),U[B].c(),U[B].m(I,null))}for(;B<U.length;B+=1)U[B].d(1);U.length=M.length}(!R||Y&16)&&ce(E,"left",v[4]+"px"),(!R||Y&32)&&ce(E,"width",v[5]+"px")},i(v){R||(y(i.$$.fragment,v),y(c.$$.fragment,v),R=!0)},o(v){N(i.$$.fragment,v),N(c.$$.fragment,v),R=!1},d(v){v&&(g(e),g(t),g(n),g(f),g(u)),F(i),F(c),me(A,v),me(U,v)}}}function yd(o){let e;return{c(){e=C("Save")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function $d(o){let e;return{c(){e=C("Cancel")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function vd(o){let e,t,n,i;return e=new Z({props:{disabled:!o[6].includes(o[0]),$$slots:{default:[yd]},$$scope:{ctx:o}}}),e.$on("click",o[9]),n=new Z({props:{type:"cancel",$$slots:{default:[$d]},$$scope:{ctx:o}}}),n.$on("click",o[10]),{c(){j(e.$$.fragment),t=D(),j(n.$$.fragment)},m(r,l){G(e,r,l),_(r,t,l),G(n,r,l),i=!0},p(r,l){const a={};l&1&&(a.disabled=!r[6].includes(r[0])),l&67108864&&(a.$$scope={dirty:l,ctx:r}),e.$set(a);const s={};l&67108864&&(s.$$scope={dirty:l,ctx:r}),n.$set(s)},i(r){i||(y(e.$$.fragment,r),y(n.$$.fragment,r),i=!0)},o(r){N(e.$$.fragment,r),N(n.$$.fragment,r),i=!1},d(r){r&&g(t),F(e,r),F(n,r)}}}function Nd(o){let e,t;return e=new De({props:{show:o[2].showSetPlayerCountModal,title:"Set Player Count",onClose:o[10],$$slots:{footer:[vd],default:[wd]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,[i]){const r={};i&4&&(r.show=n[2].showSetPlayerCountModal),i&67108923&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Id(o,e,t){let n;se(o,q,E=>t(2,n=E));let i=0;const r=Array.from({length:11},(E,R)=>R+5),l=["Townsfolk","Outsiders","Minions","Demons"],a={};for(const E of l)a[E]=r.map(R=>hn(R)[E]);function s(E){t(0,i=Math.max(5,Math.min(15,i+E)))}function c(E){t(0,i=E)}function f(){ae.update(E=>({...E,basePlayersCount:i})),q.update(E=>({...E,showSetPlayerCountModal:!1}))}function u(){q.update(E=>({...E,showSetPlayerCountModal:!1}))}let d=[],h=0,m=0;const k=()=>s(-1),w=()=>s(1);function O(E,R){et[E?"unshift":"push"](()=>{d[R]=E,t(1,d)})}const I=E=>c(E),T=E=>c(r[E]);return o.$$.update=()=>{if(o.$$.dirty&4&&n.showSetPlayerCountModal&&t(0,i=re(ae).basePlayersCount),o.$$.dirty&3){const E=r.indexOf(i),R=d[E];R&&(t(4,h=R.offsetLeft+4),t(5,m=R.offsetWidth-4*2))}},[i,d,n,a,h,m,r,s,c,f,u,k,w,O,I,T]}class Od extends ye{constructor(e){super(),we(this,e,Id,Nd,ke,{})}}function Rd(o){const e=o-1;return e*e*e+1}function Td(o,{from:e,to:t},n={}){const i=getComputedStyle(o),r=i.transform==="none"?"":i.transform,[l,a]=i.transformOrigin.split(" ").map(parseFloat),s=e.left+e.width*l/t.width-(t.left+l),c=e.top+e.height*a/t.height-(t.top+a),{delay:f=0,duration:u=h=>Math.sqrt(h)*120,easing:d=Rd}=n;return{delay:f,duration:ht(u)?u(Math.sqrt(s*s+c*c)):u,easing:d,css:(h,m)=>{const k=m*s,w=m*c,O=h+m*e.width/t.width,I=h+m*e.height/t.height;return`transform: ${r} translate(${k}px, ${w}px) scale(${O}, ${I});`}}}function or(o,e,t){const n=o.slice();return n[20]=e[t],n[22]=t,n}function ir(o,e,t){const n=o.slice();return n[23]=e[t],n[22]=t,n}function rr(o){let e,t,n,i;function r(...l){return o[13](o[22],...l)}return{c(){e=Ee("path"),p(e,"d",t=o[23]),p(e,"class","slice svelte-2pewj7"),p(e,"role","img"),p(e,"aria-label",`Seat slice ${o[22]+1}`)},m(l,a){_(l,e,a),n||(i=ee(e,"dragenter",r),n=!0)},p(l,a){o=l,a&16&&t!==(t=o[23])&&p(e,"d",t)},d(l){l&&g(e),n=!1,i()}}}function Ed(o){let e=o[20].playerName+"",t;return{c(){t=C(e)},m(n,i){_(n,t,i)},p(n,i){i&4&&e!==(e=n[20].playerName+"")&&J(t,e)},d(n){n&&g(t)}}}function Dd(o){let e,t=o[6][o[20].roleId].name+"",n,i,r=o[20].playerName+"",l,a;return{c(){e=$("span"),n=C(t),i=C(" ("),l=C(r),a=C(")"),p(e,"class","role svelte-2pewj7")},m(s,c){_(s,e,c),b(e,n),b(e,i),b(e,l),b(e,a)},p(s,c){c&68&&t!==(t=s[6][s[20].roleId].name+"")&&J(n,t),c&4&&r!==(r=s[20].playerName+"")&&J(l,r)},d(s){s&&g(e)}}}function lr(o,e){let t,n,i,r,l,a=te,s,c;function f(m,k){return m[6][m[20].roleId]?Dd:Ed}let u=f(e),d=u(e);function h(...m){return e[14](e[22],...m)}return{key:o,first:null,c(){t=$("div"),n=$("div"),d.c(),i=D(),p(n,"class","label svelte-2pewj7"),p(t,"class","item svelte-2pewj7"),p(t,"role","button"),p(t,"aria-label",r=`Player ${e[20].playerName} at position ${e[22]+1}. Drag to rearrange.`),p(t,"tabindex","0"),p(t,"draggable","true"),ce(t,"transform","translate(-50%, -50%) translate("+e[5][e[22]].x+"px, "+e[5][e[22]].y+"px)"),Oe(t,"dragging",e[22]===e[3]),this.first=t},m(m,k){_(m,t,k),b(t,n),d.m(n,null),b(t,i),s||(c=[ee(t,"dragstart",h),ee(t,"dragend",e[9])],s=!0)},p(m,k){e=m,u===(u=f(e))&&d?d.p(e,k):(d.d(1),d=u(e),d&&(d.c(),d.m(n,null))),k&4&&r!==(r=`Player ${e[20].playerName} at position ${e[22]+1}. Drag to rearrange.`)&&p(t,"aria-label",r),k&36&&ce(t,"transform","translate(-50%, -50%) translate("+e[5][e[22]].x+"px, "+e[5][e[22]].y+"px)"),k&12&&Oe(t,"dragging",e[22]===e[3])},r(){l=t.getBoundingClientRect()},f(){tc(t),a()},a(){a(),a=ec(t,l,Td,{})},d(m){m&&g(t),d.d(),s=!1,$e(c)}}}function Ad(o){let e,t,n,i,r,l=[],a=new Map,s,c,f=X(o[4]),u=[];for(let m=0;m<f.length;m+=1)u[m]=rr(ir(o,f,m));let d=X(o[2]);const h=m=>m[20].id;for(let m=0;m<d.length;m+=1){let k=or(o,d,m),w=h(k);a.set(w,l[m]=lr(w,k))}return{c(){e=$("p"),e.textContent=`The token bag will display roles how they are arranged here or on the board, going from bottom then clockwise.
    Use this menu to shuffle the bag.`,t=D(),n=$("div"),i=Ee("svg");for(let m=0;m<u.length;m+=1)u[m].c();r=D();for(let m=0;m<l.length;m+=1)l[m].c();p(e,"class","info svelte-2pewj7"),p(i,"class","drop-overlay svelte-2pewj7"),p(i,"width",ln),p(i,"height",ln),p(i,"aria-label","Seat drop overlay"),p(i,"focusable","false"),p(n,"class","circle-container svelte-2pewj7"),p(n,"role","application"),p(n,"aria-label","Player seating area. Drag a player to a new seat.")},m(m,k){_(m,e,k),_(m,t,k),_(m,n,k),b(n,i);for(let w=0;w<u.length;w+=1)u[w]&&u[w].m(i,null);b(n,r);for(let w=0;w<l.length;w+=1)l[w]&&l[w].m(n,null);s||(c=[ee(n,"dragover",Lt(Bd)),ee(n,"drop",Lt(Yd))],s=!0)},p(m,k){if(k&272){f=X(m[4]);let w;for(w=0;w<f.length;w+=1){const O=ir(m,f,w);u[w]?u[w].p(O,k):(u[w]=rr(O),u[w].c(),u[w].m(i,null))}for(;w<u.length;w+=1)u[w].d(1);u.length=f.length}if(k&748){d=X(m[2]);for(let w=0;w<l.length;w+=1)l[w].r();l=He(l,k,h,1,m,d,a,n,lc,lr,null,or);for(let w=0;w<l.length;w+=1)l[w].a()}},d(m){m&&(g(e),g(t),g(n)),me(u,m);for(let k=0;k<l.length;k+=1)l[k].d();s=!1,$e(c)}}}function Sd(o){let e;return{c(){e=C("Rebuild Circle")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Cd(o){let e;return{c(){e=C("Shuffle")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Md(o){let e;return{c(){e=C("Save")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Ld(o){let e;return{c(){e=C("Cancel")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Ud(o){let e,t,n,i,r,l,a,s;return e=new Z({props:{$$slots:{default:[Sd]},$$scope:{ctx:o}}}),e.$on("click",so),n=new Z({props:{$$slots:{default:[Cd]},$$scope:{ctx:o}}}),n.$on("click",o[11]),r=new Z({props:{$$slots:{default:[Md]},$$scope:{ctx:o}}}),r.$on("click",o[10]),a=new Z({props:{type:"cancel",$$slots:{default:[Ld]},$$scope:{ctx:o}}}),a.$on("click",function(){ht(o[1])&&o[1].apply(this,arguments)}),{c(){j(e.$$.fragment),t=D(),j(n.$$.fragment),i=D(),j(r.$$.fragment),l=D(),j(a.$$.fragment)},m(c,f){G(e,c,f),_(c,t,f),G(n,c,f),_(c,i,f),G(r,c,f),_(c,l,f),G(a,c,f),s=!0},p(c,f){o=c;const u={};f&33554432&&(u.$$scope={dirty:f,ctx:o}),e.$set(u);const d={};f&33554432&&(d.$$scope={dirty:f,ctx:o}),n.$set(d);const h={};f&33554432&&(h.$$scope={dirty:f,ctx:o}),r.$set(h);const m={};f&33554432&&(m.$$scope={dirty:f,ctx:o}),a.$set(m)},i(c){s||(y(e.$$.fragment,c),y(n.$$.fragment,c),y(r.$$.fragment,c),y(a.$$.fragment,c),s=!0)},o(c){N(e.$$.fragment,c),N(n.$$.fragment,c),N(r.$$.fragment,c),N(a.$$.fragment,c),s=!1},d(c){c&&(g(t),g(i),g(l)),F(e,c),F(n,c),F(r,c),F(a,c)}}}function Pd(o){let e,t;return e=new De({props:{show:o[0],title:"Arrange Players",onClose:o[1],$$slots:{footer:[Ud],default:[Ad]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,[i]){const r={};i&1&&(r.show=n[0]),i&2&&(r.onClose=n[1]),i&33554558&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}const ln=400,sr=60;function Bd(o){o.preventDefault(),o.dataTransfer.dropEffect="move"}function Yd(o){o.preventDefault()}function Hd(o,e,t){let n,i,r,l;se(o,Re,A=>t(12,l=A));let{show:a}=e,{onClose:s}=e,c=[],f=null;const u=ae.subscribe(A=>{t(2,c=[...A.playerTokens])});at(u);const d=(ln-sr)/2,h=ln/2,m=ln/2,k=d+sr/2;function w(A,M){t(3,f=M),A.dataTransfer.effectAllowed="move"}function O(A,M){if(A.preventDefault(),A.dataTransfer.dropEffect="move",f===null||f===M)return;const U=[...c],[v]=U.splice(f,1);U.splice(M,0,v),t(2,c=U),t(3,f=M)}function I(){t(3,f=null)}function T(){ae.update(A=>({...A,playerTokens:[...c]})),so(),q.update(A=>({...A,showArrangePlayersModal:!1}))}function E(){const A=[...c];for(let M=A.length-1;M>0;M--){const U=Math.floor(Math.random()*(M+1));[A[M],A[U]]=[A[U],A[M]]}t(2,c=A),ae.update(M=>({...M,playerTokens:A}))}const R=(A,M)=>O(M,A),H=(A,M)=>w(M,A);return o.$$set=A=>{"show"in A&&t(0,a=A.show),"onClose"in A&&t(1,s=A.onClose)},o.$$.update=()=>{o.$$.dirty&4096&&t(6,n=l),o.$$.dirty&4&&t(5,i=c.map((A,M)=>{const U=(90+360/c.length*M)*(Math.PI/180);return{x:d*Math.cos(U),y:d*Math.sin(U)}})),o.$$.dirty&4&&t(4,r=c.map((A,M)=>{const U=360/c.length,v=90+U*M,Y=(v-U/2)*(Math.PI/180),W=(v+U/2)*(Math.PI/180),z=h+k*Math.cos(Y),B=m+k*Math.sin(Y),L=h+k*Math.cos(W),S=m+k*Math.sin(W);return`M ${h} ${m} L ${z} ${B} A ${k} ${k} 0 0 1 ${L} ${S} Z`}))},[a,s,c,f,r,i,n,w,O,I,T,E,l,R,H]}class Aa extends ye{constructor(e){super(),we(this,e,Hd,Pd,ke,{show:0,onClose:1})}}function ar(o,e,t){const n=o.slice();return n[23]=e[t],n}function Gd(o){let e=[],t=new Map,n,i,r=X(o[6]);const l=a=>a[23].uuid;for(let a=0;a<r.length;a+=1){let s=ar(o,r,a),c=l(s);t.set(c,e[a]=ur(c,s))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=de()},m(a,s){for(let c=0;c<e.length;c+=1)e[c]&&e[c].m(a,s);_(a,n,s),i=!0},p(a,s){s&4076&&(r=X(a[6]),ne(),e=He(e,s,l,1,a,r,t,n.parentNode,Ve,ur,n,ar),oe())},i(a){if(!i){for(let s=0;s<r.length;s+=1)y(e[s]);i=!0}},o(a){for(let s=0;s<e.length;s+=1)N(e[s]);i=!1},d(a){a&&g(n);for(let s=0;s<e.length;s+=1)e[s].d(a)}}}function Fd(o){let e;return{c(){e=$("p"),e.textContent="No sessions exist yet. A session is always created when you start a game.",ce(e,"color","grey"),ce(e,"text-align","center"),ce(e,"font-size","0.875em")},m(t,n){_(t,e,n)},p:te,i:te,o:te,d(t){t&&g(e)}}}function jd(o){let e,t=Yo(o[23])+"",n,i,r,l,a,s,c,f=o[23].uuid!==o[5]&&cr(o);function u(){return o[20](o[23])}a=new Z({props:{$$slots:{default:[Wd]},$$scope:{ctx:o}}}),a.$on("click",u);let d=o[23].uuid!==o[5]&&fr(o);return{c(){e=$("span"),n=C(t),i=D(),r=$("div"),f&&f.c(),l=D(),j(a.$$.fragment),s=D(),d&&d.c(),p(e,"class","session-name svelte-ed24kv"),p(r,"class","session-buttons svelte-ed24kv")},m(h,m){_(h,e,m),b(e,n),_(h,i,m),_(h,r,m),f&&f.m(r,null),b(r,l),G(a,r,null),b(r,s),d&&d.m(r,null),c=!0},p(h,m){o=h,(!c||m&64)&&t!==(t=Yo(o[23])+"")&&J(n,t),o[23].uuid!==o[5]?f?(f.p(o,m),m&96&&y(f,1)):(f=cr(o),f.c(),y(f,1),f.m(r,l)):f&&(ne(),N(f,1,1,()=>{f=null}),oe());const k={};m&67108864&&(k.$$scope={dirty:m,ctx:o}),a.$set(k),o[23].uuid!==o[5]?d?(d.p(o,m),m&96&&y(d,1)):(d=fr(o),d.c(),y(d,1),d.m(r,null)):d&&(ne(),N(d,1,1,()=>{d=null}),oe())},i(h){c||(y(f),y(a.$$.fragment,h),y(d),c=!0)},o(h){N(f),N(a.$$.fragment,h),N(d),c=!1},d(h){h&&(g(e),g(i),g(r)),f&&f.d(),F(a),d&&d.d()}}}function zd(o){let e,t,n,i,r,l,a,s;function c(){return o[18](o[23])}return n=new Z({props:{$$slots:{default:[Vd]},$$scope:{ctx:o}}}),n.$on("click",c),r=new Z({props:{type:"cancel",$$slots:{default:[Xd]},$$scope:{ctx:o}}}),r.$on("click",o[10]),{c(){e=$("input"),t=D(),j(n.$$.fragment),i=D(),j(r.$$.fragment),p(e,"type","text"),p(e,"class","rename-input svelte-ed24kv"),p(e,"placeholder","Enter name")},m(f,u){_(f,e,u),Ne(e,o[3]),_(f,t,u),G(n,f,u),_(f,i,u),G(r,f,u),l=!0,a||(s=ee(e,"input",o[17]),a=!0)},p(f,u){o=f,u&8&&e.value!==o[3]&&Ne(e,o[3]);const d={};u&67108864&&(d.$$scope={dirty:u,ctx:o}),n.$set(d);const h={};u&67108864&&(h.$$scope={dirty:u,ctx:o}),r.$set(h)},i(f){l||(y(n.$$.fragment,f),y(r.$$.fragment,f),l=!0)},o(f){N(n.$$.fragment,f),N(r.$$.fragment,f),l=!1},d(f){f&&(g(e),g(t),g(i)),F(n,f),F(r,f),a=!1,s()}}}function cr(o){let e,t;function n(){return o[19](o[23])}return e=new Z({props:{$$slots:{default:[Kd]},$$scope:{ctx:o}}}),e.$on("click",n),{c(){j(e.$$.fragment)},m(i,r){G(e,i,r),t=!0},p(i,r){o=i;const l={};r&67108864&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(i){t||(y(e.$$.fragment,i),t=!0)},o(i){N(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function Kd(o){let e;return{c(){e=C("Open")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Wd(o){let e;return{c(){e=C("Rename")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function fr(o){let e,t;function n(){return o[21](o[23])}return e=new Z({props:{type:"cancel",$$slots:{default:[qd]},$$scope:{ctx:o}}}),e.$on("click",n),{c(){j(e.$$.fragment)},m(i,r){G(e,i,r),t=!0},p(i,r){o=i;const l={};r&67108864&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(i){t||(y(e.$$.fragment,i),t=!0)},o(i){N(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function qd(o){let e;return{c(){e=C("Delete")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Vd(o){let e;return{c(){e=C("Save")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Xd(o){let e;return{c(){e=C("Cancel")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function ur(o,e){let t,n,i,r,l;const a=[zd,jd],s=[];function c(f,u){return f[2]===f[23].uuid?0:1}return n=c(e),i=s[n]=a[n](e),{key:o,first:null,c(){t=$("div"),i.c(),r=D(),p(t,"class","session-item svelte-ed24kv"),Oe(t,"active",e[23].uuid===e[5]),this.first=t},m(f,u){_(f,t,u),s[n].m(t,null),b(t,r),l=!0},p(f,u){e=f;let d=n;n=c(e),n===d?s[n].p(e,u):(ne(),N(s[d],1,1,()=>{s[d]=null}),oe(),i=s[n],i?i.p(e,u):(i=s[n]=a[n](e),i.c()),y(i,1),i.m(t,r)),(!l||u&96)&&Oe(t,"active",e[23].uuid===e[5])},i(f){l||(y(i),l=!0)},o(f){N(i),l=!1},d(f){f&&g(t),s[n].d()}}}function Jd(o){let e,t,n,i,r,l,a,s;const c=[Fd,Gd],f=[];function u(d,h){return d[6].length===0?0:1}return t=u(o),n=f[t]=c[t](o),{c(){e=$("section"),n.c(),i=D(),r=$("input"),p(e,"class","sessions-list svelte-ed24kv"),p(r,"type","file"),p(r,"accept","application/json"),ce(r,"display","none")},m(d,h){_(d,e,h),f[t].m(e,null),_(d,i,h),_(d,r,h),o[22](r),l=!0,a||(s=ee(r,"change",o[14]),a=!0)},p(d,h){let m=t;t=u(d),t===m?f[t].p(d,h):(ne(),N(f[m],1,1,()=>{f[m]=null}),oe(),n=f[t],n?n.p(d,h):(n=f[t]=c[t](d),n.c()),y(n,1),n.m(e,null))},i(d){l||(y(n),l=!0)},o(d){N(n),l=!1},d(d){d&&(g(e),g(i),g(r)),f[t].d(),o[22](null),a=!1,s()}}}function Zd(o){let e;return{c(){e=C("Export")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Qd(o){let e;return{c(){e=C("Import")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function xd(o){let e,t,n,i;return e=new Z({props:{$$slots:{default:[Zd]},$$scope:{ctx:o}}}),e.$on("click",o[12]),n=new Z({props:{$$slots:{default:[Qd]},$$scope:{ctx:o}}}),n.$on("click",o[13]),{c(){j(e.$$.fragment),t=D(),j(n.$$.fragment)},m(r,l){G(e,r,l),_(r,t,l),G(n,r,l),i=!0},p(r,l){const a={};l&67108864&&(a.$$scope={dirty:l,ctx:r}),e.$set(a);const s={};l&67108864&&(s.$$scope={dirty:l,ctx:r}),n.$set(s)},i(r){i||(y(e.$$.fragment,r),y(n.$$.fragment,r),i=!0)},o(r){N(e.$$.fragment,r),N(n.$$.fragment,r),i=!1},d(r){r&&g(t),F(e,r),F(n,r)}}}function eh(o){let e;return{c(){e=C("Close")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function th(o){let e,t;return e=new Z({props:{$$slots:{default:[eh]},$$scope:{ctx:o}}}),e.$on("click",function(){ht(o[1])&&o[1].apply(this,arguments)}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){o=n;const r={};i&67108864&&(r.$$scope={dirty:i,ctx:o}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function nh(o){let e,t;return e=new De({props:{show:o[0],title:"Sessions",onClose:o[1],$$slots:{footer:[th],"footer-left":[xd],default:[Jd]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,[i]){const r={};i&1&&(r.show=n[0]),i&2&&(r.onClose=n[1]),i&67108990&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function oh(o,e,t){let n,i,r,l;se(o,q,v=>t(15,r=v)),se(o,Ke,v=>t(16,l=v));let{show:a}=e,{onClose:s}=e,c=null,f="";function u(v){if(i&&Ct(),!Xn(v)){alert("Failed to load session.");return}q.update(Y=>({...Y,activeSessionUuid:v,showSessionsModal:!1})),s()}function d(v){var Y,W,z,B,L;if(t(2,c=v.uuid),v.name&&v.name.trim())t(3,f=v.name.trim());else{const S=((z=(W=(Y=v.gameState)==null?void 0:Y.script)==null?void 0:W.meta)==null?void 0:z.name)??"Untitled",P=((L=(B=v.gameState)==null?void 0:B.playerTokens)==null?void 0:L.length)??0;t(3,f=`${S} ${P}p`)}}function h(v){const Y=f.trim();Nc(v,Y),t(2,c=null),t(3,f="")}function m(){t(2,c=null),t(3,f="")}function k(v){if(v===i){alert("You can't delete the active session.");return}confirm("Delete this session?")&&vc(v)}let w;function O(){const v=new Blob([Ic()],{type:"application/json"}),Y=URL.createObjectURL(v),W=document.createElement("a");W.href=Y,W.download="botc-sessions.json",W.click(),URL.revokeObjectURL(Y)}function I(){w.click()}function T(v){var z;const Y=(z=v.target.files)==null?void 0:z[0];if(!Y)return;const W=new FileReader;W.onload=()=>{if(typeof W.result!="string")return;Oc(W.result)===0&&alert("No new sessions were imported (all UUIDs already exist).")},W.readAsText(Y),v.target.value=""}function E(){f=this.value,t(3,f)}const R=v=>h(v.uuid),H=v=>u(v.uuid),A=v=>d(v),M=v=>k(v.uuid);function U(v){et[v?"unshift":"push"](()=>{w=v,t(4,w)})}return o.$$set=v=>{"show"in v&&t(0,a=v.show),"onClose"in v&&t(1,s=v.onClose)},o.$$.update=()=>{o.$$.dirty&65536&&t(6,n=l),o.$$.dirty&32768&&t(5,i=r.activeSessionUuid)},[a,s,c,f,w,i,n,u,d,h,m,k,O,I,T,r,l,E,R,H,A,M,U]}class ih extends ye{constructor(e){super(),we(this,e,oh,nh,ke,{show:0,onClose:1})}}const rh="Rules Explanation",lh="From Blood on the Clocktower Wiki",sh=["The rules sheet describes all the major things that a new player will need to know to start playing. Simply read out the text written on this sheet to the group, or let those who want to read it do so privately.","Part of the rules sheet will prompt you to talk about various hand signals. You’ll want to demonstrate these hand signals as you go, since some players learn visually.","If you wish, you can read out the part of the rules sheet that talks about nominations and executions now, but most players will learn this better if you read it out later on, when the first nomination for execution begins.","There is a duplicate rules sheet on the reverse side of the Traveller sheet, kept under the Town Square. To save time, get a veteran player to read out the rules from this sheet, so you don’t have to. While they are explaining the rules, you can set up the game."],ah=[{heading:"Before the Game Starts",content:["A long time ago in the sleepy town of Ravenswood Bluff, during a hellish thunderstorm, on the stroke of midnight... you hear a scream. Rushing to the Town Square to investigate, you find your beloved Storyteller, myself, has been murdered... impaled on the hour hand of the clocktower, blood dripping onto the cobblestones below. You assume that this is the work of a Demon, and you are correct—a Demon that kills by night and takes on human form by day.","You are about to receive either a red or blue token. If blue, you are good. If red, you are evil. The aim of the game if you are good is to find and execute the Demon. If the Demon dies, good wins. The aim of the game if you are evil is to destroy the town. If just two players are left alive, evil wins.","The game is split into two phases: a day phase and a night phase. During the day, you talk. You will each have a secret identity, a character on the list. Generally, the good players share whatever they know and attempt to find out who is who. Most good players will be telling the truth, but some have an incentive to lie. If you are evil, you should definitely be lying! It is best to pick a good character to pretend to be, spreading as much false information as possible.","During the night, everybody closes their eyes. I will wake some players so that they can use their ability or gain some type of information. At night, I will be silent, but communicate using the following signals: (Demonstrate the following as you talk.)","2 taps on your shoulder or your knee means EYES OPEN","This means EYES CLOSED","This means YES and this means NO","This means GOOD and this means EVIL","This means 0, 1, 2, 3 and so on","To choose a player at night, just point to them like THIS","Most of you will die. This is a good thing! In Ravenswood Bluff, death is not the end. Some players may even want to die, as they gain information when they do. If you are dead, you still participate in the game, you may still talk, and you still win or lose when your team wins or loses.","There is a lot of information in this game. However, some of it might be wrong. If you are drunk or poisoned, you have no ability, but I will pretend that you do. I am allowed to lie to you—any information that you get may be incorrect, but you will not know if you are drunk or poisoned. For example, if you are the Drunk, you drew a different character token out of the bag and only I know that you are actually the Drunk. Or, if the Poisoner poisons you, you may still wake at night to use your ability, but it won’t work."]},{heading:"Four Rules",content:["This can be a lot of information to take in at once, so to keep things simple, there are only four things you need to remember:","1) You may say whatever you want at any time. This is a talking game. You can talk publicly with the group or have private conversations, it is up to you.","2) No peeking. Please keep your character token a secret, and never look into the Grimoire, as it contains all the game characters. If you see something you shouldn’t, it will spoil the fun.","3) Ask me any questions you need to. If you get confused, or don’t understand how your character works, or don’t understand how the character that you are pretending to be works, or if something happens at night that you don’t understand, or you just need some strategy advice... whatever it is, please ask. I’m neutral, and my job is to help you understand the rules and have fun playing. Let me know when you have a question, and we can talk in private so that nobody knows what question you asked.","4) Play nice. This is a game about deception and trickery, so please treat others with respect and consideration. Kill with grace, and die with dignity."]},{heading:"Before the First Nomination",content:["I am about to call for nominations. To nominate a player, simply say who. For example: “I nominate Bob.” When a player is nominated, everyone votes on whether or not to execute them. For example: I will put my arm out like this (point to Bob), and say “Votes for Bob, starting now.” I move my hand in a clockwise direction (demonstrate this) and if your hand is up when I get to you, that’s a vote, and if your hand is down, that’s not a vote.","Each day, you may vote for as few or as many players as you wish, and whoever has the most votes is executed. This player needs a vote tally of at least 50% of the living players or no execution occurs. On a tie, neither player is executed.","If you die, you are still a major part of the game. You still talk, and you still close your eyes during the night time. Most importantly, you still win or lose with your team. In fact, the game is usually decided by the votes and opinions of the dead players. When you die, you lose your character ability, you may no longer nominate, and you have only one vote for the rest of the game, so use it wisely."]}],An={title:rh,source:lh,introduction:sh,sections:ah};function ch(o,e,t){const n=o.slice();return n[2]=e[t],n}function fh(o,e,t){const n=o.slice();return n[5]=e[t],n}function uh(o,e,t){const n=o.slice();return n[8]=e[t],n}function dh(o){let e;return{c(){e=$("p"),e.textContent=`${o[8]}`,p(e,"class","svelte-10gmq2t")},m(t,n){_(t,e,n)},p:te,d(t){t&&g(e)}}}function hh(o){let e;return{c(){e=$("p"),e.textContent=`${o[5]}`,p(e,"class","svelte-10gmq2t")},m(t,n){_(t,e,n)},p:te,d(t){t&&g(e)}}}function mh(o){let e,t,n,i=X(o[2].content),r=[];for(let l=0;l<i.length;l+=1)r[l]=hh(fh(o,i,l));return{c(){e=$("h3"),e.textContent=`${o[2].heading}`,t=D();for(let l=0;l<r.length;l+=1)r[l].c();n=de(),p(e,"class","svelte-10gmq2t")},m(l,a){_(l,e,a),_(l,t,a);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(l,a);_(l,n,a)},p:te,d(l){l&&(g(e),g(t),g(n)),me(r,l)}}}function ph(o){let e,t,n,i,r,l,a,s,c,f,u,d=X(An.introduction),h=[];for(let w=0;w<d.length;w+=1)h[w]=dh(uh(o,d,w));let m=X(An.sections),k=[];for(let w=0;w<m.length;w+=1)k[w]=mh(ch(o,m,w));return{c(){e=$("div"),t=$("details"),t.innerHTML=`<summary class="svelte-10gmq2t"><h3 class="svelte-10gmq2t">Pitch</h3></summary> <div class="pitch-list"><p class="svelte-10gmq2t">&quot;We are playing a game called Blood on the Clocktower!&quot;</p> <p class="svelte-10gmq2t">&quot;Clocktower is a spooky themed party game. It is a bluffing game and a puzzle game in one.&quot;</p> <p class="svelte-10gmq2t"><i>&quot;If you&#39;re familiar with Mafia or Werewolf, tell me and you&#39;ll get
            a quick run-down later of four critical differences.&quot;
            <li>&quot;Everyone, gets a unique role&quot;</li> <li>&quot;There will be real information to work with&quot;</li> <li>&quot;Dying does not remove you from the game anymore&quot;</li> <li>&quot;The game is big but you can focus on the game.&quot;</li></i></p></div>`,n=D(),i=$("details"),r=$("summary"),r.innerHTML='<h3 class="svelte-10gmq2t">Preface</h3>',l=D(),a=$("p"),a.textContent=`Source: ${An.source}`,s=D();for(let w=0;w<h.length;w+=1)h[w].c();c=D();for(let w=0;w<k.length;w+=1)k[w].c();f=D(),u=$("details"),u.innerHTML='<summary class="svelte-10gmq2t"><h1 style="color:purple">Altered Explanation</h1></summary> <div><p class="svelte-10gmq2t">A long time ago in the sleepy town of Ravenswood Bluff, during a thunderstorm much like this...</p> <p class="svelte-10gmq2t">Welcome to Blood on the Clocktower!</p> <p class="svelte-10gmq2t">You are about to draw a red or a blue token. If blue, you&#39;re in the good team. If red, you&#39;re in the evil team. Good wins by voting out the Demon. Evil wins when only two are alive left.</p> <p class="svelte-10gmq2t">The game cycles between nights and days. During the day, you talk. Good team tries to know who is whom.</p> <p class="svelte-10gmq2t">Evil players usually pick a good role to pretend to be, sowing chaos and ultimately protecting their Demon.</p> <p class="svelte-10gmq2t">During the night, everybody closes their eyes. I will wake some players with two taps when it is time for them to perform their ability or get information. This is done in silence.</p> <p style="font-style: italic" class="svelte-10gmq2t">Nod means yes/no. Thumbs mean good/evil. Fingers mean numbers.</p> <p class="svelte-10gmq2t">Most of you will become ghosts. This is good! You don&#39;t get eliminated; you still close your eyes, discuss, and win. This is a team game where ghosts are valuable.</p> <p class="svelte-10gmq2t">Finally, you can be drunk or poisoned in this game. This happens if The Poisoner chooses you, or if you are *the* Drunk, who draws a token that they think they are.</p> <p class="svelte-10gmq2t">If so, you have no ability, but I will pretend that you do. You do not know you are drunk or poisoned but I do.</p> <p class="svelte-10gmq2t">This is a lot of information to take in at once, so to keep things simple, there are only four things you need to remember:</p> <p class="svelte-10gmq2t">1: You may say whatever you want at any time. This is a talking game. You can talk publicly with the group or have private conversations, it is your choice.</p> <p class="svelte-10gmq2t">2: No peeking. Please keep your draw hidden. Do not look into my Grimoire of characters. Do not peek at night. If you see something you&#39;re not supposed to, it will spoil the fun.</p> <p class="svelte-10gmq2t">3: Ask me any questions you need to. If you&#39;re confused about your role, the rules, or other roles—just ask me privately. I&#39;m here to help you have fun.</p> <p class="svelte-10gmq2t">4: Play nice. This is a lying game. Kill with kindness, defend with dignity. My goal is for everyone to feel included, but that takes everyones help.</p> <p class="svelte-10gmq2t">The game will soon begin. Please be ready to draw your role.</p> <p class="svelte-10gmq2t">The first night will soon begin. Please close your eyes. The Demon will learn three roles not-in-play. As well as evil team will now see each other.</p> <hr style="width:50%"/> <p class="svelte-10gmq2t">This is an environment where you might get tricked and feel paranoid. While most will be truthful, I encourage you to enjoy the mystery of this game!</p> <p class="svelte-10gmq2t">You might have to lie to your nearest ones. This is difficult. But everyone in this room is prepared to get tricked, yes?</p> <p class="svelte-10gmq2t">Please be inclusive of suspected Evils and Ghosts among you! We are in each others responsibility and I need your help for everyone to come out with a memorable experience.</p> <p class="svelte-10gmq2t">Finally: Talk, share and trust. This is a game about trust, much more that it is about staying alive as it is not a elimination game. That is all the hint I will give you.</p> <hr style="width:50%"/> <p class="svelte-10gmq2t">To nominate, say “I nominate Bob.” Both players will explain themselves. A majority vote is required to execute. I will count votes clockwise by raised hands; once I have passed you, raising your hand will not count.</p> <p class="svelte-10gmq2t">A day can have many nominations. You can vote in all of them. The most voted gets executed. On a tie, no one dies.</p> <p class="svelte-10gmq2t">As dead, you lose your ability. You yourself cannot nominate others. And you just have one last vote to use.</p> <p class="svelte-10gmq2t">The dead are a major part of the game. Do not be saddened if you die! Very often, dead votes and opinions decide the game.</p> <p class="svelte-10gmq2t">With that, nominations are open!</p> <hr style="width:50%"/> <p class="svelte-10gmq2t">(If tantrum)&quot;I sense you&#39;re not having fun anymore. Quick break, drink some water? Let&#39;s take 5, everyone.&quot;</p> <p class="svelte-10gmq2t">(If someone needs to leave, run the Fiddler, or Umpire, or Bench)</p> <p class="svelte-10gmq2t">(If giving advice) 1. Reconfirm role, info, 2. Reconfirm goals (Contribute when feel timing is right), (Protect Demon at all cost, take the heat if needed.)</p> <hr style="width:50%"/> <p class="svelte-10gmq2t">&quot;An applause for their performance as our Evil Team, please take a bow!&quot;</p> <p class="svelte-10gmq2t">&quot;Thank you for letting me Storytell this session of Clocktower—I hope you enjoyed it as much as I did.&quot;</p> <p class="svelte-10gmq2t">If you&#39;d like, chat for a bit, give credit to those who tricked you or other good plays.</p></div>',p(t,"class","collapsible svelte-10gmq2t"),p(r,"class","svelte-10gmq2t"),p(a,"class","source svelte-10gmq2t"),p(i,"class","collapsible svelte-10gmq2t"),p(u,"class","collapsible svelte-10gmq2t"),p(e,"class","rules-body svelte-10gmq2t")},m(w,O){_(w,e,O),b(e,t),b(e,n),b(e,i),b(i,r),b(i,l),b(i,a),b(i,s);for(let I=0;I<h.length;I+=1)h[I]&&h[I].m(i,null);b(e,c);for(let I=0;I<k.length;I+=1)k[I]&&k[I].m(e,null);b(e,f),b(e,u)},p:te,d(w){w&&g(e),me(h,w),me(k,w)}}}function gh(o){let e;return{c(){e=C("Close")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function _h(o){let e,t;return e=new Z({props:{$$slots:{default:[gh]},$$scope:{ctx:o}}}),e.$on("click",function(){ht(o[1])&&o[1].apply(this,arguments)}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){o=n;const r={};i&2048&&(r.$$scope={dirty:i,ctx:o}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function bh(o){let e,t;return e=new De({props:{show:o[0],title:An.title,onClose:o[1],$$slots:{footer:[_h],default:[ph]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,[i]){const r={};i&1&&(r.show=n[0]),i&2&&(r.onClose=n[1]),i&2050&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function kh(o,e,t){let{show:n}=e,{onClose:i}=e;return o.$$set=r=>{"show"in r&&t(0,n=r.show),"onClose"in r&&t(1,i=r.onClose)},[n,i]}class wh extends ye{constructor(e){super(),we(this,e,kh,bh,ke,{show:0,onClose:1})}}function yh(o){let e;return{c(){e=C(o[3])},m(t,n){_(t,e,n)},p(t,n){n&8&&J(e,t[3])},d(t){t&&g(e)}}}function $h(o){let e;return{c(){e=C(o[2])},m(t,n){_(t,e,n)},p(t,n){n&4&&J(e,t[2])},d(t){t&&g(e)}}}function vh(o){let e;return{c(){e=C("Select In-Play Roles")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Nh(o){let e;return{c(){e=C("Set Demon Bluffs")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Ih(o){let e;return{c(){e=C("Rules Explanation")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Oh(o){let e;return{c(){e=C("Token Bag Handout")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Rh(o){let e,t,n,i,r,l,a,s,c,f,u,d,h,m,k,w,O,I,T;return t=new Z({props:{$$slots:{default:[yh]},$$scope:{ctx:o}}}),t.$on("click",o[6]),i=new Z({props:{$$slots:{default:[$h]},$$scope:{ctx:o}}}),i.$on("click",o[7]),l=new Z({props:{disabled:o[0].script.roles.length===0,$$slots:{default:[vh]},$$scope:{ctx:o}}}),l.$on("click",o[10]),s=new Z({props:{$$slots:{default:[Nh]},$$scope:{ctx:o}}}),s.$on("click",o[16]),d=new Z({props:{$$slots:{default:[Ih]},$$scope:{ctx:o}}}),d.$on("click",o[11]),m=new Z({props:{$$slots:{default:[Oh]},$$scope:{ctx:o}}}),m.$on("click",o[8]),{c(){e=$("div"),j(t.$$.fragment),n=D(),j(i.$$.fragment),r=D(),j(l.$$.fragment),a=D(),j(s.$$.fragment),c=D(),f=$("h3"),f.textContent="Before the game starts",u=D(),j(d.$$.fragment),h=D(),j(m.$$.fragment),k=D(),w=$("input"),p(f,"class","svelte-15xajyx"),p(e,"class","setup-modal-content svelte-15xajyx"),p(w,"type","file"),p(w,"accept","application/json"),ce(w,"display","none")},m(E,R){_(E,e,R),G(t,e,null),b(e,n),G(i,e,null),b(e,r),G(l,e,null),b(e,a),G(s,e,null),b(e,c),b(e,f),b(e,u),G(d,e,null),b(e,h),G(m,e,null),_(E,k,R),_(E,w,R),o[17](w),O=!0,I||(T=ee(w,"change",o[5]),I=!0)},p(E,R){const H={};R&33554440&&(H.$$scope={dirty:R,ctx:E}),t.$set(H);const A={};R&33554436&&(A.$$scope={dirty:R,ctx:E}),i.$set(A);const M={};R&1&&(M.disabled=E[0].script.roles.length===0),R&33554432&&(M.$$scope={dirty:R,ctx:E}),l.$set(M);const U={};R&33554432&&(U.$$scope={dirty:R,ctx:E}),s.$set(U);const v={};R&33554432&&(v.$$scope={dirty:R,ctx:E}),d.$set(v);const Y={};R&33554432&&(Y.$$scope={dirty:R,ctx:E}),m.$set(Y)},i(E){O||(y(t.$$.fragment,E),y(i.$$.fragment,E),y(l.$$.fragment,E),y(s.$$.fragment,E),y(d.$$.fragment,E),y(m.$$.fragment,E),O=!0)},o(E){N(t.$$.fragment,E),N(i.$$.fragment,E),N(l.$$.fragment,E),N(s.$$.fragment,E),N(d.$$.fragment,E),N(m.$$.fragment,E),O=!1},d(E){E&&(g(e),g(k),g(w)),F(t),F(i),F(l),F(s),F(d),F(m),o[17](null),I=!1,T()}}}function Th(o){let e;return{c(){e=C("Sessions")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Eh(o){let e;return{c(){e=C("Travellers")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Dh(o){let e,t,n,i;return e=new Z({props:{$$slots:{default:[Th]},$$scope:{ctx:o}}}),e.$on("click",o[15]),n=new Z({props:{$$slots:{default:[Eh]},$$scope:{ctx:o}}}),n.$on("click",o[9]),{c(){j(e.$$.fragment),t=D(),j(n.$$.fragment)},m(r,l){G(e,r,l),_(r,t,l),G(n,r,l),i=!0},p(r,l){const a={};l&33554432&&(a.$$scope={dirty:l,ctx:r}),e.$set(a);const s={};l&33554432&&(s.$$scope={dirty:l,ctx:r}),n.$set(s)},i(r){i||(y(e.$$.fragment,r),y(n.$$.fragment,r),i=!0)},o(r){N(e.$$.fragment,r),N(n.$$.fragment,r),i=!1},d(r){r&&g(t),F(e,r),F(n,r)}}}function Ah(o){let e;return{c(){e=C("Close")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Sh(o){let e,t;return e=new Z({props:{$$slots:{default:[Ah]},$$scope:{ctx:o}}}),e.$on("click",o[12]),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&33554432&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Ch(o){let e,t,n,i,r,l,a,s,c,f,u,d;return e=new De({props:{show:o[4].showSetupModal,title:"Setup",onClose:o[12],$$slots:{footer:[Sh],"footer-left":[Dh],default:[Rh]},$$scope:{ctx:o}}}),n=new _d({props:{show:o[4].showScriptSelectionModal,onClose:o[18]}}),r=new Od({}),a=new Aa({props:{show:o[4].showArrangePlayersModal,onClose:o[19]}}),c=new ih({props:{show:o[4].showSessionsModal,onClose:o[20]}}),u=new wh({props:{show:o[4].showRulesModal,onClose:o[21]}}),{c(){j(e.$$.fragment),t=D(),j(n.$$.fragment),i=D(),j(r.$$.fragment),l=D(),j(a.$$.fragment),s=D(),j(c.$$.fragment),f=D(),j(u.$$.fragment)},m(h,m){G(e,h,m),_(h,t,m),G(n,h,m),_(h,i,m),G(r,h,m),_(h,l,m),G(a,h,m),_(h,s,m),G(c,h,m),_(h,f,m),G(u,h,m),d=!0},p(h,[m]){const k={};m&16&&(k.show=h[4].showSetupModal),m&33554447&&(k.$$scope={dirty:m,ctx:h}),e.$set(k);const w={};m&16&&(w.show=h[4].showScriptSelectionModal),n.$set(w);const O={};m&16&&(O.show=h[4].showArrangePlayersModal),a.$set(O);const I={};m&16&&(I.show=h[4].showSessionsModal),c.$set(I);const T={};m&16&&(T.show=h[4].showRulesModal),u.$set(T)},i(h){d||(y(e.$$.fragment,h),y(n.$$.fragment,h),y(r.$$.fragment,h),y(a.$$.fragment,h),y(c.$$.fragment,h),y(u.$$.fragment,h),d=!0)},o(h){N(e.$$.fragment,h),N(n.$$.fragment,h),N(r.$$.fragment,h),N(a.$$.fragment,h),N(c.$$.fragment,h),N(u.$$.fragment,h),d=!1},d(h){h&&(g(t),g(i),g(l),g(s),g(f)),F(e,h),F(n,h),F(r,h),F(a,h),F(c,h),F(u,h)}}}function Mh(o,e,t){let n,i,r,l,a,s;se(o,ae,U=>t(0,a=U)),se(o,q,U=>t(4,s=U));let c;function f(U){var W;const v=(W=U.target.files)==null?void 0:W[0];if(!v)return;const Y=new FileReader;Y.onload=()=>{try{const z=JSON.parse(Y.result);z.uiState&&q.set(z.uiState),z.gameState&&ae.set(z.gameState)}catch{alert("Invalid JSON file!")}},Y.readAsText(v),U.target.value=""}function u(){q.update(U=>({...U,showScriptSelectionModal:!0}))}function d(){q.update(U=>({...U,showSetPlayerCountModal:!0}))}function h(){const U=re(ae).script.roles;q.update(v=>({...v,tokenBagOrder:[...U],tokenBagSwiped:[],showTokenBagModal:!0}))}function m(){q.update(U=>({...U,showRoleSelectionModal:!0,roleSelectionContext:"travellers",selectedRoles:[]}))}function k(){q.update(U=>({...U,showRoleSelectionModal:!0,roleSelectionContext:"setup",selectedRoles:[]}))}function w(){q.update(U=>({...U,showRulesModal:!0}))}function O(){q.update(U=>({...U,showSetupModal:!1}))}const I=()=>q.update(U=>({...U,showSessionsModal:!0})),T=()=>q.update(U=>({...U,currentCard:_t("roles_not_in_play",re(io))??null,showCardModal:!0,showSetupModal:!1}));function E(U){et[U?"unshift":"push"](()=>{c=U,t(1,c)})}const R=()=>q.update(U=>({...U,showScriptSelectionModal:!1})),H=()=>q.update(U=>({...U,showArrangePlayersModal:!1})),A=()=>q.update(U=>({...U,showSessionsModal:!1})),M=()=>q.update(U=>({...U,showRulesModal:!1}));return o.$$.update=()=>{o.$$.dirty&1&&t(14,n=a.script.meta.name),o.$$.dirty&16384&&t(3,i=n?`Set Script: ${n}`:"Set Script"),o.$$.dirty&1&&t(13,r=a.basePlayersCount),o.$$.dirty&8192&&t(2,l=`Change Base Player Count: ${r}`)},[a,c,l,i,s,f,u,d,h,m,k,w,O,r,n,I,T,E,R,H,A,M]}class Lh extends ye{constructor(e){super(),we(this,e,Mh,Ch,ke,{})}}function dr(o,e,t){const n=o.slice();return n[2]=e[t],n}function hr(o,e,t){const n=o.slice();return n[5]=e[t],n}function mr(o){let e,t,n,i=X(o[0]),r=[];for(let l=0;l<i.length;l+=1)r[l]=_r(dr(o,i,l));return{c(){e=$("div"),t=$("h3"),t.textContent="Role Instructions 🍂",n=D();for(let l=0;l<r.length;l+=1)r[l].c();p(t,"class","section-header svelte-5zr9m4"),p(e,"class","role-instructions svelte-5zr9m4")},m(l,a){_(l,e,a),b(e,t),b(e,n);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(e,null)},p(l,a){if(a&3){i=X(l[0]);let s;for(s=0;s<i.length;s+=1){const c=dr(l,i,s);r[s]?r[s].p(c,a):(r[s]=_r(c),r[s].c(),r[s].m(e,null))}for(;s<r.length;s+=1)r[s].d(1);r.length=i.length}},d(l){l&&g(e),me(r,l)}}}function pr(o){let e,t,n=o[2].name+"",i,r,l,a,s,c,f=X(o[1](o[2].id).filter(kr)),u=[];for(let d=0;d<f.length;d+=1)u[d]=gr(hr(o,f,d));return{c(){e=$("div"),t=$("h4"),i=C(n),r=D(),l=$("span"),l.textContent="🍂",a=D(),s=$("ol");for(let d=0;d<u.length;d+=1)u[d].c();c=D(),p(l,"class","leaf-icon svelte-5zr9m4"),p(t,"class","leaf-title svelte-5zr9m4"),p(s,"class","how-to-run-list svelte-5zr9m4"),p(e,"class","leaf-block")},m(d,h){_(d,e,h),b(e,t),b(t,i),b(t,r),b(t,l),b(e,a),b(e,s);for(let m=0;m<u.length;m+=1)u[m]&&u[m].m(s,null);b(e,c)},p(d,h){if(h&1&&n!==(n=d[2].name+"")&&J(i,n),h&3){f=X(d[1](d[2].id).filter(kr));let m;for(m=0;m<f.length;m+=1){const k=hr(d,f,m);u[m]?u[m].p(k,h):(u[m]=gr(k),u[m].c(),u[m].m(s,null))}for(;m<u.length;m+=1)u[m].d(1);u.length=f.length}},d(d){d&&g(e),me(u,d)}}}function gr(o){let e,t=o[5]+"",n;return{c(){e=$("li"),n=C(t),p(e,"class","how-to-run-step svelte-5zr9m4")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r&3&&t!==(t=i[5]+"")&&J(n,t)},d(i){i&&g(e)}}}function _r(o){let e=o[1](o[2].id).some(br),t,n=e&&pr(o);return{c(){n&&n.c(),t=de()},m(i,r){n&&n.m(i,r),_(i,t,r)},p(i,r){r&3&&(e=i[1](i[2].id).some(br)),e?n?n.p(i,r):(n=pr(i),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(i){i&&g(t),n&&n.d(i)}}}function Uh(o){let e,t=o[0].length&&mr(o);return{c(){t&&t.c(),e=de()},m(n,i){t&&t.m(n,i),_(n,e,i)},p(n,[i]){n[0].length?t?t.p(n,i):(t=mr(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:te,o:te,d(n){n&&g(e),t&&t.d(n)}}}const br=o=>o.startsWith("While setting up the game"),kr=o=>o.startsWith("While setting up the game");function Ph(o,e,t){let{roles:n=[]}=e,{getHowToRun:i=()=>[]}=e;return o.$$set=r=>{"roles"in r&&t(0,n=r.roles),"getHowToRun"in r&&t(1,i=r.getHowToRun)},[n,i]}class Bh extends ye{constructor(e){super(),we(this,e,Ph,Uh,ke,{roles:0,getHowToRun:1})}}const{Map:Sa}=eo;function wr(o,e,t){const n=o.slice();return n[55]=e[t],n}function yr(o,e,t){const n=o.slice();return n[55]=e[t],n}function $r(o,e,t){const n=o.slice();return n[50]=e[t],n}function vr(o,e,t){const n=o.slice();return n[46]=e[t].version,n[47]=e[t].roles,n}function Nr(o,e,t){const n=o.slice();return n[50]=e[t],n}function Ir(o,e,t){const n=o.slice();return n[50]=e[t],n}function Yh(o){let e,t,n,i=X(o[20]),r=[];for(let s=0;s<i.length;s+=1)r[s]=Dr(yr(o,i,s));const l=s=>N(r[s],1,1,()=>{r[s]=null});let a=o[14]&&o[15].length&&Ar(o);return{c(){e=$("div");for(let s=0;s<r.length;s+=1)r[s].c();t=D(),a&&a.c(),p(e,"class","role-grid svelte-1tx1vzt")},m(s,c){_(s,e,c);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);b(e,t),a&&a.m(e,null),n=!0},p(s,c){if(c[0]&32657661){i=X(s[20]);let f;for(f=0;f<i.length;f+=1){const u=yr(s,i,f);r[f]?(r[f].p(u,c),y(r[f],1)):(r[f]=Dr(u),r[f].c(),y(r[f],1),r[f].m(e,t))}for(ne(),f=i.length;f<r.length;f+=1)l(f);oe()}s[14]&&s[15].length?a?(a.p(s,c),c[0]&49152&&y(a,1)):(a=Ar(s),a.c(),y(a,1),a.m(e,null)):a&&(ne(),N(a,1,1,()=>{a=null}),oe())},i(s){if(!n){for(let c=0;c<i.length;c+=1)y(r[c]);y(a),n=!0}},o(s){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)N(r[c]);N(a),n=!1},d(s){s&&g(e),me(r,s),a&&a.d()}}}function Hh(o){let e,t,n=X(o[18]),i=[];for(let l=0;l<n.length;l+=1)i[l]=Pr(vr(o,n,l));const r=l=>N(i[l],1,1,()=>{i[l]=null});return{c(){for(let l=0;l<i.length;l+=1)i[l].c();e=de()},m(l,a){for(let s=0;s<i.length;s+=1)i[s]&&i[s].m(l,a);_(l,e,a),t=!0},p(l,a){if(a[0]&4456544){n=X(l[18]);let s;for(s=0;s<n.length;s+=1){const c=vr(l,n,s);i[s]?(i[s].p(c,a),y(i[s],1)):(i[s]=Pr(c),i[s].c(),y(i[s],1),i[s].m(e.parentNode,e))}for(ne(),s=n.length;s<i.length;s+=1)r(s);oe()}},i(l){if(!t){for(let a=0;a<n.length;a+=1)y(i[a]);t=!0}},o(l){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)N(i[a]);t=!1},d(l){l&&g(e),me(i,l)}}}function Or(o){let e,t=o[3][o[55]]+"",n,i,r=o[17][o[21][o[55]]]+"",l;return{c(){e=C("— "),n=C(t),i=C(" of "),l=C(r)},m(a,s){_(a,e,s),_(a,n,s),_(a,i,s),_(a,l,s)},p(a,s){s[0]&8&&t!==(t=a[3][a[55]]+"")&&J(n,t),s[0]&131072&&r!==(r=a[17][a[21][a[55]]]+"")&&J(l,r)},d(a){a&&(g(e),g(n),g(i),g(l))}}}function Rr(o){let e;return{c(){e=$("span"),e.textContent="🍂",p(e,"class","leaf-badge svelte-1tx1vzt"),p(e,"aria-label","Leafed Role")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Tr(o){let e;return{c(){e=$("span"),e.textContent="IN PLAY",p(e,"class","in-play-label svelte-1tx1vzt")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Er(o){let e,t,n,i=o[23](o[50]),r,l=o[4].includes(o[50].id)&&(!o[12]||o[7]),a,s,c,f,u,d;t=new Ut({props:{role:o[50],size:o[6]?"normal":en,alignment:o[50].defaultAlignment}});let h=i&&Rr(),m=l&&Tr();function k(){return o[40](o[50])}function w(...I){return o[41](o[50],...I)}function O(...I){return o[42](o[50],...I)}return{c(){e=$("div"),j(t.$$.fragment),n=D(),h&&h.c(),r=D(),m&&m.c(),p(e,"class","card svelte-1tx1vzt"),p(e,"role","button"),p(e,"tabindex",a=o[14]&&o[4].includes(o[50].id)?-1:0),p(e,"aria-disabled",s=o[14]&&o[4].includes(o[50].id)),p(e,"aria-pressed",c=o[5].selectedRoles.includes(o[50].id)),Oe(e,"selected",o[5].selectedRoles.includes(o[50].id)),Oe(e,"disabled",o[14]&&o[4].includes(o[50].id))},m(I,T){_(I,e,T),G(t,e,null),b(e,n),h&&h.m(e,null),b(e,r),m&&m.m(e,null),f=!0,u||(d=[ee(e,"click",k),ee(e,"keydown",w),ee(e,"contextmenu",O)],u=!0)},p(I,T){o=I;const E={};T[0]&5&&(E.role=o[50]),T[0]&64&&(E.size=o[6]?"normal":en),T[0]&5&&(E.alignment=o[50].defaultAlignment),t.$set(E),T[0]&5&&(i=o[23](o[50])),i?h||(h=Rr(),h.c(),h.m(e,r)):h&&(h.d(1),h=null),T[0]&4245&&(l=o[4].includes(o[50].id)&&(!o[12]||o[7])),l?m||(m=Tr(),m.c(),m.m(e,null)):m&&(m.d(1),m=null),(!f||T[0]&16405&&a!==(a=o[14]&&o[4].includes(o[50].id)?-1:0))&&p(e,"tabindex",a),(!f||T[0]&16405&&s!==(s=o[14]&&o[4].includes(o[50].id)))&&p(e,"aria-disabled",s),(!f||T[0]&37&&c!==(c=o[5].selectedRoles.includes(o[50].id)))&&p(e,"aria-pressed",c),(!f||T[0]&1048613)&&Oe(e,"selected",o[5].selectedRoles.includes(o[50].id)),(!f||T[0]&1064981)&&Oe(e,"disabled",o[14]&&o[4].includes(o[50].id))},i(I){f||(y(t.$$.fragment,I),f=!0)},o(I){N(t.$$.fragment,I),f=!1},d(I){I&&g(e),F(t),h&&h.d(),m&&m.d(),u=!1,$e(d)}}}function Dr(o){let e,t=o[55]+"",n,i,r,l,a,s,c=o[14]&&Or(o);function f(...m){return o[39](o[55],...m)}let u=X(Object.values(o[2]).filter(f)),d=[];for(let m=0;m<u.length;m+=1)d[m]=Er($r(o,u,m));const h=m=>N(d[m],1,1,()=>{d[m]=null});return{c(){e=$("h3"),n=C(t),i=D(),c&&c.c(),r=D(),l=$("div");for(let m=0;m<d.length;m+=1)d[m].c();p(e,"class","section-header svelte-1tx1vzt"),p(l,"class",a=Et(o[6]?"grid-mode":"grid-container")+" svelte-1tx1vzt")},m(m,k){_(m,e,k),b(e,n),b(e,i),c&&c.m(e,null),_(m,r,k),_(m,l,k);for(let w=0;w<d.length;w+=1)d[w]&&d[w].m(l,null);s=!0},p(m,k){if(o=m,o[14]?c?c.p(o,k):(c=Or(o),c.c(),c.m(e,null)):c&&(c.d(1),c=null),k[0]&30429429){u=X(Object.values(o[2]).filter(f));let w;for(w=0;w<u.length;w+=1){const O=$r(o,u,w);d[w]?(d[w].p(O,k),y(d[w],1)):(d[w]=Er(O),d[w].c(),y(d[w],1),d[w].m(l,null))}for(ne(),w=u.length;w<d.length;w+=1)h(w);oe()}(!s||k[0]&64&&a!==(a=Et(o[6]?"grid-mode":"grid-container")+" svelte-1tx1vzt"))&&p(l,"class",a)},i(m){if(!s){for(let k=0;k<u.length;k+=1)y(d[k]);s=!0}},o(m){d=d.filter(Boolean);for(let k=0;k<d.length;k+=1)N(d[k]);s=!1},d(m){m&&(g(e),g(r),g(l)),c&&c.d(),me(d,m)}}}function Ar(o){let e,t,n,i,r,l,a,s,c,f,u,d;e=new Bh({props:{roles:o[15],getHowToRun:o[19]}});let h=X(o[20]),m=[];for(let k=0;k<h.length;k+=1)m[k]=Sr(wr(o,h,k));return{c(){j(e.$$.fragment),t=D(),n=$("div");for(let k=0;k<m.length;k+=1)m[k].c();i=D(),r=$("br"),l=D(),a=C(o[16]),s=C(" Total of "),c=C(o[1]),f=D(),u=$("p"),u.textContent="Reminder tokens are on the Grimoire, but you need to move them yourself.",p(n,"class","setup-summary svelte-1tx1vzt")},m(k,w){G(e,k,w),_(k,t,w),_(k,n,w);for(let O=0;O<m.length;O+=1)m[O]&&m[O].m(n,null);b(n,i),b(n,r),b(n,l),b(n,a),b(n,s),b(n,c),b(n,f),b(n,u),d=!0},p(k,w){const O={};if(w[0]&32768&&(O.roles=k[15]),e.$set(O),w[0]&3276808){h=X(k[20]);let I;for(I=0;I<h.length;I+=1){const T=wr(k,h,I);m[I]?m[I].p(T,w):(m[I]=Sr(T),m[I].c(),m[I].m(n,i))}for(;I<m.length;I+=1)m[I].d(1);m.length=h.length}(!d||w[0]&65536)&&J(a,k[16]),(!d||w[0]&2)&&J(c,k[1])},i(k){d||(y(e.$$.fragment,k),d=!0)},o(k){N(e.$$.fragment,k),d=!1},d(k){k&&(g(t),g(n)),F(e,k),me(m,k)}}}function Sr(o){let e=o[3][o[55]]+"",t,n,i=o[17][o[21][o[55]]]+"",r,l,a=o[55]+"",s,c;return{c(){t=C(e),n=C("/"),r=C(i),l=D(),s=C(a),c=C(" ")},m(f,u){_(f,t,u),_(f,n,u),_(f,r,u),_(f,l,u),_(f,s,u),_(f,c,u)},p(f,u){u[0]&8&&e!==(e=f[3][f[55]]+"")&&J(t,e),u[0]&131072&&i!==(i=f[17][f[21][f[55]]]+"")&&J(r,i)},d(f){f&&(g(t),g(n),g(r),g(l),g(s),g(c))}}}function Cr(o){let e,t=[],n=new Sa,i,r,l=X(o[47].filter(jr));const a=s=>s[50].id;for(let s=0;s<l.length;s+=1){let c=Ir(o,l,s),f=a(c);n.set(f,t[s]=Mr(f,c))}return{c(){e=$("div");for(let s=0;s<t.length;s+=1)t[s].c();p(e,"class",i=Et(o[6]?"grid-mode":"grid-container")+" svelte-1tx1vzt")},m(s,c){_(s,e,c);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);r=!0},p(s,c){c[0]&4456544&&(l=X(s[47].filter(jr)),ne(),t=He(t,c,a,1,s,l,n,e,Ve,Mr,null,Ir),oe()),(!r||c[0]&64&&i!==(i=Et(s[6]?"grid-mode":"grid-container")+" svelte-1tx1vzt"))&&p(e,"class",i)},i(s){if(!r){for(let c=0;c<l.length;c+=1)y(t[c]);r=!0}},o(s){for(let c=0;c<t.length;c+=1)N(t[c]);r=!1},d(s){s&&g(e);for(let c=0;c<t.length;c+=1)t[c].d()}}}function Mr(o,e){let t,n,i,r,l,a,s;n=new Ut({props:{role:e[50],size:e[6]?"normal":en,alignment:e[50].defaultAlignment}});function c(){return e[35](e[50])}function f(...u){return e[36](e[50],...u)}return{key:o,first:null,c(){t=$("div"),j(n.$$.fragment),i=D(),p(t,"class","card svelte-1tx1vzt"),p(t,"role","button"),p(t,"tabindex","0"),p(t,"aria-pressed",r=e[5].selectedRoles.includes(e[50].id)),Oe(t,"selected",e[5].selectedRoles.includes(e[50].id)),this.first=t},m(u,d){_(u,t,d),G(n,t,null),b(t,i),l=!0,a||(s=[ee(t,"click",c),ee(t,"keydown",f)],a=!0)},p(u,d){e=u;const h={};d[0]&262144&&(h.role=e[50]),d[0]&64&&(h.size=e[6]?"normal":en),d[0]&262144&&(h.alignment=e[50].defaultAlignment),n.$set(h),(!l||d[0]&262176&&r!==(r=e[5].selectedRoles.includes(e[50].id)))&&p(t,"aria-pressed",r),(!l||d[0]&262176)&&Oe(t,"selected",e[5].selectedRoles.includes(e[50].id))},i(u){l||(y(n.$$.fragment,u),l=!0)},o(u){N(n.$$.fragment,u),l=!1},d(u){u&&g(t),F(n),a=!1,$e(s)}}}function Lr(o){let e,t=[],n=new Sa,i,r,l,a=X(o[47].filter(zr));const s=c=>c[50].id;for(let c=0;c<a.length;c+=1){let f=Nr(o,a,c),u=s(f);n.set(u,t[c]=Ur(u,f))}return{c(){e=$("div");for(let c=0;c<t.length;c+=1)t[c].c();i=D(),p(e,"class",r=Et(o[6]?"grid-mode":"grid-container")+" svelte-1tx1vzt")},m(c,f){_(c,e,f);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);b(e,i),l=!0},p(c,f){f[0]&4456544&&(a=X(c[47].filter(zr)),ne(),t=He(t,f,s,1,c,a,n,e,Ve,Ur,i,Nr),oe()),(!l||f[0]&64&&r!==(r=Et(c[6]?"grid-mode":"grid-container")+" svelte-1tx1vzt"))&&p(e,"class",r)},i(c){if(!l){for(let f=0;f<a.length;f+=1)y(t[f]);l=!0}},o(c){for(let f=0;f<t.length;f+=1)N(t[f]);l=!1},d(c){c&&g(e);for(let f=0;f<t.length;f+=1)t[f].d()}}}function Ur(o,e){let t,n,i,r,l,a;n=new Ut({props:{role:e[50],size:e[6]?"normal":en,alignment:e[50].defaultAlignment}});function s(){return e[37](e[50])}function c(...f){return e[38](e[50],...f)}return{key:o,first:null,c(){t=$("div"),j(n.$$.fragment),p(t,"class","card svelte-1tx1vzt"),p(t,"role","button"),p(t,"tabindex","0"),p(t,"aria-pressed",i=e[5].selectedRoles.includes(e[50].id)),Oe(t,"selected",e[5].selectedRoles.includes(e[50].id)),this.first=t},m(f,u){_(f,t,u),G(n,t,null),r=!0,l||(a=[ee(t,"click",s),ee(t,"keydown",c)],l=!0)},p(f,u){e=f;const d={};u[0]&262144&&(d.role=e[50]),u[0]&64&&(d.size=e[6]?"normal":en),u[0]&262144&&(d.alignment=e[50].defaultAlignment),n.$set(d),(!r||u[0]&262176&&i!==(i=e[5].selectedRoles.includes(e[50].id)))&&p(t,"aria-pressed",i),(!r||u[0]&262176)&&Oe(t,"selected",e[5].selectedRoles.includes(e[50].id))},i(f){r||(y(n.$$.fragment,f),r=!0)},o(f){N(n.$$.fragment,f),r=!1},d(f){f&&g(t),F(n),l=!1,$e(a)}}}function Pr(o){let e,t=o[46]+"",n,i,r=o[47].some(Fr),l,a=o[47].some(Gr),s,c,f=r&&Cr(o),u=a&&Lr(o);return{c(){e=$("h3"),n=C(t),i=D(),f&&f.c(),l=D(),u&&u.c(),s=de(),p(e,"class","section-header svelte-1tx1vzt")},m(d,h){_(d,e,h),b(e,n),_(d,i,h),f&&f.m(d,h),_(d,l,h),u&&u.m(d,h),_(d,s,h),c=!0},p(d,h){(!c||h[0]&262144)&&t!==(t=d[46]+"")&&J(n,t),h[0]&262144&&(r=d[47].some(Fr)),r?f?(f.p(d,h),h[0]&262144&&y(f,1)):(f=Cr(d),f.c(),y(f,1),f.m(l.parentNode,l)):f&&(ne(),N(f,1,1,()=>{f=null}),oe()),h[0]&262144&&(a=d[47].some(Gr)),a?u?(u.p(d,h),h[0]&262144&&y(u,1)):(u=Lr(d),u.c(),y(u,1),u.m(s.parentNode,s)):u&&(ne(),N(u,1,1,()=>{u=null}),oe())},i(d){c||(y(f),y(u),c=!0)},o(d){N(f),N(u),c=!1},d(d){d&&(g(e),g(i),g(l),g(s)),f&&f.d(d),u&&u.d(d)}}}function Br(o){var d,h;let e,t,n,i=((d=o[11])==null?void 0:d.text)+"",r,l,a,s=((h=o[11])==null?void 0:h.description)+"",c,f,u;return{c(){e=$("div"),t=$("div"),n=$("strong"),r=C(i),l=D(),a=$("p"),c=C(s),p(a,"class","svelte-1tx1vzt"),p(t,"tabindex","0"),p(t,"role","button"),p(e,"class","context-menu svelte-1tx1vzt"),p(e,"role","dialog"),p(e,"aria-modal","true"),ce(e,"top",o[10]+"px"),ce(e,"left",o[9]+"px")},m(m,k){_(m,e,k),b(e,t),b(t,n),b(n,r),b(t,l),b(t,a),b(a,c),f||(u=[ee(t,"click",Tt(o[32])),ee(t,"keydown",Xh)],f=!0)},p(m,k){var w,O;k[0]&2048&&i!==(i=((w=m[11])==null?void 0:w.text)+"")&&J(r,i),k[0]&2048&&s!==(s=((O=m[11])==null?void 0:O.description)+"")&&J(c,s),k[0]&1024&&ce(e,"top",m[10]+"px"),k[0]&512&&ce(e,"left",m[9]+"px")},d(m){m&&g(e),f=!1,$e(u)}}}function Gh(o){let e,t,n,i,r,l;const a=[Hh,Yh],s=[];function c(u,d){return u[13]?0:1}t=c(o),n=s[t]=a[t](o);let f=o[8]&&!o[13]&&Br(o);return{c(){e=$("div"),n.c(),i=D(),f&&f.c(),r=de()},m(u,d){_(u,e,d),s[t].m(e,null),_(u,i,d),f&&f.m(u,d),_(u,r,d),l=!0},p(u,d){let h=t;t=c(u),t===h?s[t].p(u,d):(ne(),N(s[h],1,1,()=>{s[h]=null}),oe(),n=s[t],n?n.p(u,d):(n=s[t]=a[t](u),n.c()),y(n,1),n.m(e,null)),u[8]&&!u[13]?f?f.p(u,d):(f=Br(u),f.c(),f.m(r.parentNode,r)):f&&(f.d(1),f=null)},i(u){l||(y(n),l=!0)},o(u){N(n),l=!1},d(u){u&&(g(e),g(i),g(r)),s[t].d(),f&&f.d(u)}}}function Yr(o){let e,t,n,i,r;return{c(){e=$("label"),t=$("input"),n=C(`
        Show “IN PLAY” labels`),p(t,"type","checkbox")},m(l,a){_(l,e,a),b(e,t),t.checked=o[7],b(e,n),i||(r=ee(t,"change",o[34]),i=!0)},p(l,a){a[0]&128&&(t.checked=l[7])},d(l){l&&g(e),i=!1,r()}}}function Fh(o){let e,t,n,i,r,l,a,s=o[12]&&Yr(o);return{c(){e=$("label"),t=$("input"),n=C(`
      Grid View`),i=D(),s&&s.c(),r=de(),p(t,"type","checkbox")},m(c,f){_(c,e,f),b(e,t),t.checked=o[6],b(e,n),_(c,i,f),s&&s.m(c,f),_(c,r,f),l||(a=ee(t,"change",o[33]),l=!0)},p(c,f){f[0]&64&&(t.checked=c[6]),c[12]?s?s.p(c,f):(s=Yr(c),s.c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d(c){c&&(g(e),g(i),g(r)),s&&s.d(c),l=!1,a()}}}function Hr(o){let e,t;return e=new Z({props:{$$slots:{default:[jh]},$$scope:{ctx:o}}}),e.$on("click",o[26]),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i[2]&1&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function jh(o){let e;return{c(){e=C("Highlight Random")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function zh(o){let e;return{c(){e=C("Add Selected")},m(t,n){_(t,e,n)},p:te,d(t){t&&g(e)}}}function Kh(o){let e,t=o[5].selectedRoles.length+"",n,i,r=o[5].selectedRoles.length!==1?"s":"",l;return{c(){e=C("Add "),n=C(t),i=C(` Traveller
        `),l=C(r)},m(a,s){_(a,e,s),_(a,n,s),_(a,i,s),_(a,l,s)},p(a,s){s[0]&32&&t!==(t=a[5].selectedRoles.length+"")&&J(n,t),s[0]&32&&r!==(r=a[5].selectedRoles.length!==1?"s":"")&&J(l,r)},d(a){a&&(g(e),g(n),g(i),g(l))}}}function Wh(o){let e;function t(r,l){return r[13]?Kh:zh}let n=t(o),i=n(o);return{c(){i.c(),e=de()},m(r,l){i.m(r,l),_(r,e,l)},p(r,l){n===(n=t(r))&&i?i.p(r,l):(i.d(1),i=n(r),i&&(i.c(),i.m(e.parentNode,e)))},d(r){r&&g(e),i.d(r)}}}function qh(o){let e,t,n,i=o[14]&&Hr(o);return t=new Z({props:{disabled:o[5].selectedRoles.length===0,$$slots:{default:[Wh]},$$scope:{ctx:o}}}),t.$on("click",o[25]),{c(){i&&i.c(),e=D(),j(t.$$.fragment)},m(r,l){i&&i.m(r,l),_(r,e,l),G(t,r,l),n=!0},p(r,l){r[14]?i?(i.p(r,l),l[0]&16384&&y(i,1)):(i=Hr(r),i.c(),y(i,1),i.m(e.parentNode,e)):i&&(ne(),N(i,1,1,()=>{i=null}),oe());const a={};l[0]&32&&(a.disabled=r[5].selectedRoles.length===0),l[0]&8224|l[2]&1&&(a.$$scope={dirty:l,ctx:r}),t.$set(a)},i(r){n||(y(i),y(t.$$.fragment,r),n=!0)},o(r){N(i),N(t.$$.fragment,r),n=!1},d(r){r&&g(e),i&&i.d(r),F(t,r)}}}function Vh(o){let e,t;return e=new De({props:{show:o[5].showRoleSelectionModal,title:"Select Roles",onClose:o[43],$$slots:{footer:[qh],"footer-left":[Fh],default:[Gh]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i[0]&32&&(r.show=n[5].showRoleSelectionModal),i[0]&4096&&(r.onClose=n[43]),i[0]&524287|i[2]&1&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}const en="cell",Gr=o=>o.sourceRoleType==="fabled",Fr=o=>o.sourceRoleType==="traveller",jr=o=>o.sourceRoleType==="traveller",zr=o=>o.sourceRoleType==="fabled",Xh=o=>(o.key==="Enter"||o.key===" ")&&o.stopPropagation();function Jh(o,e,t){let n,i,r,l,a,s,c,f,u,d,h,m,k,w,O,I,T,E;se(o,ae,Q=>t(29,w=Q)),se(o,q,Q=>t(5,O=Q)),se(o,Re,Q=>t(30,I=Q)),se(o,kn,Q=>t(44,T=Q)),se(o,bn,Q=>t(31,E=Q));function R(Q){const fe=T.find(ie=>ie.roleId===Q);return(fe==null?void 0:fe.how_to_run)??[]}let H=!1;const A=["Townsfolk","Outsider","Minion","Demon"],M={Townsfolk:"Townsfolk",Outsider:"Outsiders",Minion:"Minions",Demon:"Demons"};let{script:U=[]}=e,v=!0;function Y(Q){q.update(fe=>{const ie=[...fe.selectedRoles],pe=ie.indexOf(Q);return pe===-1?ie.push(Q):ie.splice(pe,1),{...fe,selectedRoles:ie}})}function W(Q){const fe=Q.abilityDescription.includes("["),ie=R(Q.id);return fe||ie.some(pe=>pe.toLowerCase().includes("before putting character tokens in the bag"))}let z=!1,B=0,L=0,S=null;function P(Q,fe){Q.preventDefault();const ie=Qt[fe]??{};t(11,S={text:ie.text??"(no text)",description:ie.description??""}),t(8,z=!0),t(9,B=Q.clientX),t(10,L=Q.clientY)}function K(){t(8,z=!1)}mt(()=>(window.addEventListener("click",K),()=>window.removeEventListener("click",K)));function V(){const Q=O;if(a||c)[...Q.selectedRoles].sort(()=>Math.random()-.5).forEach(ie=>{nu(ie)}),so();else if(s&&Q.currentCard){const fe=re(Re),ie=Q.selectedRoles.map(pe=>fe[pe]).filter(pe=>!!pe);q.update(pe=>({...pe,currentCard:{...pe.currentCard,roles:ie}}))}q.update(fe=>({...fe,showRoleSelectionModal:!1,selectedRoles:[]}))}function le(){var kt;const Q=re(Re),fe=hn(u),ie={Townsfolk:"Townsfolk",Outsider:"Outsiders",Minion:"Minions",Demon:"Demons"},pe=new Set(w.playerTokens.map(Ce=>Ce.roleId)),xe={...fe};for(const Ce of pe){const Ge=(kt=Q[Ce])==null?void 0:kt.category;if(Ge){const nt=ie[Ge];xe[nt]>0&&xe[nt]--}}const Se=(Ce,Ge)=>Object.values(Q).filter(Ye=>Ye.category===Ce&&!pe.has(Ye.id)&&r.has(Ye.id)).map(Ye=>Ye.id).sort(()=>Math.random()-.5).slice(0,Ge),We=[];for(const[Ce,Ge]of Object.entries(ie)){const nt=Math.max(0,xe[Ge]);nt>0&&We.push(...Se(Ce,nt))}q.update(Ce=>({...Ce,selectedRoles:We}))}function he(Q){dn.call(this,o,Q)}function _e(){H=this.checked,t(6,H)}function Ie(){v=this.checked,t(7,v)}const rt=Q=>Y(Q.id),Xe=(Q,fe)=>(fe.key==="Enter"||fe.key===" ")&&Y(Q.id),tt=Q=>Y(Q.id),pt=(Q,fe)=>(fe.key==="Enter"||fe.key===" ")&&Y(Q.id),Be=(Q,fe)=>fe.category===Q&&r.has(fe.id),Je=Q=>{a&&l.includes(Q.id)||Y(Q.id)},Ze=(Q,fe)=>{a&&l.includes(Q.id)||(fe.key==="Enter"||fe.key===" ")&&Y(Q.id)},Qe=(Q,fe)=>P(fe,Q.id),ue=()=>{s?V():q.update(Q=>({...Q,showRoleSelectionModal:!1,selectedRoles:[]}))};return o.$$set=Q=>{"script"in Q&&t(27,U=Q.script)},o.$$.update=()=>{o.$$.dirty[1]&1&&t(28,n=E.filter(Q=>Q.type==="traveller"||Q.type==="fabled")),o.$$.dirty[0]&268435456&&t(18,i=(()=>{const Q=new Map;for(const fe of n){const ie=En[fe.id];if(!ie)continue;const pe={...ie,sourceRoleType:fe.type};(Q.get(fe.edition||"Unknown")||Q.set(fe.edition||"Unknown",[]).get(fe.edition||"Unknown")).push(pe)}return Array.from(Q,([fe,ie])=>({version:fe,roles:ie})).sort((fe,ie)=>fe.version.localeCompare(ie.version))})()),o.$$.dirty[0]&134217728&&t(0,r=new Set(U.filter(Q=>typeof Q=="string"))),o.$$.dirty[0]&536870912&&t(4,l=w.playerTokens.map(Q=>Q.roleId)),o.$$.dirty[0]&32&&t(14,a=O.roleSelectionContext==="setup"),o.$$.dirty[0]&32&&t(12,s=O.roleSelectionContext==="card"),o.$$.dirty[0]&32&&t(13,c=O.roleSelectionContext==="travellers"),o.$$.dirty[0]&1073741824&&t(2,f=I),o.$$.dirty[0]&536870912&&t(1,u=w.basePlayersCount),o.$$.dirty[0]&2&&t(17,d=hn(u)),o.$$.dirty[0]&52&&t(3,h=A.reduce((Q,fe)=>{const ie=O.selectedRoles.filter(xe=>{var Se;return((Se=f[xe])==null?void 0:Se.category)===fe}).length,pe=l.filter(xe=>{var Se;return((Se=f[xe])==null?void 0:Se.category)===fe}).length;return Q[fe]=ie+pe,Q},{})),o.$$.dirty[0]&8&&t(16,m=A.map(Q=>h[Q]).reduce((Q,fe)=>Q+fe,0)),o.$$.dirty[0]&5&&t(15,k=Object.values(f).filter(Q=>r.has(Q.id)&&W(Q)))},[r,u,f,h,l,O,H,v,z,B,L,S,s,c,a,k,m,d,i,R,A,M,Y,W,P,V,le,U,n,w,I,E,he,_e,Ie,rt,Xe,tt,pt,Be,Je,Ze,Qe,ue]}class Zh extends ye{constructor(e){super(),we(this,e,Jh,Vh,ke,{script:27},null,[-1,-1,-1])}}function Kr(o,e,t){const n=o.slice();return n[31]=e[t],n}function Wr(o,e,t){const n=o.slice();return n[34]=e[t][0],n[35]=e[t][1],n}function qr(o,e,t){const n=o.slice();return n[38]=e[t],n}function Vr(o,e,t){const n=o.slice();return n[34]=e[t][0],n[35]=e[t][1],n}function Xr(o,e,t){const n=o.slice();return n[38]=e[t],n}function Jr(o,e,t){const n=o.slice();return n[45]=e[t],n}function Zr(o){var c;let e,t=o[45].playerName+"",n,i,r=(((c=o[1][o[45].roleId])==null?void 0:c.name)??o[45].roleId)+"",l,a,s;return{c(){e=$("option"),n=C(t),i=C(" ("),l=C(r),a=C(`)
        `),e.__value=s=o[45].id,Ne(e,e.__value)},m(f,u){_(f,e,u),b(e,n),b(e,i),b(e,l),b(e,a)},p(f,u){var d;u[0]&4&&t!==(t=f[45].playerName+"")&&J(n,t),u[0]&6&&r!==(r=(((d=f[1][f[45].roleId])==null?void 0:d.name)??f[45].roleId)+"")&&J(l,r),u[0]&4&&s!==(s=f[45].id)&&(e.__value=s,Ne(e,e.__value))},d(f){f&&g(e)}}}function Qh(o){let e;return{c(){e=$("em"),e.textContent="None of these roles are in play"},m(t,n){_(t,e,n)},p:te,d(t){t&&g(e)}}}function xh(o){let e,t=X(Object.entries(o[8])),n=[];for(let i=0;i<t.length;i+=1)n[i]=xr(Vr(o,t,i));return{c(){e=$("div");for(let i=0;i<n.length;i+=1)n[i].c();p(e,"class","tiles svelte-1cr6plv")},m(i,r){_(i,e,r);for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(e,null)},p(i,r){if(r[0]&1298){t=X(Object.entries(i[8]));let l;for(l=0;l<t.length;l+=1){const a=Vr(i,t,l);n[l]?n[l].p(a,r):(n[l]=xr(a),n[l].c(),n[l].m(e,null))}for(;l<n.length;l+=1)n[l].d(1);n.length=t.length}},d(i){i&&g(e),me(n,i)}}}function Qr(o){let e,t=o[4][o[38]].text+"",n,i,r,l,a,s;function c(){return o[18](o[38])}function f(...u){return o[19](o[38],...u)}return{c(){e=$("div"),n=C(t),i=D(),p(e,"class","reminder svelte-1cr6plv"),p(e,"role","button"),p(e,"tabindex","0"),p(e,"aria-label",r=`Add reminder: ${o[4][o[38]].text}`),p(e,"title",l=o[4][o[38]].description)},m(u,d){_(u,e,d),b(e,n),b(e,i),a||(s=[ee(e,"click",c),ee(e,"keydown",f)],a=!0)},p(u,d){o=u,d[0]&272&&t!==(t=o[4][o[38]].text+"")&&J(n,t),d[0]&272&&r!==(r=`Add reminder: ${o[4][o[38]].text}`)&&p(e,"aria-label",r),d[0]&272&&l!==(l=o[4][o[38]].description)&&p(e,"title",l)},d(u){u&&g(e),a=!1,$e(s)}}}function xr(o){var f;let e,t,n=(((f=o[1][o[34]])==null?void 0:f.name)??o[34])+"",i,r,l,a,s=X(o[35]),c=[];for(let u=0;u<s.length;u+=1)c[u]=Qr(Xr(o,s,u));return{c(){e=$("div"),t=$("div"),i=C(n),r=D(),l=$("div");for(let u=0;u<c.length;u+=1)c[u].c();a=D(),p(t,"class","role-name svelte-1cr6plv"),p(l,"class","tile-tokens svelte-1cr6plv"),p(e,"class","tile svelte-1cr6plv")},m(u,d){_(u,e,d),b(e,t),b(t,i),b(e,r),b(e,l);for(let h=0;h<c.length;h+=1)c[h]&&c[h].m(l,null);b(e,a)},p(u,d){var h;if(d[0]&258&&n!==(n=(((h=u[1][u[34]])==null?void 0:h.name)??u[34])+"")&&J(i,n),d[0]&1296){s=X(u[35]);let m;for(m=0;m<s.length;m+=1){const k=Xr(u,s,m);c[m]?c[m].p(k,d):(c[m]=Qr(k),c[m].c(),c[m].m(l,null))}for(;m<c.length;m+=1)c[m].d(1);c.length=s.length}},d(u){u&&g(e),me(c,u)}}}function el(o){let e,t=o[4][o[38]].text+"",n,i,r,l,a,s;function c(){return o[20](o[38])}function f(...u){return o[21](o[38],...u)}return{c(){e=$("div"),n=C(t),i=D(),p(e,"class","reminder svelte-1cr6plv"),p(e,"role","button"),p(e,"tabindex","0"),p(e,"aria-label",r=`Add reminder: ${o[4][o[38]].text}`),p(e,"title",l=o[4][o[38]].description)},m(u,d){_(u,e,d),b(e,n),b(e,i),a||(s=[ee(e,"click",c),ee(e,"keydown",f)],a=!0)},p(u,d){o=u,d[0]&144&&t!==(t=o[4][o[38]].text+"")&&J(n,t),d[0]&144&&r!==(r=`Add reminder: ${o[4][o[38]].text}`)&&p(e,"aria-label",r),d[0]&144&&l!==(l=o[4][o[38]].description)&&p(e,"title",l)},d(u){u&&g(e),a=!1,$e(s)}}}function tl(o){var f;let e,t,n=(((f=o[1][o[34]])==null?void 0:f.name)??o[34])+"",i,r,l,a,s=X(o[35]),c=[];for(let u=0;u<s.length;u+=1)c[u]=el(qr(o,s,u));return{c(){e=$("div"),t=$("div"),i=C(n),r=D(),l=$("div");for(let u=0;u<c.length;u+=1)c[u].c();a=D(),p(t,"class","role-name svelte-1cr6plv"),p(l,"class","tile-tokens svelte-1cr6plv"),p(e,"class","tile svelte-1cr6plv")},m(u,d){_(u,e,d),b(e,t),b(t,i),b(e,r),b(e,l);for(let h=0;h<c.length;h+=1)c[h]&&c[h].m(l,null);b(e,a)},p(u,d){var h;if(d[0]&130&&n!==(n=(((h=u[1][u[34]])==null?void 0:h.name)??u[34])+"")&&J(i,n),d[0]&1168){s=X(u[35]);let m;for(m=0;m<s.length;m+=1){const k=qr(u,s,m);c[m]?c[m].p(k,d):(c[m]=el(k),c[m].c(),c[m].m(l,null))}for(;m<c.length;m+=1)c[m].d(1);c.length=s.length}},d(u){u&&g(e),me(c,u)}}}function em(o){let e,t,n,i,r,l,a,s,c,f,u;return l=new Z({props:{disabled:!o[6].trim(),$$slots:{default:[nm]},$$scope:{ctx:o}}}),l.$on("click",o[27]),s=new Z({props:{type:"cancel",$$slots:{default:[om]},$$scope:{ctx:o}}}),s.$on("click",o[28]),{c(){e=$("div"),t=$("label"),t.textContent="Custom reminder text",n=D(),i=$("input"),r=D(),j(l.$$.fragment),a=D(),j(s.$$.fragment),p(t,"for","customReminder"),p(t,"class","sr-only"),p(i,"id","customReminder"),p(i,"type","text"),p(i,"placeholder","Enter reminder text…"),p(i,"class","svelte-1cr6plv"),p(e,"class","custom-form svelte-1cr6plv")},m(d,h){_(d,e,h),b(e,t),b(e,n),b(e,i),Ne(i,o[6]),b(e,r),G(l,e,null),b(e,a),G(s,e,null),c=!0,f||(u=ee(i,"input",o[26]),f=!0)},p(d,h){h[0]&64&&i.value!==d[6]&&Ne(i,d[6]);const m={};h[0]&64&&(m.disabled=!d[6].trim()),h[1]&131072&&(m.$$scope={dirty:h,ctx:d}),l.$set(m);const k={};h[1]&131072&&(k.$$scope={dirty:h,ctx:d}),s.$set(k)},i(d){c||(y(l.$$.fragment,d),y(s.$$.fragment,d),c=!0)},o(d){N(l.$$.fragment,d),N(s.$$.fragment,d),c=!1},d(d){d&&g(e),F(l),F(s),f=!1,u()}}}function tm(o){let e,t,n,i,r,l=X(["MISREGISTER","CLAIM","DIED BY","PROTECTED"]),a=[];for(let s=0;s<4;s+=1)a[s]=nl(Kr(o,l,s));return{c(){e=$("div"),t=$("div"),t.textContent="+",n=D();for(let s=0;s<4;s+=1)a[s].c();p(t,"class","reminder svelte-1cr6plv"),p(t,"role","button"),p(t,"tabindex","0"),p(t,"aria-label","Add a custom reminder"),p(t,"title","Add a custom reminder"),p(e,"class","tiles custom-new svelte-1cr6plv")},m(s,c){_(s,e,c),b(e,t),b(e,n);for(let f=0;f<4;f+=1)a[f]&&a[f].m(e,null);i||(r=[ee(t,"click",o[22]),ee(t,"keydown",o[23])],i=!0)},p(s,c){if(c[0]&1024){l=X(["MISREGISTER","CLAIM","DIED BY","PROTECTED"]);let f;for(f=0;f<4;f+=1){const u=Kr(s,l,f);a[f]?a[f].p(u,c):(a[f]=nl(u),a[f].c(),a[f].m(e,null))}for(;f<4;f+=1)a[f].d(1)}},i:te,o:te,d(s){s&&g(e),me(a,s),i=!1,$e(r)}}}function nm(o){let e;return{c(){e=C("Add")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function om(o){let e;return{c(){e=C("Cancel")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function nl(o){let e,t,n;function i(){return o[24](o[31])}function r(...l){return o[25](o[31],...l)}return{c(){e=$("div"),e.textContent=`${o[31]} `,p(e,"class","reminder svelte-1cr6plv"),p(e,"role","button"),p(e,"tabindex","0"),p(e,"aria-label",`Add custom reminder: ${o[31]}`),p(e,"title",`Add "${o[31]}"`)},m(l,a){_(l,e,a),t||(n=[ee(e,"click",i),ee(e,"keydown",r)],t=!0)},p(l,a){o=l},d(l){l&&g(e),t=!1,$e(n)}}}function im(o){let e,t,n,i,r,l,a,s,c,f,u,d,h,m,k,w,O,I,T,E,R,H=X(o[2].playerTokens),A=[];for(let S=0;S<H.length;S+=1)A[S]=Zr(Jr(o,H,S));function M(S,P){return P[0]&256&&(s=null),s==null&&(s=!!Object.keys(S[8]).length),s?xh:Qh}let U=M(o,[-1,-1]),v=U(o),Y=X(Object.entries(o[7])),W=[];for(let S=0;S<Y.length;S+=1)W[S]=tl(Wr(o,Y,S));const z=[tm,em],B=[];function L(S,P){return S[5]?1:0}return w=L(o),O=B[w]=z[w](o),{c(){e=$("div"),t=$("label"),t.textContent="Pick player:",n=D(),i=$("select");for(let S=0;S<A.length;S+=1)A[S].c();r=D(),l=$("h3"),l.textContent="Reminders for roles in play",a=D(),v.c(),c=D(),f=$("h3"),f.textContent="Other reminders",u=D(),d=$("div");for(let S=0;S<W.length;S+=1)W[S].c();h=D(),m=$("h3"),m.textContent="Custom reminder",k=D(),O.c(),I=de(),p(t,"for","player-select"),p(t,"class","svelte-1cr6plv"),p(i,"id","player-select"),p(i,"class","svelte-1cr6plv"),o[0]===void 0&&Zt(()=>o[17].call(i)),p(e,"class","picker svelte-1cr6plv"),p(l,"class","svelte-1cr6plv"),ce(f,"margin-top","1em"),p(f,"class","svelte-1cr6plv"),p(d,"class","tiles svelte-1cr6plv"),ce(m,"margin-top","1em"),p(m,"class","svelte-1cr6plv")},m(S,P){_(S,e,P),b(e,t),b(e,n),b(e,i);for(let K=0;K<A.length;K+=1)A[K]&&A[K].m(i,null);dt(i,o[0],!0),_(S,r,P),_(S,l,P),_(S,a,P),v.m(S,P),_(S,c,P),_(S,f,P),_(S,u,P),_(S,d,P);for(let K=0;K<W.length;K+=1)W[K]&&W[K].m(d,null);_(S,h,P),_(S,m,P),_(S,k,P),B[w].m(S,P),_(S,I,P),T=!0,E||(R=ee(i,"change",o[17]),E=!0)},p(S,P){if(P[0]&6){H=X(S[2].playerTokens);let V;for(V=0;V<H.length;V+=1){const le=Jr(S,H,V);A[V]?A[V].p(le,P):(A[V]=Zr(le),A[V].c(),A[V].m(i,null))}for(;V<A.length;V+=1)A[V].d(1);A.length=H.length}if(P[0]&5&&dt(i,S[0]),U===(U=M(S,P))&&v?v.p(S,P):(v.d(1),v=U(S),v&&(v.c(),v.m(c.parentNode,c))),P[0]&1170){Y=X(Object.entries(S[7]));let V;for(V=0;V<Y.length;V+=1){const le=Wr(S,Y,V);W[V]?W[V].p(le,P):(W[V]=tl(le),W[V].c(),W[V].m(d,null))}for(;V<W.length;V+=1)W[V].d(1);W.length=Y.length}let K=w;w=L(S),w===K?B[w].p(S,P):(ne(),N(B[K],1,1,()=>{B[K]=null}),oe(),O=B[w],O?O.p(S,P):(O=B[w]=z[w](S),O.c()),y(O,1),O.m(I.parentNode,I))},i(S){T||(y(O),T=!0)},o(S){N(O),T=!1},d(S){S&&(g(e),g(r),g(l),g(a),g(c),g(f),g(u),g(d),g(h),g(m),g(k),g(I)),me(A,S),v.d(S),me(W,S),B[w].d(S),E=!1,R()}}}function rm(o){let e;return{c(){e=C("Close")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function lm(o){let e,t;return e=new Z({props:{$$slots:{default:[rm]},$$scope:{ctx:o}}}),e.$on("click",o[11]),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i[1]&131072&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function sm(o){let e,t;return e=new De({props:{show:o[3].showAddReminderModal,onClose:o[11],title:"Add Reminders",$$slots:{footer:[lm],default:[im]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i[0]&8&&(r.show=n[3].showAddReminderModal),i[0]&503|i[1]&131072&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function ol(o){return o.reduce((e,t)=>{const[n]=t.split(".");return e[n]||(e[n]=[]),e[n].push(t),e},{})}function am(o,e,t){let n,i,r,l,a,s,c,f,u,d,h;se(o,ae,K=>t(2,f=K)),se(o,q,K=>t(3,u=K)),se(o,Re,K=>t(16,h=K));const m=Me(ae,K=>new Set(K.script.roles)),k=Me(m,K=>Object.fromEntries(Object.entries(Qt).filter(([V])=>{const le=V.split(".")[0];return K.has(le)})));se(o,k,K=>t(4,d=K));const w=new Set;let O=null,I=!1,T="";function E(K,V){if(O===null){alert("Please select a player first.");return}Yn({reminderId:K,ownerId:O,attachedToId:O,customText:(V==null?void 0:V.trim())||void 0}),V&&(t(6,T=""),t(5,I=!1)),q.update(_e=>({..._e,showAddReminderModal:!1,addingReminderAttachedTo:null}))}function R(){q.update(K=>({...K,showAddReminderModal:!1,addingReminderAttachedTo:null}))}function H(){O=to(this),t(0,O),t(3,u),t(2,f)}const A=K=>E(K),M=(K,V)=>(V.key==="Enter"||V.key===" ")&&E(K),U=K=>E(K),v=(K,V)=>(V.key==="Enter"||V.key===" ")&&E(K),Y=()=>t(5,I=!0),W=K=>(K.key==="Enter"||K.key===" ")&&t(5,I=!0),z=K=>E("custom",K),B=(K,V)=>(V.key==="Enter"||V.key===" ")&&E("custom",K);function L(){T=this.value,t(6,T)}const S=()=>E("custom",T.trim()),P=()=>{t(5,I=!1),t(6,T="")};return o.$$.update=()=>{o.$$.dirty[0]&65536&&t(1,n=h),o.$$.dirty[0]&4&&t(15,i=f.playerTokens.map(K=>K.roleId)),o.$$.dirty[0]&32770&&(w.clear(),i.forEach(K=>{var V,le;(le=(V=n[K])==null?void 0:V.associatedReminders)==null||le.forEach(he=>w.add(he))})),o.$$.dirty[0]&16&&t(14,r=Object.keys(d)),o.$$.dirty[0]&16384&&t(13,l=r.filter(K=>w.has(K))),o.$$.dirty[0]&16384&&t(12,a=r.filter(K=>!w.has(K))),o.$$.dirty[0]&8192&&t(8,s=ol(l)),o.$$.dirty[0]&4096&&t(7,c=ol(a)),o.$$.dirty[0]&13&&(u.addingReminderAttachedTo!==null?t(0,O=u.addingReminderAttachedTo):f.playerTokens.length&&O===null&&t(0,O=f.playerTokens[0].id))},[O,n,f,u,d,I,T,c,s,k,E,R,a,l,r,i,h,H,A,M,U,v,Y,W,z,B,L,S,P]}class cm extends ye{constructor(e){super(),we(this,e,am,sm,ke,{},null,[-1,-1])}}function il(o,e,t){const n=o.slice();return n[16]=e[t],n}function rl(o,e,t){const n=o.slice();return n[19]=e[t],n}function ll(o,e,t){const n=o.slice();return n[22]=e[t],n}function sl(o,e,t){const n=o.slice();return n[22]=e[t],n}function al(o,e,t){const n=o.slice();return n[22]=e[t],n}function cl(o,e,t){const n=o.slice();return n[22]=e[t],n}function fl(o,e,t){const n=o.slice();return n[22]=e[t],n}function ul(o,e,t){const n=o.slice();return n[22]=e[t],n}function dl(o,e,t){const n=o.slice();return n[35]=e[t],n}function hl(o,e,t){const n=o.slice();return n[38]=e[t],n}function ml(o,e,t){const n=o.slice();return n[41]=e[t],n}function pl(o,e,t){const n=o.slice();return n[44]=e[t],n}function gl(o,e,t){const n=o.slice();return n[47]=e[t],n}function _l(o,e,t){const n=o.slice();return n[16]=e[t],n}function bl(o){let e,t=o[16].name+"",n,i;return{c(){e=$("option"),n=C(t),e.__value=i=o[16].id,Ne(e,e.__value)},m(r,l){_(r,e,l),b(e,n)},p(r,l){l[0]&8&&t!==(t=r[16].name+"")&&J(n,t),l[0]&8&&i!==(i=r[16].id)&&(e.__value=i,Ne(e,e.__value))},d(r){r&&g(e)}}}function kl(o){let e,t,n,i;return{c(){e=$("div"),t=$("img"),Jt(t.src,n=o[16].iconUrl)||p(t,"src",n),p(t,"alt",i=o[16].name+" icon"),p(t,"class","svelte-11sp4jv"),p(e,"class","role-icon svelte-11sp4jv")},m(r,l){_(r,e,l),b(e,t)},p(r,l){l[0]&8&&!Jt(t.src,n=r[16].iconUrl)&&p(t,"src",n),l[0]&8&&i!==(i=r[16].name+" icon")&&p(t,"alt",i)},d(r){r&&g(e)}}}function wl(o){let e,t=o[16].flavour_text+"",n;return{c(){e=$("p"),n=C(t),p(e,"class","flavour-text svelte-11sp4jv")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r[0]&8&&t!==(t=i[16].flavour_text+"")&&J(n,t)},d(i){i&&g(e)}}}function yl(o){let e,t=o[16].details+"",n;return{c(){e=$("p"),n=C(t),p(e,"class","svelte-11sp4jv")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r[0]&8&&t!==(t=i[16].details+"")&&J(n,t)},d(i){i&&g(e)}}}function $l(o){let e,t=X(o[16].bullets),n=[];for(let i=0;i<t.length;i+=1)n[i]=Nl(pl(o,t,i));return{c(){e=$("ul");for(let i=0;i<n.length;i+=1)n[i].c();p(e,"class","svelte-11sp4jv")},m(i,r){_(i,e,r);for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(e,null)},p(i,r){if(r[0]&8){t=X(i[16].bullets);let l;for(l=0;l<t.length;l+=1){const a=pl(i,t,l);n[l]?n[l].p(a,r):(n[l]=Nl(a),n[l].c(),n[l].m(e,null))}for(;l<n.length;l+=1)n[l].d(1);n.length=t.length}},d(i){i&&g(e),me(n,i)}}}function vl(o){let e,t=o[47].text+"",n;return{c(){e=$("li"),n=C(t),p(e,"class","svelte-11sp4jv")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r[0]&8&&t!==(t=i[47].text+"")&&J(n,t)},d(i){i&&g(e)}}}function Nl(o){let e,t=X(o[44]),n=[];for(let i=0;i<t.length;i+=1)n[i]=vl(gl(o,t,i));return{c(){for(let i=0;i<n.length;i+=1)n[i].c();e=de()},m(i,r){for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(i,r);_(i,e,r)},p(i,r){if(r[0]&8){t=X(i[44]);let l;for(l=0;l<t.length;l+=1){const a=gl(i,t,l);n[l]?n[l].p(a,r):(n[l]=vl(a),n[l].c(),n[l].m(e.parentNode,e))}for(;l<n.length;l+=1)n[l].d(1);n.length=t.length}},d(i){i&&g(e),me(n,i)}}}function Il(o){let e,t,n,i=X(o[16].examples),r=[];for(let l=0;l<i.length;l+=1)r[l]=Ol(ml(o,i,l));return{c(){e=$("h3"),e.textContent="EXAMPLES",t=D();for(let l=0;l<r.length;l+=1)r[l].c();n=de(),p(e,"class","centered-header svelte-11sp4jv")},m(l,a){_(l,e,a),_(l,t,a);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(l,a);_(l,n,a)},p(l,a){if(a[0]&8){i=X(l[16].examples);let s;for(s=0;s<i.length;s+=1){const c=ml(l,i,s);r[s]?r[s].p(c,a):(r[s]=Ol(c),r[s].c(),r[s].m(n.parentNode,n))}for(;s<r.length;s+=1)r[s].d(1);r.length=i.length}},d(l){l&&(g(e),g(t),g(n)),me(r,l)}}}function Ol(o){let e,t=o[41]+"",n;return{c(){e=$("blockquote"),n=C(t),p(e,"class","svelte-11sp4jv")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r[0]&8&&t!==(t=i[41]+"")&&J(n,t)},d(i){i&&g(e)}}}function Rl(o){let e,t,n,i=X(o[16].how_to_run),r=[];for(let l=0;l<i.length;l+=1)r[l]=Tl(hl(o,i,l));return{c(){e=$("h3"),e.textContent="HOW TO RUN",t=D();for(let l=0;l<r.length;l+=1)r[l].c();n=de(),p(e,"class","centered-header svelte-11sp4jv")},m(l,a){_(l,e,a),_(l,t,a);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(l,a);_(l,n,a)},p(l,a){if(a[0]&8){i=X(l[16].how_to_run);let s;for(s=0;s<i.length;s+=1){const c=hl(l,i,s);r[s]?r[s].p(c,a):(r[s]=Tl(c),r[s].c(),r[s].m(n.parentNode,n))}for(;s<r.length;s+=1)r[s].d(1);r.length=i.length}},d(l){l&&(g(e),g(t),g(n)),me(r,l)}}}function Tl(o){let e,t=o[38]+"",n;return{c(){e=$("p"),n=C(t),p(e,"class","svelte-11sp4jv")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r[0]&8&&t!==(t=i[38]+"")&&J(n,t)},d(i){i&&g(e)}}}function El(o){let e,t,n,i=X(o[16].how_to_run_hint),r=[];for(let l=0;l<i.length;l+=1)r[l]=Dl(dl(o,i,l));return{c(){e=$("h4"),e.textContent="HOW TO RUN (EXAMPLES)",t=D(),n=$("ul");for(let l=0;l<r.length;l+=1)r[l].c();p(e,"class","centered-header svelte-11sp4jv"),p(n,"class","svelte-11sp4jv")},m(l,a){_(l,e,a),_(l,t,a),_(l,n,a);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(n,null)},p(l,a){if(a[0]&8){i=X(l[16].how_to_run_hint);let s;for(s=0;s<i.length;s+=1){const c=dl(l,i,s);r[s]?r[s].p(c,a):(r[s]=Dl(c),r[s].c(),r[s].m(n,null))}for(;s<r.length;s+=1)r[s].d(1);r.length=i.length}},d(l){l&&(g(e),g(t),g(n)),me(r,l)}}}function Dl(o){let e,t=o[35]+"",n;return{c(){e=$("li"),n=C(t),p(e,"class","svelte-11sp4jv")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r[0]&8&&t!==(t=i[35]+"")&&J(n,t)},d(i){i&&g(e)}}}function Al(o){let e,t,n,i=X(o[16].tips_and_tricks),r=[];for(let l=0;l<i.length;l+=1)r[l]=Sl(ul(o,i,l));return{c(){e=$("h3"),e.textContent="TIPS & TRICKS",t=D();for(let l=0;l<r.length;l+=1)r[l].c();n=de(),p(e,"class","centered-header svelte-11sp4jv")},m(l,a){_(l,e,a),_(l,t,a);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(l,a);_(l,n,a)},p(l,a){if(a[0]&8){i=X(l[16].tips_and_tricks);let s;for(s=0;s<i.length;s+=1){const c=ul(l,i,s);r[s]?r[s].p(c,a):(r[s]=Sl(c),r[s].c(),r[s].m(n.parentNode,n))}for(;s<r.length;s+=1)r[s].d(1);r.length=i.length}},d(l){l&&(g(e),g(t),g(n)),me(r,l)}}}function Sl(o){let e,t=o[22]+"",n;return{c(){e=$("p"),n=C(t),p(e,"class","svelte-11sp4jv")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r[0]&8&&t!==(t=i[22]+"")&&J(n,t)},d(i){i&&g(e)}}}function Cl(o){let e,t,n=o[16].name.toUpperCase()+"",i,r,l,a=X(o[16].fighting_the),s=[];for(let c=0;c<a.length;c+=1)s[c]=Ml(fl(o,a,c));return{c(){e=$("h3"),t=C("FIGHTING THE "),i=C(n),r=D();for(let c=0;c<s.length;c+=1)s[c].c();l=de(),p(e,"class","centered-header svelte-11sp4jv")},m(c,f){_(c,e,f),b(e,t),b(e,i),_(c,r,f);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(c,f);_(c,l,f)},p(c,f){if(f[0]&8&&n!==(n=c[16].name.toUpperCase()+"")&&J(i,n),f[0]&8){a=X(c[16].fighting_the);let u;for(u=0;u<a.length;u+=1){const d=fl(c,a,u);s[u]?s[u].p(d,f):(s[u]=Ml(d),s[u].c(),s[u].m(l.parentNode,l))}for(;u<s.length;u+=1)s[u].d(1);s.length=a.length}},d(c){c&&(g(e),g(r),g(l)),me(s,c)}}}function Ml(o){let e,t=o[22]+"",n;return{c(){e=$("p"),n=C(t),p(e,"class","svelte-11sp4jv")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r[0]&8&&t!==(t=i[22]+"")&&J(n,t)},d(i){i&&g(e)}}}function Ll(o){let e,t,n=o[16].name.toUpperCase()+"",i,r,l,a=X(o[16].bluffing_as),s=[];for(let c=0;c<a.length;c+=1)s[c]=Ul(cl(o,a,c));return{c(){e=$("h3"),t=C("BLUFFING AS THE "),i=C(n),r=D();for(let c=0;c<s.length;c+=1)s[c].c();l=de(),p(e,"class","centered-header svelte-11sp4jv")},m(c,f){_(c,e,f),b(e,t),b(e,i),_(c,r,f);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(c,f);_(c,l,f)},p(c,f){if(f[0]&8&&n!==(n=c[16].name.toUpperCase()+"")&&J(i,n),f[0]&8){a=X(c[16].bluffing_as);let u;for(u=0;u<a.length;u+=1){const d=cl(c,a,u);s[u]?s[u].p(d,f):(s[u]=Ul(d),s[u].c(),s[u].m(l.parentNode,l))}for(;u<s.length;u+=1)s[u].d(1);s.length=a.length}},d(c){c&&(g(e),g(r),g(l)),me(s,c)}}}function Ul(o){let e,t=o[22]+"",n;return{c(){e=$("p"),n=C(t),p(e,"class","svelte-11sp4jv")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r[0]&8&&t!==(t=i[22]+"")&&J(n,t)},d(i){i&&g(e)}}}function Pl(o){let e,t,n,i=X(o[16].traveller_tips_good),r=[];for(let l=0;l<i.length;l+=1)r[l]=Bl(al(o,i,l));return{c(){e=$("h3"),e.textContent="TRAVELLER TIPS (GOOD)",t=D();for(let l=0;l<r.length;l+=1)r[l].c();n=de(),p(e,"class","centered-header svelte-11sp4jv")},m(l,a){_(l,e,a),_(l,t,a);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(l,a);_(l,n,a)},p(l,a){if(a[0]&8){i=X(l[16].traveller_tips_good);let s;for(s=0;s<i.length;s+=1){const c=al(l,i,s);r[s]?r[s].p(c,a):(r[s]=Bl(c),r[s].c(),r[s].m(n.parentNode,n))}for(;s<r.length;s+=1)r[s].d(1);r.length=i.length}},d(l){l&&(g(e),g(t),g(n)),me(r,l)}}}function Bl(o){let e,t=o[22]+"",n;return{c(){e=$("p"),n=C(t),p(e,"class","svelte-11sp4jv")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r[0]&8&&t!==(t=i[22]+"")&&J(n,t)},d(i){i&&g(e)}}}function Yl(o){let e,t,n,i=X(o[16].traveller_tips_evil),r=[];for(let l=0;l<i.length;l+=1)r[l]=Hl(sl(o,i,l));return{c(){e=$("h3"),e.textContent="TRAVELLER TIPS (EVIL)",t=D();for(let l=0;l<r.length;l+=1)r[l].c();n=de(),p(e,"class","centered-header svelte-11sp4jv")},m(l,a){_(l,e,a),_(l,t,a);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(l,a);_(l,n,a)},p(l,a){if(a[0]&8){i=X(l[16].traveller_tips_evil);let s;for(s=0;s<i.length;s+=1){const c=sl(l,i,s);r[s]?r[s].p(c,a):(r[s]=Hl(c),r[s].c(),r[s].m(n.parentNode,n))}for(;s<r.length;s+=1)r[s].d(1);r.length=i.length}},d(l){l&&(g(e),g(t),g(n)),me(r,l)}}}function Hl(o){let e,t=o[22]+"",n;return{c(){e=$("p"),n=C(t),p(e,"class","svelte-11sp4jv")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r[0]&8&&t!==(t=i[22]+"")&&J(n,t)},d(i){i&&g(e)}}}function Gl(o){let e,t,n,i=X(o[16].fabled_explanation),r=[];for(let l=0;l<i.length;l+=1)r[l]=Fl(ll(o,i,l));return{c(){e=$("h3"),e.textContent="FABLED EXPLANATION",t=D();for(let l=0;l<r.length;l+=1)r[l].c();n=de(),p(e,"class","centered-header svelte-11sp4jv")},m(l,a){_(l,e,a),_(l,t,a);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(l,a);_(l,n,a)},p(l,a){if(a[0]&8){i=X(l[16].fabled_explanation);let s;for(s=0;s<i.length;s+=1){const c=ll(l,i,s);r[s]?r[s].p(c,a):(r[s]=Fl(c),r[s].c(),r[s].m(n.parentNode,n))}for(;s<r.length;s+=1)r[s].d(1);r.length=i.length}},d(l){l&&(g(e),g(t),g(n)),me(r,l)}}}function Fl(o){let e,t=o[22]+"",n;return{c(){e=$("p"),n=C(t),p(e,"class","svelte-11sp4jv")},m(i,r){_(i,e,r),b(e,n)},p(i,r){r[0]&8&&t!==(t=i[22]+"")&&J(n,t)},d(i){i&&g(e)}}}function jl(o){let e,t,n,i=X(o[16].jinxes),r=[];for(let l=0;l<i.length;l+=1)r[l]=zl(rl(o,i,l));return{c(){e=$("h3"),e.textContent="JINXES",t=D(),n=$("dl");for(let l=0;l<r.length;l+=1)r[l].c();p(e,"class","centered-header svelte-11sp4jv"),p(n,"class","svelte-11sp4jv")},m(l,a){_(l,e,a),_(l,t,a),_(l,n,a);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(n,null)},p(l,a){if(a[0]&8){i=X(l[16].jinxes);let s;for(s=0;s<i.length;s+=1){const c=rl(l,i,s);r[s]?r[s].p(c,a):(r[s]=zl(c),r[s].c(),r[s].m(n,null))}for(;s<r.length;s+=1)r[s].d(1);r.length=i.length}},d(l){l&&(g(e),g(t),g(n)),me(r,l)}}}function zl(o){let e,t=o[19].role+"",n,i,r=o[19].description+"",l;return{c(){e=$("dt"),n=C(t),i=$("dd"),l=C(r),p(e,"class","svelte-11sp4jv"),p(i,"class","svelte-11sp4jv")},m(a,s){_(a,e,s),b(e,n),_(a,i,s),b(i,l)},p(a,s){s[0]&8&&t!==(t=a[19].role+"")&&J(n,t),s[0]&8&&r!==(r=a[19].description+"")&&J(l,r)},d(a){a&&(g(e),g(i))}}}function Kl(o){var rt,Xe,tt,pt,Be,Je,Ze,Qe,ue,Q,fe;let e,t,n,i=o[16].name.toUpperCase()+"",r,l,a,s=o[16].ability+"",c,f,u,d,h,m,k,w,O,I,T,E,R,H,A,M,U,v=o[16].iconUrl&&kl(o),Y=o[16].flavour_text&&wl(o),W=o[16].details&&yl(o),z=((rt=o[16].bullets)==null?void 0:rt.length)&&$l(o),B=((Xe=o[16].examples)==null?void 0:Xe.length)&&Il(o),L=((tt=o[16].how_to_run)==null?void 0:tt.length)&&Rl(o),S=((pt=o[16].how_to_run_hint)==null?void 0:pt.length)&&El(o),P=((Be=o[16].tips_and_tricks)==null?void 0:Be.length)&&Al(o),K=((Je=o[16].fighting_the)==null?void 0:Je.length)&&Cl(o),V=((Ze=o[16].bluffing_as)==null?void 0:Ze.length)&&Ll(o),le=((Qe=o[16].traveller_tips_good)==null?void 0:Qe.length)&&Pl(o),he=((ue=o[16].traveller_tips_evil)==null?void 0:ue.length)&&Yl(o),_e=((Q=o[16].fabled_explanation)==null?void 0:Q.length)&&Gl(o),Ie=((fe=o[16].jinxes)==null?void 0:fe.length)&&jl(o);return{c(){e=$("div"),v&&v.c(),t=D(),n=$("h2"),r=C(i),l=D(),a=$("p"),c=C(s),f=D(),u=$("hr"),d=D(),Y&&Y.c(),h=D(),W&&W.c(),m=D(),z&&z.c(),k=D(),B&&B.c(),w=D(),L&&L.c(),O=D(),S&&S.c(),I=D(),P&&P.c(),T=D(),K&&K.c(),E=D(),V&&V.c(),R=D(),le&&le.c(),H=D(),he&&he.c(),A=D(),_e&&_e.c(),M=D(),Ie&&Ie.c(),U=D(),p(n,"class","role-name svelte-11sp4jv"),p(a,"class","ability svelte-11sp4jv"),p(u,"class","svelte-11sp4jv"),p(e,"class","slide svelte-11sp4jv")},m(ie,pe){_(ie,e,pe),v&&v.m(e,null),b(e,t),b(e,n),b(n,r),b(e,l),b(e,a),b(a,c),b(e,f),b(e,u),b(e,d),Y&&Y.m(e,null),b(e,h),W&&W.m(e,null),b(e,m),z&&z.m(e,null),b(e,k),B&&B.m(e,null),b(e,w),L&&L.m(e,null),b(e,O),S&&S.m(e,null),b(e,I),P&&P.m(e,null),b(e,T),K&&K.m(e,null),b(e,E),V&&V.m(e,null),b(e,R),le&&le.m(e,null),b(e,H),he&&he.m(e,null),b(e,A),_e&&_e.m(e,null),b(e,M),Ie&&Ie.m(e,null),b(e,U)},p(ie,pe){var xe,Se,We,kt,Ce,Ge,nt,Ye,lt,tn,st;ie[16].iconUrl?v?v.p(ie,pe):(v=kl(ie),v.c(),v.m(e,t)):v&&(v.d(1),v=null),pe[0]&8&&i!==(i=ie[16].name.toUpperCase()+"")&&J(r,i),pe[0]&8&&s!==(s=ie[16].ability+"")&&J(c,s),ie[16].flavour_text?Y?Y.p(ie,pe):(Y=wl(ie),Y.c(),Y.m(e,h)):Y&&(Y.d(1),Y=null),ie[16].details?W?W.p(ie,pe):(W=yl(ie),W.c(),W.m(e,m)):W&&(W.d(1),W=null),(xe=ie[16].bullets)!=null&&xe.length?z?z.p(ie,pe):(z=$l(ie),z.c(),z.m(e,k)):z&&(z.d(1),z=null),(Se=ie[16].examples)!=null&&Se.length?B?B.p(ie,pe):(B=Il(ie),B.c(),B.m(e,w)):B&&(B.d(1),B=null),(We=ie[16].how_to_run)!=null&&We.length?L?L.p(ie,pe):(L=Rl(ie),L.c(),L.m(e,O)):L&&(L.d(1),L=null),(kt=ie[16].how_to_run_hint)!=null&&kt.length?S?S.p(ie,pe):(S=El(ie),S.c(),S.m(e,I)):S&&(S.d(1),S=null),(Ce=ie[16].tips_and_tricks)!=null&&Ce.length?P?P.p(ie,pe):(P=Al(ie),P.c(),P.m(e,T)):P&&(P.d(1),P=null),(Ge=ie[16].fighting_the)!=null&&Ge.length?K?K.p(ie,pe):(K=Cl(ie),K.c(),K.m(e,E)):K&&(K.d(1),K=null),(nt=ie[16].bluffing_as)!=null&&nt.length?V?V.p(ie,pe):(V=Ll(ie),V.c(),V.m(e,R)):V&&(V.d(1),V=null),(Ye=ie[16].traveller_tips_good)!=null&&Ye.length?le?le.p(ie,pe):(le=Pl(ie),le.c(),le.m(e,H)):le&&(le.d(1),le=null),(lt=ie[16].traveller_tips_evil)!=null&&lt.length?he?he.p(ie,pe):(he=Yl(ie),he.c(),he.m(e,A)):he&&(he.d(1),he=null),(tn=ie[16].fabled_explanation)!=null&&tn.length?_e?_e.p(ie,pe):(_e=Gl(ie),_e.c(),_e.m(e,M)):_e&&(_e.d(1),_e=null),(st=ie[16].jinxes)!=null&&st.length?Ie?Ie.p(ie,pe):(Ie=jl(ie),Ie.c(),Ie.m(e,U)):Ie&&(Ie.d(1),Ie=null)},d(ie){ie&&g(e),v&&v.d(),Y&&Y.d(),W&&W.d(),z&&z.d(),B&&B.d(),L&&L.d(),S&&S.d(),P&&P.d(),K&&K.d(),V&&V.d(),le&&le.d(),he&&he.d(),_e&&_e.d(),Ie&&Ie.d()}}}function fm(o){let e,t,n,i,r,l,a,s,c,f,u,d,h,m,k=X(o[3]),w=[];for(let T=0;T<k.length;T+=1)w[T]=bl(_l(o,k,T));let O=X(o[3]),I=[];for(let T=0;T<O.length;T+=1)I[T]=Kl(il(o,O,T));return{c(){e=$("div"),t=$("div"),n=$("label"),i=$("input"),r=C(`
        Script Only`),l=D(),a=$("div"),s=$("label"),s.textContent="Jump to Character:",c=D(),f=$("select");for(let T=0;T<w.length;T+=1)w[T].c();u=D(),d=$("div");for(let T=0;T<I.length;T+=1)I[T].c();p(i,"type","checkbox"),p(t,"class","picker svelte-11sp4jv"),p(s,"for","player-explain"),p(f,"id","player-explain"),o[1]===void 0&&Zt(()=>o[12].call(f)),p(a,"class","picker svelte-11sp4jv"),p(d,"class","carousel-container svelte-11sp4jv"),p(e,"class","explanation-list svelte-11sp4jv")},m(T,E){_(T,e,E),b(e,t),b(t,n),b(n,i),i.checked=o[0],b(n,r),b(e,l),b(e,a),b(a,s),b(a,c),b(a,f);for(let R=0;R<w.length;R+=1)w[R]&&w[R].m(f,null);dt(f,o[1],!0),b(e,u),b(e,d);for(let R=0;R<I.length;R+=1)I[R]&&I[R].m(d,null);o[13](d),h||(m=[ee(i,"change",o[11]),ee(f,"change",o[12]),ee(f,"change",o[5]),ee(d,"scroll",mm)],h=!0)},p(T,E){if(E[0]&1&&(i.checked=T[0]),E[0]&8){k=X(T[3]);let R;for(R=0;R<k.length;R+=1){const H=_l(T,k,R);w[R]?w[R].p(H,E):(w[R]=bl(H),w[R].c(),w[R].m(f,null))}for(;R<w.length;R+=1)w[R].d(1);w.length=k.length}if(E[0]&10&&dt(f,T[1]),E[0]&8){O=X(T[3]);let R;for(R=0;R<O.length;R+=1){const H=il(T,O,R);I[R]?I[R].p(H,E):(I[R]=Kl(H),I[R].c(),I[R].m(d,null))}for(;R<I.length;R+=1)I[R].d(1);I.length=O.length}},d(T){T&&g(e),me(w,T),me(I,T),o[13](null),h=!1,$e(m)}}}function um(o){let e;return{c(){e=C("Close")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function dm(o){let e,t;return e=new Z({props:{$$slots:{default:[um]},$$scope:{ctx:o}}}),e.$on("click",o[6]),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i[1]&2097152&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function hm(o){let e,t;return e=new De({props:{show:o[4].showScriptAlmanacModal,title:"Script Almanac",onClose:o[6],$$slots:{footer:[dm],default:[fm]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i[0]&16&&(r.show=n[4].showScriptAlmanacModal),i[0]&15|i[1]&2097152&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function mm(){}function pm(o,e,t){let n,i,r,l,a,s;se(o,ae,I=>t(10,a=I)),se(o,q,I=>t(4,s=I)),Me(q,I=>I.playerExplanationId);let c=null,f,u=!0;function d(I,T=!0){if(!I||!f)return;const E=l.findIndex(R=>R.id===I);if(E>=0){const R=f.children[E];R==null||R.scrollIntoView({behavior:T?"smooth":"auto",inline:"center",block:"nearest"})}}mt(()=>q.subscribe(async T=>{var E;if(T.showScriptAlmanacModal){const R=T.playerExplanationId??((E=l[0])==null?void 0:E.id)??null;t(1,c=R),await ca(),d(c,!0)}}));function h(I){t(1,c=I.currentTarget.value),q.update(T=>({...T,playerExplanationId:c})),d(c,!0)}function m(){q.update(I=>({...I,showScriptAlmanacModal:!1,playerExplanationId:null}))}function k(){u=this.checked,t(0,u)}function w(){c=to(this),t(1,c),t(3,l),t(0,u),t(8,i),t(9,r),t(7,n),t(10,a)}function O(I){et[I?"unshift":"push"](()=>{f=I,t(2,f)})}return o.$$.update=()=>{var I;o.$$.dirty[0]&1024&&t(9,r=new Set((((I=a==null?void 0:a.script)==null?void 0:I.roles)??[]).map(T=>typeof T=="string"?T:T.id))),o.$$.dirty[0]&897&&t(3,l=(u?i.filter(T=>r.has(T.id)):i).map(T=>{const E=n.find(R=>R.roleId===T.id);return{...T,...E}}))},t(7,n=re(kn)),t(8,i=re(bn)),[u,c,f,l,s,h,m,n,i,r,a,k,w,O]}class gm extends ye{constructor(e){super(),we(this,e,pm,hm,ke,{},null,[-1,-1])}}function Wl(o,e,t){const n=o.slice();return n[25]=e[t],n}function ql(o,e,t){const n=o.slice();return n[25]=e[t],n}function Vl(o){let e,t;return e=new De({props:{show:!0,title:o[8],onClose:o[9],$$slots:{footer:[Im],default:[vm]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&256&&(r.title=n[8]),i&1073742079&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function _m(o){let e;return{c(){e=C("Move Reminder to Player")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function bm(o){let e;return{c(){e=C("Enabled")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function km(o){let e,t,n;return{c(){e=C('"You are '),t=C(o[7]),n=C('"')},m(i,r){_(i,e,r),_(i,t,r),_(i,n,r)},p(i,r){r&128&&J(t,i[7])},d(i){i&&(g(e),g(t),g(n))}}}function wm(o){let e,t,n;return{c(){e=C('"This player is '),t=C(o[6]),n=C('"')},m(i,r){_(i,e,r),_(i,t,r),_(i,n,r)},p(i,r){r&64&&J(t,i[6])},d(i){i&&(g(e),g(t),g(n))}}}function ym(o){let e,t,n;return{c(){e=C('"This player is '),t=C(o[5]),n=C('"')},m(i,r){_(i,e,r),_(i,t,r),_(i,n,r)},p(i,r){r&32&&J(t,i[5])},d(i){i&&(g(e),g(t),g(n))}}}function Xl(o,e){var u;let t,n=e[25].playerName+"",i,r,l=(((u=e[1][e[25].roleId])==null?void 0:u.name)??e[25].roleId)+"",a,s,c,f;return{key:o,first:null,c(){t=$("option"),i=C(n),r=C(" ("),a=C(l),s=C(`)
            `),t.__value=c=e[25].id,Ne(t,t.__value),t.selected=f=e[2]&&e[25].id===e[2].id,this.first=t},m(d,h){_(d,t,h),b(t,i),b(t,r),b(t,a),b(t,s)},p(d,h){var m;e=d,h&8&&n!==(n=e[25].playerName+"")&&J(i,n),h&10&&l!==(l=(((m=e[1][e[25].roleId])==null?void 0:m.name)??e[25].roleId)+"")&&J(a,l),h&8&&c!==(c=e[25].id)&&(t.__value=c,Ne(t,t.__value)),h&12&&f!==(f=e[2]&&e[25].id===e[2].id)&&(t.selected=f)},d(d){d&&g(t)}}}function $m(o){let e;return{c(){e=C("Delete Reminder")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function vm(o){let e,t,n,i,r,l,a,s,c,f,u,d,h,m,k,w,O,I=[],T=new Map,E,R,H,A,M,U,v,Y;t=new Z({props:{$$slots:{default:[_m]},$$scope:{ctx:o}}}),t.$on("click",Yc),i=new Z({props:{type:"checkbox",checked:o[0].enabled,$$slots:{default:[bm]},$$scope:{ctx:o}}}),i.$on("toggle",o[18]),s=new Z({props:{$$slots:{default:[km]},$$scope:{ctx:o}}}),s.$on("click",o[19]),f=new Z({props:{$$slots:{default:[wm]},$$scope:{ctx:o}}}),f.$on("click",o[20]),d=new Z({props:{$$slots:{default:[ym]},$$scope:{ctx:o}}}),d.$on("click",o[21]);let W=X(o[3].playerTokens);const z=B=>B[25].id;for(let B=0;B<W.length;B+=1){let L=ql(o,W,B),S=z(L);T.set(S,I[B]=Xl(S,L))}return M=new Z({props:{type:"danger",$$slots:{default:[$m]},$$scope:{ctx:o}}}),M.$on("click",o[11]),{c(){var B;e=$("div"),j(t.$$.fragment),n=D(),j(i.$$.fragment),r=D(),l=$("label"),l.textContent="Quick Cards:",a=D(),j(s.$$.fragment),c=D(),j(f.$$.fragment),u=D(),j(d.$$.fragment),h=D(),m=$("div"),k=$("label"),k.textContent="Change Reminder Sender:",w=D(),O=$("select");for(let L=0;L<I.length;L+=1)I[L].c();E=D(),R=$("input"),A=D(),j(M.$$.fragment),p(l,"for","owner-select"),p(k,"for","owner-select"),p(k,"class","svelte-1ucanba"),p(O,"id","owner-select"),p(O,"class","owner-select svelte-1ucanba"),p(m,"class","owner-row svelte-1ucanba"),p(R,"class","custom-text svelte-1ucanba"),p(R,"type","text"),R.value=H=((B=o[0])==null?void 0:B.customText)??"",p(R,"placeholder","Optionally Replace Reminder Text"),p(e,"class","reminder-context svelte-1ucanba")},m(B,L){_(B,e,L),G(t,e,null),b(e,n),G(i,e,null),b(e,r),b(e,l),b(e,a),G(s,e,null),b(e,c),G(f,e,null),b(e,u),G(d,e,null),b(e,h),b(e,m),b(m,k),b(m,w),b(m,O);for(let S=0;S<I.length;S+=1)I[S]&&I[S].m(O,null);b(e,E),b(e,R),b(e,A),G(M,e,null),U=!0,v||(Y=[ee(O,"change",o[22]),ee(R,"input",o[23])],v=!0)},p(B,L){var _e;const S={};L&1073741824&&(S.$$scope={dirty:L,ctx:B}),t.$set(S);const P={};L&1&&(P.checked=B[0].enabled),L&1073741824&&(P.$$scope={dirty:L,ctx:B}),i.$set(P);const K={};L&1073741952&&(K.$$scope={dirty:L,ctx:B}),s.$set(K);const V={};L&1073741888&&(V.$$scope={dirty:L,ctx:B}),f.$set(V);const le={};L&1073741856&&(le.$$scope={dirty:L,ctx:B}),d.$set(le),L&14&&(W=X(B[3].playerTokens),I=He(I,L,z,1,B,W,T,O,oo,Xl,null,ql)),(!U||L&1&&H!==(H=((_e=B[0])==null?void 0:_e.customText)??"")&&R.value!==H)&&(R.value=H);const he={};L&1073741824&&(he.$$scope={dirty:L,ctx:B}),M.$set(he)},i(B){U||(y(t.$$.fragment,B),y(i.$$.fragment,B),y(s.$$.fragment,B),y(f.$$.fragment,B),y(d.$$.fragment,B),y(M.$$.fragment,B),U=!0)},o(B){N(t.$$.fragment,B),N(i.$$.fragment,B),N(s.$$.fragment,B),N(f.$$.fragment,B),N(d.$$.fragment,B),N(M.$$.fragment,B),U=!1},d(B){B&&g(e),F(t),F(i),F(s),F(f),F(d);for(let L=0;L<I.length;L+=1)I[L].d();F(M),v=!1,$e(Y)}}}function Nm(o){let e;return{c(){e=C("Close")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Im(o){let e,t,n;return t=new Z({props:{$$slots:{default:[Nm]},$$scope:{ctx:o}}}),t.$on("click",o[9]),{c(){e=$("div"),j(t.$$.fragment),p(e,"slot","footer")},m(i,r){_(i,e,r),G(t,e,null),n=!0},p(i,r){const l={};r&1073741824&&(l.$$scope={dirty:r,ctx:i}),t.$set(l)},i(i){n||(y(t.$$.fragment,i),n=!0)},o(i){N(t.$$.fragment,i),n=!1},d(i){i&&g(e),F(t)}}}function Jl(o){let e,t;return e=new De({props:{show:!0,title:"Move Reminder To Player",onClose:o[10],$$slots:{footer:[Em],default:[Rm]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&1073741834&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Om(o){var a;let e=o[25].playerName+"",t,n,i=(((a=o[1][o[25].roleId])==null?void 0:a.name)??o[25].roleId)+"",r,l;return{c(){t=C(e),n=C(" ("),r=C(i),l=C(`)
`)},m(s,c){_(s,t,c),_(s,n,c),_(s,r,c),_(s,l,c)},p(s,c){var f;c&8&&e!==(e=s[25].playerName+"")&&J(t,e),c&10&&i!==(i=(((f=s[1][s[25].roleId])==null?void 0:f.name)??s[25].roleId)+"")&&J(r,i)},d(s){s&&(g(t),g(n),g(r),g(l))}}}function Zl(o,e){let t,n,i;function r(){return e[24](e[25])}return n=new Z({props:{$$slots:{default:[Om]},$$scope:{ctx:e}}}),n.$on("click",r),{key:o,first:null,c(){t=de(),j(n.$$.fragment),this.first=t},m(l,a){_(l,t,a),G(n,l,a),i=!0},p(l,a){e=l;const s={};a&1073741834&&(s.$$scope={dirty:a,ctx:e}),n.$set(s)},i(l){i||(y(n.$$.fragment,l),i=!0)},o(l){N(n.$$.fragment,l),i=!1},d(l){l&&g(t),F(n,l)}}}function Rm(o){let e,t=[],n=new Map,i,r=X(o[3].playerTokens);const l=a=>a[25].id;for(let a=0;a<r.length;a+=1){let s=Wl(o,r,a),c=l(s);n.set(c,t[a]=Zl(c,s))}return{c(){e=$("div");for(let a=0;a<t.length;a+=1)t[a].c();p(e,"class","player-list svelte-1ucanba")},m(a,s){_(a,e,s);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);i=!0},p(a,s){s&10&&(r=X(a[3].playerTokens),ne(),t=He(t,s,l,1,a,r,n,e,Ve,Zl,null,Wl),oe())},i(a){if(!i){for(let s=0;s<r.length;s+=1)y(t[s]);i=!0}},o(a){for(let s=0;s<t.length;s+=1)N(t[s]);i=!1},d(a){a&&g(e);for(let s=0;s<t.length;s+=1)t[s].d()}}}function Tm(o){let e;return{c(){e=C("Cancel")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Em(o){let e,t,n;return t=new Z({props:{$$slots:{default:[Tm]},$$scope:{ctx:o}}}),t.$on("click",o[10]),{c(){e=$("div"),j(t.$$.fragment),p(e,"slot","footer")},m(i,r){_(i,e,r),G(t,e,null),n=!0},p(i,r){const l={};r&1073741824&&(l.$$scope={dirty:r,ctx:i}),t.$set(l)},i(i){n||(y(t.$$.fragment,i),n=!0)},o(i){N(t.$$.fragment,i),n=!1},d(i){i&&g(e),F(t)}}}function Dm(o){let e,t,n,i=o[4].showReminderContextModal&&o[0]&&Vl(o),r=o[4].showMoveReminderModal&&o[0]&&Jl(o);return{c(){i&&i.c(),e=D(),r&&r.c(),t=de()},m(l,a){i&&i.m(l,a),_(l,e,a),r&&r.m(l,a),_(l,t,a),n=!0},p(l,[a]){l[4].showReminderContextModal&&l[0]?i?(i.p(l,a),a&17&&y(i,1)):(i=Vl(l),i.c(),y(i,1),i.m(e.parentNode,e)):i&&(ne(),N(i,1,1,()=>{i=null}),oe()),l[4].showMoveReminderModal&&l[0]?r?(r.p(l,a),a&17&&y(r,1)):(r=Jl(l),r.c(),y(r,1),r.m(t.parentNode,t)):r&&(ne(),N(r,1,1,()=>{r=null}),oe())},i(l){n||(y(i),y(r),n=!0)},o(l){N(i),N(r),n=!1},d(l){l&&(g(e),g(t)),i&&i.d(l),r&&r.d(l)}}}function Am(o,e,t){let n,i,r,l,a,s,c,f,u,d,h,m,k,w;se(o,ae,W=>t(3,k=W)),se(o,q,W=>t(4,w=W));function O(){q.update(W=>({...W,showReminderContextModal:!1}))}function I(){q.update(W=>({...W,showMoveReminderModal:!1,showReminderContextModal:!1}))}function T(){i&&(jc(i.id),O())}function E(W,z){ae.update(B=>({...B,ReminderTokens:B.ReminderTokens.map(L=>L.id===W?{...L,ownerId:z}:L)}))}const R=()=>{const W=k.ReminderTokens.find(z=>{var B;return z.id===((B=w.currentReminder)==null?void 0:B.id)});W&&Vc(W.id)},H=()=>Hc(i),A=()=>Gc(i),M=()=>Wc(i),U=W=>E(i.id,parseInt(W.currentTarget.value)),v=W=>Xc(i.id,W.currentTarget.value),Y=W=>Fc(W.id);return o.$$.update=()=>{var W,z,B,L,S;o.$$.dirty&16&&t(17,n=w.currentReminder),o.$$.dirty&131080&&t(0,i=k.ReminderTokens.find(P=>P.id===(n==null?void 0:n.id))??n),o.$$.dirty&1&&t(13,[l="",,a=""]=(i==null?void 0:i.reminderId.split("."))??[],l,(t(16,a),t(0,i),t(3,k),t(17,n),t(4,w))),o.$$.dirty&65537&&t(15,s=(i==null?void 0:i.customText)??((W=Qt[(i==null?void 0:i.reminderId)??""])==null?void 0:W.text)??a),o.$$.dirty&40962&&t(8,c=`Reminder: ${((z=r[l])==null?void 0:z.name)??l} – ${s}`),o.$$.dirty&1&&t(2,f=i?ro(i.id):null),o.$$.dirty&6&&t(7,u=f?((B=r[f.roleId])==null?void 0:B.name)??f.roleId:"Unknown"),o.$$.dirty&1&&t(14,d=i?lo(i.id):null),o.$$.dirty&16386&&t(6,h=d?((L=r[d.roleId])==null?void 0:L.name)??d.roleId:"Unknown"),o.$$.dirty&8194&&t(5,m=((S=r[l])==null?void 0:S.name)??l)},t(1,r=re(Re)),[i,r,f,k,w,m,h,u,c,O,I,T,E,l,d,s,a,n,R,H,A,M,U,v,Y]}class Sm extends ye{constructor(e){super(),we(this,e,Am,Dm,ke,{})}}function Ql(o,e,t){const n=o.slice();return n[29]=e[t],n}function xl(o,e,t){const n=o.slice();return n[32]=e[t],n}function Cm(o){let e;return{c(){e=C("✎")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Mm(o){let e;return{c(){e=C("🗑")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function es(o){let e,t,n=o[32].name+"",i,r,l,a=((o[32].roles||[]).join(", ")||"— no roles —")+"",s,c,f,u,d,h,m,k,w;function O(...R){return o[21](o[32],...R)}function I(...R){return o[22](o[32],...R)}u=new Z({props:{small:!0,$$slots:{default:[Cm]},$$scope:{ctx:o}}}),u.$on("click",I);function T(...R){return o[23](o[32],...R)}h=new Z({props:{small:!0,$$slots:{default:[Mm]},$$scope:{ctx:o}}}),h.$on("click",T);function E(){return o[24](o[32])}return{c(){e=$("button"),t=$("div"),i=C(n),r=D(),l=$("div"),s=C(a),c=D(),f=$("div"),j(u.$$.fragment),d=D(),j(h.$$.fragment),p(t,"class","title svelte-1ff4ojd"),p(t,"contenteditable",""),p(l,"class","roles svelte-1ff4ojd"),p(f,"class","actions svelte-1ff4ojd"),p(e,"type","button"),p(e,"class","bluff-item svelte-1ff4ojd"),Oe(e,"selected",o[2]===o[32].id)},m(R,H){_(R,e,H),b(e,t),b(t,i),b(e,r),b(e,l),b(l,s),b(e,c),b(e,f),G(u,f,null),b(f,d),G(h,f,null),m=!0,k||(w=[ee(t,"input",O),ee(e,"click",E)],k=!0)},p(R,H){o=R,(!m||H[0]&8)&&n!==(n=o[32].name+"")&&la(i,n),(!m||H[0]&8)&&a!==(a=((o[32].roles||[]).join(", ")||"— no roles —")+"")&&J(s,a);const A={};H[1]&16&&(A.$$scope={dirty:H,ctx:o}),u.$set(A);const M={};H[1]&16&&(M.$$scope={dirty:H,ctx:o}),h.$set(M),(!m||H[0]&12)&&Oe(e,"selected",o[2]===o[32].id)},i(R){m||(y(u.$$.fragment,R),y(h.$$.fragment,R),m=!0)},o(R){N(u.$$.fragment,R),N(h.$$.fragment,R),m=!1},d(R){R&&g(e),F(u),F(h),k=!1,$e(w)}}}function Lm(o){let e;return{c(){e=C("＋ Add Bluff Set")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Um(o){let e,t,n,i,r=X(o[3]&&o[3].bluffSets?o[3].bluffSets:[]),l=[];for(let s=0;s<r.length;s+=1)l[s]=es(xl(o,r,s));const a=s=>N(l[s],1,1,()=>{l[s]=null});return n=new Z({props:{$$slots:{default:[Lm]},$$scope:{ctx:o}}}),n.$on("click",o[25]),{c(){e=$("div");for(let s=0;s<l.length;s+=1)l[s].c();t=D(),j(n.$$.fragment),p(e,"class","bluff-list svelte-1ff4ojd")},m(s,c){_(s,e,c);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(e,null);b(e,t),G(n,e,null),i=!0},p(s,c){if(c[0]&307212){r=X(s[3]&&s[3].bluffSets?s[3].bluffSets:[]);let u;for(u=0;u<r.length;u+=1){const d=xl(s,r,u);l[u]?(l[u].p(d,c),y(l[u],1)):(l[u]=es(d),l[u].c(),y(l[u],1),l[u].m(e,t))}for(ne(),u=r.length;u<l.length;u+=1)a(u);oe()}const f={};c[1]&16&&(f.$$scope={dirty:c,ctx:s}),n.$set(f)},i(s){if(!i){for(let c=0;c<r.length;c+=1)y(l[c]);y(n.$$.fragment,s),i=!0}},o(s){l=l.filter(Boolean);for(let c=0;c<l.length;c+=1)N(l[c]);N(n.$$.fragment,s),i=!1},d(s){s&&g(e),me(l,s),F(n)}}}function Pm(o){let e;return{c(){e=C("Insert this bluff set")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Bm(o){let e;return{c(){e=C("Cancel")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Ym(o){let e,t,n,i;return e=new Z({props:{disabled:o[2]==null,$$slots:{default:[Pm]},$$scope:{ctx:o}}}),e.$on("click",o[16]),n=new Z({props:{$$slots:{default:[Bm]},$$scope:{ctx:o}}}),n.$on("click",o[17]),{c(){j(e.$$.fragment),t=D(),j(n.$$.fragment)},m(r,l){G(e,r,l),_(r,t,l),G(n,r,l),i=!0},p(r,l){const a={};l[0]&4&&(a.disabled=r[2]==null),l[1]&16&&(a.$$scope={dirty:l,ctx:r}),e.$set(a);const s={};l[1]&16&&(s.$$scope={dirty:l,ctx:r}),n.$set(s)},i(r){i||(y(e.$$.fragment,r),y(n.$$.fragment,r),i=!0)},o(r){N(e.$$.fragment,r),N(n.$$.fragment,r),i=!1},d(r){r&&g(t),F(e,r),F(n,r)}}}function ts(o){let e,t;return e=new De({props:{show:o[4],onClose:o[28],title:"Edit Bluff Roles",$$slots:{footer:[Wm],default:[jm]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i[0]&16&&(r.show=n[4]),i[0]&97|i[1]&16&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Hm(o){let e;return{c(){e=$("p"),e.textContent="Loading…"},m(t,n){_(t,e,n)},p:te,i:te,o:te,d(t){t&&g(e)}}}function Gm(o){let e,t,n=o[5].name+"",i,r,l,a=[],s=new Map,c,f=X(o[0]);const u=d=>d[29].id;for(let d=0;d<f.length;d+=1){let h=Ql(o,f,d),m=u(h);s.set(m,a[d]=ns(m,h))}return{c(){e=$("p"),t=$("strong"),i=C(n),r=D(),l=$("div");for(let d=0;d<a.length;d+=1)a[d].c();p(l,"class","role-list svelte-1ff4ojd")},m(d,h){_(d,e,h),b(e,t),b(t,i),_(d,r,h),_(d,l,h);for(let m=0;m<a.length;m+=1)a[m]&&a[m].m(l,null);c=!0},p(d,h){(!c||h[0]&32)&&n!==(n=d[5].name+"")&&J(i,n),h[0]&524353&&(f=X(d[0]),ne(),a=He(a,h,u,1,d,f,s,l,Ve,ns,null,Ql),oe())},i(d){if(!c){for(let h=0;h<f.length;h+=1)y(a[h]);c=!0}},o(d){for(let h=0;h<a.length;h+=1)N(a[h]);c=!1},d(d){d&&(g(e),g(r),g(l));for(let h=0;h<a.length;h+=1)a[h].d()}}}function Fm(o){let e=o[29].name+"",t,n;return{c(){t=C(e),n=D()},m(i,r){_(i,t,r),_(i,n,r)},p(i,r){r[0]&1&&e!==(e=i[29].name+"")&&J(t,e)},d(i){i&&(g(t),g(n))}}}function ns(o,e){let t,n,i;function r(...l){return e[27](e[29],...l)}return n=new Z({props:{type:"checkbox",checked:e[6].includes(e[29].id),$$slots:{default:[Fm]},$$scope:{ctx:e}}}),n.$on("toggle",r),{key:o,first:null,c(){t=de(),j(n.$$.fragment),this.first=t},m(l,a){_(l,t,a),G(n,l,a),i=!0},p(l,a){e=l;const s={};a[0]&65&&(s.checked=e[6].includes(e[29].id)),a[0]&1|a[1]&16&&(s.$$scope={dirty:a,ctx:e}),n.$set(s)},i(l){i||(y(n.$$.fragment,l),i=!0)},o(l){N(n.$$.fragment,l),i=!1},d(l){l&&g(t),F(n,l)}}}function jm(o){let e,t,n,i;const r=[Gm,Hm],l=[];function a(s,c){return s[5]?0:1}return e=a(o),t=l[e]=r[e](o),{c(){t.c(),n=de()},m(s,c){l[e].m(s,c),_(s,n,c),i=!0},p(s,c){let f=e;e=a(s),e===f?l[e].p(s,c):(ne(),N(l[f],1,1,()=>{l[f]=null}),oe(),t=l[e],t?t.p(s,c):(t=l[e]=r[e](s),t.c()),y(t,1),t.m(n.parentNode,n))},i(s){i||(y(t),i=!0)},o(s){N(t),i=!1},d(s){s&&g(n),l[e].d(s)}}}function zm(o){let e;return{c(){e=C("Save")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Km(o){let e;return{c(){e=C("Cancel")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Wm(o){let e,t,n,i;return e=new Z({props:{disabled:!o[5],$$slots:{default:[zm]},$$scope:{ctx:o}}}),e.$on("click",o[14]),n=new Z({props:{$$slots:{default:[Km]},$$scope:{ctx:o}}}),n.$on("click",o[26]),{c(){j(e.$$.fragment),t=D(),j(n.$$.fragment)},m(r,l){G(e,r,l),_(r,t,l),G(n,r,l),i=!0},p(r,l){const a={};l[0]&32&&(a.disabled=!r[5]),l[1]&16&&(a.$$scope={dirty:l,ctx:r}),e.$set(a);const s={};l[1]&16&&(s.$$scope={dirty:l,ctx:r}),n.$set(s)},i(r){i||(y(e.$$.fragment,r),y(n.$$.fragment,r),i=!0)},o(r){N(e.$$.fragment,r),N(n.$$.fragment,r),i=!1},d(r){r&&g(t),F(e,r),F(n,r)}}}function qm(o){let e,t,n,i;e=new De({props:{show:o[1].showBluffsModal,onClose:o[17],title:"Insert Bluffs",$$slots:{footer:[Ym],default:[Um]},$$scope:{ctx:o}}});let r=o[4]&&ts(o);return{c(){j(e.$$.fragment),t=D(),r&&r.c(),n=de()},m(l,a){G(e,l,a),_(l,t,a),r&&r.m(l,a),_(l,n,a),i=!0},p(l,a){const s={};a[0]&2&&(s.show=l[1].showBluffsModal),a[0]&12|a[1]&16&&(s.$$scope={dirty:a,ctx:l}),e.$set(s),l[4]?r?(r.p(l,a),a[0]&16&&y(r,1)):(r=ts(l),r.c(),y(r,1),r.m(n.parentNode,n)):r&&(ne(),N(r,1,1,()=>{r=null}),oe())},i(l){i||(y(e.$$.fragment,l),y(r),i=!0)},o(l){N(e.$$.fragment,l),N(r),i=!1},d(l){l&&(g(t),g(n)),F(e,l),r&&r.d(l)}}}function Vm(o,e,t){let n,i,r,l,a,s,c,f;se(o,Re,S=>t(20,i=S)),se(o,q,S=>t(1,r=S)),se(o,ae,S=>t(3,a=S));const u=Ae(null);se(o,u,S=>t(2,l=S));const d=Ae(!1);se(o,d,S=>t(4,s=S));const h=Ae(null);se(o,h,S=>t(5,c=S));const m=Ae([]);se(o,m,S=>t(6,f=S));function k(){ae.update(S=>{const P=Array.isArray(S==null?void 0:S.bluffSets)?S.bluffSets:[];return{...S,bluffSets:[...P,{id:Date.now(),name:"New Bluff Set",roles:[]}]}})}function w(S){ae.update(P=>({...P,bluffSets:(P.bluffSets||[]).filter(K=>K.id!==S)}))}function O(S){var K,V;const P=(V=(K=re(ae))==null?void 0:K.bluffSets)==null?void 0:V.find(le=>le.id===S);P&&(h.set(P),m.set([...P.roles]),d.set(!0))}function I(){const S=re(h),P=re(m);S&&(ae.update(K=>({...K,bluffSets:K.bluffSets.map(V=>V.id===S.id?{...V,roles:P}:V)})),d.set(!1))}function T(S){u.set(S)}function E(){var V;const S=re(u),K=(((V=re(ae))==null?void 0:V.bluffSets)||[]).find(le=>le.id===S);K&&q.update(le=>({...le,showBluffsModal:!1,pendingInsertRoles:K.roles}))}function R(){q.update(S=>({...S,showBluffsModal:!1}))}function H(S,P){const K=P.currentTarget,V=((K==null?void 0:K.textContent)??"").trim();ae.update(le=>({...le,bluffSets:le.bluffSets.map(he=>he.id===S?{...he,name:V}:he)}))}function A(S,P){m.update(K=>P?[...K,S]:K.filter(V=>V!==S))}const M=(S,P)=>H(S.id,P),U=(S,P)=>{P.stopPropagation(),O(S.id)},v=(S,P)=>{P.stopPropagation(),w(S.id)},Y=S=>T(S.id),W=S=>{S.stopPropagation(),k()},z=()=>d.set(!1),B=(S,P)=>A(S.id,P.detail),L=()=>d.set(!1);return o.$$.update=()=>{o.$$.dirty[0]&1048576&&t(0,n=Object.values(i||{}).filter(S=>!["Fabled","Travellers"].includes(ga(S.id))))},[n,r,l,a,s,c,f,u,d,h,m,k,w,O,I,T,E,R,H,A,i,M,U,v,Y,W,z,B,L]}class Xm extends ye{constructor(e){super(),we(this,e,Vm,qm,ke,{},null,[-1,-1])}}function os(o,e,t){const n=o.slice();return n[21]=e[t],n}function is(o){let e,t;return e=new Un({props:{svgClass:"name-tag",text:o[0].playerName,diameter:80,radius:40,direction:"top",fontSize:"0.7rem",textShadow:"0 0 1px white",uppercase:!1}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&1&&(r.text=n[0].playerName),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Jm(o){let e;return{c(){e=$("div"),p(e,"class","role-placeholder svelte-18h8lc0")},m(t,n){_(t,e,n)},p:te,i:te,o:te,d(t){t&&g(e)}}}function Zm(o){let e,t;return e=new Ut({props:{role:o[1][o[0].roleId],alignment:o[0].alignment}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&3&&(r.role=n[1][n[0].roleId]),i&1&&(r.alignment=n[0].alignment),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function rs(o){let e;return{c(){e=$("div"),p(e,"class","ghost-overlay svelte-18h8lc0")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function ls(o){let e;return{c(){e=$("div"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 160" preserveAspectRatio="xMidYMid meet" class="svelte-18h8lc0"><path d="M0 0V160L50 120L100 160V0Z"></path></svg>',p(e,"class","dead-overlay svelte-18h8lc0")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function ss(o){var n,i,r,l,a;let e,t;return e=new ao({props:{tokenId:o[21].attachedToId,id:o[21].id,reminderId:o[21].reminderId,x:(((n=o[8].playerPositions[o[21].attachedToId])==null?void 0:n.x)??0)+(((i=o[8].reminderPositions[o[21].id])==null?void 0:i.x)??0),y:(((r=o[8].playerPositions[o[21].attachedToId])==null?void 0:r.y)??0)+(((l=o[8].reminderPositions[o[21].id])==null?void 0:l.y)??0),isDragging:((a=o[3].draggingReminder)==null?void 0:a.id)===o[21].id,text:o[21].customText??xt(o[21].reminderId),enabled:o[21].enabled??!0}}),{c(){j(e.$$.fragment)},m(s,c){G(e,s,c),t=!0},p(s,c){var u,d,h,m,k;const f={};c&5&&(f.tokenId=s[21].attachedToId),c&5&&(f.id=s[21].id),c&5&&(f.reminderId=s[21].reminderId),c&261&&(f.x=(((u=s[8].playerPositions[s[21].attachedToId])==null?void 0:u.x)??0)+(((d=s[8].reminderPositions[s[21].id])==null?void 0:d.x)??0)),c&261&&(f.y=(((h=s[8].playerPositions[s[21].attachedToId])==null?void 0:h.y)??0)+(((m=s[8].reminderPositions[s[21].id])==null?void 0:m.y)??0)),c&13&&(f.isDragging=((k=s[3].draggingReminder)==null?void 0:k.id)===s[21].id),c&5&&(f.text=s[21].customText??xt(s[21].reminderId)),c&5&&(f.enabled=s[21].enabled??!0),e.$set(f)},i(s){t||(y(e.$$.fragment,s),t=!0)},o(s){N(e.$$.fragment,s),t=!1},d(s){F(e,s)}}}function as(o,e){let t,n=e[21].id,i,r,l=ss(e);return{key:o,first:null,c(){t=de(),l.c(),i=de(),this.first=t},m(a,s){_(a,t,s),l.m(a,s),_(a,i,s),r=!0},p(a,s){e=a,s&5&&ke(n,n=e[21].id)?(ne(),N(l,1,1,te),oe(),l=ss(e),l.c(),y(l,1),l.m(i.parentNode,i)):l.p(e,s)},i(a){r||(y(l),r=!0)},o(a){N(l),r=!1},d(a){a&&(g(t),g(i)),l.d(a)}}}function Qm(o){let e,t,n,i,r,l,a,s,c,f=[],u=new Map,d,h,m,k,w=o[3].showNametags&&is(o);const O=[Zm,Jm],I=[];function T(M,U){return M[5]&&M[1][M[0].roleId]?0:1}n=T(o),i=I[n]=O[n](o);let E=o[0].ghostVote&&!o[0].alive&&rs(),R=!o[0].alive&&ls(),H=X(o[2].ReminderTokens.filter(o[15]));const A=M=>M[21].id;for(let M=0;M<H.length;M+=1){let U=os(o,H,M),v=A(U);u.set(v,f[M]=as(v,U))}return{c(){e=$("div"),w&&w.c(),t=D(),i.c(),r=D(),E&&E.c(),l=D(),R&&R.c(),c=D();for(let M=0;M<f.length;M+=1)f[M].c();d=de(),p(e,"role","button"),p(e,"tabindex","0"),p(e,"data-interactive",""),p(e,"class",a="player-token "+(o[7]?"misregister":"")+" svelte-18h8lc0"),ce(e,"left",o[4].x+"px"),ce(e,"top",o[4].y+"px"),p(e,"aria-label",s=`Player ${o[0].playerName}. Press Enter to edit or drag to move.`),Oe(e,"token-hidden",!o[3].showHiddenTokens),Oe(e,"dragging",o[6])},m(M,U){_(M,e,U),w&&w.m(e,null),b(e,t),I[n].m(e,null),b(e,r),E&&E.m(e,null),b(e,l),R&&R.m(e,null),_(M,c,U);for(let v=0;v<f.length;v+=1)f[v]&&f[v].m(M,U);_(M,d,U),h=!0,m||(k=[ee(e,"pointerdown",Tt(o[9])),ee(e,"pointermove",Tt(o[10])),ee(e,"click",Tt(o[11])),ee(e,"keydown",o[14])],m=!0)},p(M,[U]){M[3].showNametags?w?(w.p(M,U),U&8&&y(w,1)):(w=is(M),w.c(),y(w,1),w.m(e,t)):w&&(ne(),N(w,1,1,()=>{w=null}),oe());let v=n;n=T(M),n===v?I[n].p(M,U):(ne(),N(I[v],1,1,()=>{I[v]=null}),oe(),i=I[n],i?i.p(M,U):(i=I[n]=O[n](M),i.c()),y(i,1),i.m(e,r)),M[0].ghostVote&&!M[0].alive?E||(E=rs(),E.c(),E.m(e,l)):E&&(E.d(1),E=null),M[0].alive?R&&(R.d(1),R=null):R||(R=ls(),R.c(),R.m(e,null)),(!h||U&128&&a!==(a="player-token "+(M[7]?"misregister":"")+" svelte-18h8lc0"))&&p(e,"class",a),(!h||U&16)&&ce(e,"left",M[4].x+"px"),(!h||U&16)&&ce(e,"top",M[4].y+"px"),(!h||U&1&&s!==(s=`Player ${M[0].playerName}. Press Enter to edit or drag to move.`))&&p(e,"aria-label",s),(!h||U&136)&&Oe(e,"token-hidden",!M[3].showHiddenTokens),(!h||U&192)&&Oe(e,"dragging",M[6]),U&269&&(H=X(M[2].ReminderTokens.filter(M[15])),ne(),f=He(f,U,A,1,M,H,u,d.parentNode,Ve,as,d,os),oe())},i(M){if(!h){y(w),y(i);for(let U=0;U<H.length;U+=1)y(f[U]);h=!0}},o(M){N(w),N(i);for(let U=0;U<f.length;U+=1)N(f[U]);h=!1},d(M){M&&(g(e),g(c),g(d)),w&&w.d(),I[n].d(),E&&E.d(),R&&R.d();for(let U=0;U<f.length;U+=1)f[U].d(M);m=!1,$e(k)}}}const cs=5;function xm(o,e,t){let n,i,r,l,a,s,c,f,u;se(o,Re,A=>t(1,s=A)),se(o,ae,A=>t(2,c=A)),se(o,q,A=>t(3,f=A)),se(o,Te,A=>t(8,u=A));let{player:d}=e;const h=Me(Te,A=>A.playerPositions[d.id]||{x:0,y:0});let m={x:0,y:0};h.subscribe(A=>t(4,m=A));let k=0,w=0,O=!1;function I(A){k=A.clientX,w=A.clientY,O=!1,Qc(A,d.id)}function T(A){if(!O){const M=Math.abs(A.clientX-k),U=Math.abs(A.clientY-w);(M>cs||U>cs)&&(O=!0)}}function E(A){O||hi(d.id)}const R=A=>{(A.key==="Enter"||A.key===" ")&&(A.preventDefault(),hi(d.id))},H=A=>A.attachedToId===d.id;return o.$$set=A=>{"player"in A&&t(0,d=A.player)},o.$$.update=()=>{var A;o.$$.dirty&9&&t(7,n=f.misregisterIndicators[d.id]||!1),o.$$.dirty&9&&t(6,i=((A=f.draggingPlayer)==null?void 0:A.id)===d.id),o.$$.dirty&4&&t(13,r=c.ReminderTokens),o.$$.dirty&8193&&t(12,l=r.filter(M=>M.ownerId===d.id)),o.$$.dirty&8193&&r.filter(M=>M.attachedToId===d.id&&M.ownerId!==d.id),o.$$.dirty&4099&&s[d.roleId]===void 0&&l.length&&l.forEach(M=>Kc(d.id,M.id)),o.$$.dirty&2&&t(5,a=Object.keys(s).length>0)},[d,s,c,f,m,a,i,n,u,I,T,E,l,r,R,H]}class ep extends ye{constructor(e){super(),we(this,e,xm,Qm,ke,{player:0})}}const tp=o=>{var n;const t=re(kn).find(i=>i.roleId===o);return((n=t==null?void 0:t.how_to_run)==null?void 0:n.join(" "))||`Instruction not available for ${o}`},np=o=>{const e=o.indexOf("During the first"),t=o.indexOf("Each night"),n=Math.min(e!==-1?e:1/0,t!==-1?t:1/0);return n!==1/0&&(o=o.slice(n)),o},op=o=>{const t=/put the .*? to sleep\./i.exec(o);let n=t?o.slice(0,t.index+t[0].length):o;const i=n.indexOf(". (");return i!==-1&&(n=n.slice(0,i+1).trim()),n.trim()},Ca=(o,e)=>o.map(t=>{let n;switch(t){case"DUSK":n="Confirm everyone has closed their eyes and wait a few seconds.";break;case"DAWN":n="Wait approximately 10 seconds. Call for eyes open; immediately announce which players (if anyone) died.";break;case"MINION":n="If there are 7 or more players, wake all Minions: Show the THIS IS THE DEMON token. Point to the Demon. Show the THESE ARE YOUR MINIONS token. Point to the other Minions.";break;case"DEMON":n="If there are 7 or more players, wake the Demon: Show the THESE ARE YOUR MINIONS token. Point to all Minions. Show the THESE CHARACTERS ARE NOT IN PLAY token. Show 3 not-in-play good character tokens.";break;default:const i=t.toLowerCase(),r=tp(i);n=np(op(r));break}return{id:t.toLowerCase(),roleId:["DUSK","DAWN","MINION","DEMON"].includes(t)?void 0:t.toLowerCase(),name:t,instruction:n,isFirstNight:e,isOtherNight:!e}}).filter(Boolean),Ma=re(co),ip=Ca(Ma.firstNight,!0),rp=Ca(Ma.otherNight,!1);function fs(o,e,t){const n=o.slice();return n[12]=e[t],n[14]=t,n}function us(o,e,t){const n=o.slice();return n[15]=e[t],n[14]=t,n}function ds(o){let e,t,n,i,r,l=X(o[1].segs),a=[];for(let u=0;u<l.length;u+=1)a[u]=hs(us(o,l,u));let s=X(o[1].circles),c=[];for(let u=0;u<s.length;u+=1)c[u]=ps(fs(o,s,u));const f=u=>N(c[u],1,1,()=>{c[u]=null});return{c(){e=Ee("svg");for(let u=0;u<a.length;u+=1)a[u].c();t=de();for(let u=0;u<c.length;u+=1)c[u].c();p(e,"class","spider-web svelte-cb1m6j"),p(e,"aria-hidden","true")},m(u,d){_(u,e,d);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(e,null);b(e,t);for(let h=0;h<c.length;h+=1)c[h]&&c[h].m(e,null);n=!0,i||(r=[ee(e,"contextmenu",Lt(o[7])),ee(e,"touchstart",Lt(o[8]))],i=!0)},p(u,d){if(d&6){l=X(u[1].segs);let h;for(h=0;h<l.length;h+=1){const m=us(u,l,h);a[h]?a[h].p(m,d):(a[h]=hs(m),a[h].c(),a[h].m(e,t))}for(;h<a.length;h+=1)a[h].d(1);a.length=l.length}if(d&10){s=X(u[1].circles);let h;for(h=0;h<s.length;h+=1){const m=fs(u,s,h);c[h]?(c[h].p(m,d),y(c[h],1)):(c[h]=ps(m),c[h].c(),y(c[h],1),c[h].m(e,null))}for(ne(),h=s.length;h<c.length;h+=1)f(h);oe()}},i(u){if(!n){for(let d=0;d<s.length;d+=1)y(c[d]);n=!0}},o(u){c=c.filter(Boolean);for(let d=0;d<c.length;d+=1)N(c[d]);n=!1},d(u){u&&g(e),me(a,u),me(c,u),i=!1,$e(r)}}}function hs(o){let e,t,n;return{c(){e=Ee("path"),p(e,"d",t=`
          M ${o[15].x1} ${o[15].y1}
          Q ${(o[15].x1+o[15].x2)/2+(o[2].x-(o[15].x1+o[15].x2)/2)*Rn} ${(o[15].y1+o[15].y2)/2+(o[2].y-(o[15].y1+o[15].y2)/2)*Rn} ${o[15].x2} ${o[15].y2}
        `),p(e,"fill","none"),p(e,"stroke",n=Pn(o[14],o[1].total)),p(e,"stroke-width","2"),p(e,"stroke-linecap","round"),p(e,"stroke-linejoin","round"),p(e,"class","flow-line svelte-cb1m6j")},m(i,r){_(i,e,r)},p(i,r){r&6&&t!==(t=`
          M ${i[15].x1} ${i[15].y1}
          Q ${(i[15].x1+i[15].x2)/2+(i[2].x-(i[15].x1+i[15].x2)/2)*Rn} ${(i[15].y1+i[15].y2)/2+(i[2].y-(i[15].y1+i[15].y2)/2)*Rn} ${i[15].x2} ${i[15].y2}
        `)&&p(e,"d",t),r&2&&n!==(n=Pn(i[14],i[1].total))&&p(e,"stroke",n)},d(i){i&&g(e)}}}function ms(o){let e,t,n,i;return{c(){e=Ee("circle"),p(e,"cx",t=o[12].x),p(e,"cy",n=o[12].y),p(e,"r",ot),p(e,"fill","none"),p(e,"stroke",i=Pn(o[12].index,o[1].total)),p(e,"stroke-width","2"),p(e,"stroke-linecap","round"),p(e,"stroke-linejoin","round"),p(e,"class","flow-line svelte-cb1m6j")},m(r,l){_(r,e,l)},p(r,l){l&2&&t!==(t=r[12].x)&&p(e,"cx",t),l&2&&n!==(n=r[12].y)&&p(e,"cy",n),l&2&&i!==(i=Pn(r[12].index,r[1].total))&&p(e,"stroke",i)},d(r){r&&g(e)}}}function ps(o){let e,t,n,i,r,l,a,s=(o[1].circles.length===1||o[14]<o[1].circles.length-1)&&ms(o);return t=new Un({props:{asGroup:!0,text:o[12].labels[0],diameter:ot*2,radius:o[3],direction:"top",startOffset:"50%",letterSpacing:0,fontSize:"14",fontFamily:"inherit",fontWeight:"normal",fill:"currentColor",uppercase:!0}}),r=new Un({props:{asGroup:!0,text:o[12].labels[1],diameter:ot*2,radius:o[3],direction:"bottom",startOffset:"50%",letterSpacing:0,fontSize:"14",fontFamily:"inherit",fontWeight:"normal",fill:"currentColor",uppercase:!1}}),{c(){s&&s.c(),e=Ee("g"),j(t.$$.fragment),i=Ee("g"),j(r.$$.fragment),p(e,"transform",n=`translate(${o[12].x-ot}, ${o[12].y-ot})`),p(i,"transform",l=`translate(${o[12].x-ot}, ${o[12].y-ot})`)},m(c,f){s&&s.m(c,f),_(c,e,f),G(t,e,null),_(c,i,f),G(r,i,null),a=!0},p(c,f){c[1].circles.length===1||c[14]<c[1].circles.length-1?s?s.p(c,f):(s=ms(c),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null);const u={};f&2&&(u.text=c[12].labels[0]),t.$set(u),(!a||f&2&&n!==(n=`translate(${c[12].x-ot}, ${c[12].y-ot})`))&&p(e,"transform",n);const d={};f&2&&(d.text=c[12].labels[1]),r.$set(d),(!a||f&2&&l!==(l=`translate(${c[12].x-ot}, ${c[12].y-ot})`))&&p(i,"transform",l)},i(c){a||(y(t.$$.fragment,c),y(r.$$.fragment,c),a=!0)},o(c){N(t.$$.fragment,c),N(r.$$.fragment,c),a=!1},d(c){c&&(g(e),g(i)),s&&s.d(c),F(t),F(r)}}}function lp(o){let e,t,n=o[0]&&ds(o);return{c(){n&&n.c(),e=de()},m(i,r){n&&n.m(i,r),_(i,e,r),t=!0},p(i,[r]){i[0]?n?(n.p(i,r),r&1&&y(n,1)):(n=ds(i),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(ne(),N(n,1,1,()=>{n=null}),oe())},i(i){t||(y(n),t=!0)},o(i){N(n),t=!1},d(i){i&&g(e),n&&n.d(i)}}}const ot=70,sp=2,Rn=.5;function Pn(o,e){const t=(o+1)/e,[n,i,r]=[255,0,255],[l,a,s]=[0,0,0];return`rgb(${Math.round(n+(l-n)*t)},${Math.round(i+(a-i)*t)},${Math.round(r+(s-r)*t)})`}function ap(o,e,t){let n,i,r;const l=ot-sp,a=Me(q,k=>k.showNightLines);se(o,a,k=>t(0,n=k));const s=Me(q,k=>k.currentNightType==="first"?ip:rp),c=Me([s],([k])=>{const w=[];for(const O of k){if(!O.roleId){w.push(O);continue}const I=Vn(O.roleId);if(!(!I||I.length===0))for(const T of I)w.push({...O,player:T})}return w}),f=Ae({x:0,y:0});se(o,f,k=>t(2,r=k));function u(){f.set({x:window.innerWidth/2,y:window.innerHeight/2})}mt(()=>{u(),window.addEventListener("resize",u)}),at(()=>{window.removeEventListener("resize",u)});const d=Me([Te,c,q],([k,w,O])=>{const I=_n(),T=80,E=T/2,R=w.map(M=>{const U=M.player||I.playerTokens.find(Y=>M.roleId&&Y.roleId===M.roleId);if(!U)return null;const v=k.playerPositions[U.id];return v?{x:v.x+E,y:v.y+E}:null}).filter(M=>!!M),H=[];for(let M=0;M+1<R.length;M++)H.push({x1:R[M].x,y1:R[M].y,x2:R[M+1].x,y2:R[M+1].y});let A=[];if(R.length){const M={x:R[0].x,y:R[0].y,labels:O.currentNightType==="first"?["DO NOT FORGET","EVIL INFO FIRST"]:["OTHER NIGHTS","START HERE"],index:0},U={x:R[R.length-1].x,y:R[R.length-1].y,labels:["10 SEC AFTER THIS","START DAY TIMER"],index:H.length+1};A=M.x===U.x&&M.y===U.y?[{x:M.x,y:M.y,labels:["OPEN NIGHT ORDER","TO SEE INSTRUCTIONS"],index:0}]:[M,U]}return{segs:H,circles:A,total:H.length+A.length}});se(o,d,k=>t(1,i=k));function h(k){dn.call(this,o,k)}function m(k){dn.call(this,o,k)}return[n,i,r,l,a,f,d,h,m]}class cp extends ye{constructor(e){super(),we(this,e,ap,lp,ke,{})}}const{Map:fp}=eo;function gs(o,e,t){const n=o.slice();return n[10]=e[t],n}function _s(o){let e,t=[],n=new fp,i,r=X(o[0]);const l=s=>`${s[10].x1}-${s[10].y1}-${s[10].x2}-${s[10].y2}`;for(let s=0;s<r.length;s+=1){let c=gs(o,r,s),f=l(c);n.set(f,t[s]=bs(f,c))}let a=o[1]&&ks(o);return{c(){e=Ee("svg");for(let s=0;s<t.length;s+=1)t[s].c();i=de(),a&&a.c(),p(e,"class","outgoing-lines svelte-elk59r")},m(s,c){_(s,e,c);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);b(e,i),a&&a.m(e,null)},p(s,c){c&1&&(r=X(s[0]),t=He(t,c,l,1,s,r,n,e,oo,bs,i,gs)),s[1]?a?a.p(s,c):(a=ks(s),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},d(s){s&&g(e);for(let c=0;c<t.length;c+=1)t[c].d();a&&a.d()}}}function bs(o,e){let t,n,i,r,l,a;return{key:o,first:null,c(){t=Ee("line"),p(t,"x1",n=e[10].x1),p(t,"y1",i=e[10].y1),p(t,"x2",r=e[10].x2),p(t,"y2",l=e[10].y2),p(t,"stroke",a=e[10].color),p(t,"stroke-width","2"),p(t,"stroke-dasharray","1 10"),p(t,"stroke-linecap","round"),this.first=t},m(s,c){_(s,t,c)},p(s,c){e=s,c&1&&n!==(n=e[10].x1)&&p(t,"x1",n),c&1&&i!==(i=e[10].y1)&&p(t,"y1",i),c&1&&r!==(r=e[10].x2)&&p(t,"x2",r),c&1&&l!==(l=e[10].y2)&&p(t,"y2",l),c&1&&a!==(a=e[10].color)&&p(t,"stroke",a)},d(s){s&&g(t)}}}function ks(o){let e,t,n,i,r;return{c(){e=Ee("line"),p(e,"x1",t=o[1].x1),p(e,"y1",n=o[1].y1),p(e,"x2",i=o[1].x2),p(e,"y2",r=o[1].y2),p(e,"class","preview-line svelte-elk59r")},m(l,a){_(l,e,a)},p(l,a){a&2&&t!==(t=l[1].x1)&&p(e,"x1",t),a&2&&n!==(n=l[1].y1)&&p(e,"y1",n),a&2&&i!==(i=l[1].x2)&&p(e,"x2",i),a&2&&r!==(r=l[1].y2)&&p(e,"y2",r)},d(l){l&&g(e)}}}function up(o){let e,t=o[2]&&_s(o);return{c(){t&&t.c(),e=de()},m(n,i){t&&t.m(n,i),_(n,e,i)},p(n,[i]){n[2]?t?t.p(n,i):(t=_s(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:te,o:te,d(n){n&&g(e),t&&t.d(n)}}}const dp=80,hp=30;function mp(o,e,t){let n;const i=dp/2,r=hp/2,l=Me(q,h=>h.showReminderLines);se(o,l,h=>t(2,n=h));const a=Me([Te,ae],([h,m])=>{const k=[];new Map(m.playerTokens.map(w=>[w.id,w]));for(const w of m.ReminderTokens??[]){const O=h.playerPositions[w.ownerId],I=h.playerPositions[w.attachedToId];if(!O||!I)continue;const T=h.reminderPositions[w.id]??{x:0,y:0},E=O.x+i,R=O.y+i,H=I.x+T.x+r,A=I.y+T.y+r,M=w.enabled?"rgba(255,255,255,0.33)":"#222";k.push({x1:E,y1:R,x2:H,y2:A,color:M})}return k}),s=Me([q,Te],([h,m])=>{const k=h.draggingReminder;if(!k)return null;const w=m.playerPositions[k.attachedTo];if(!w)return null;const O=m.reminderPositions[k.id]??{x:0,y:0},I=w.x+O.x+r,T=w.y+O.y+r;let E=null,R=1/0;for(const[,H]of Object.entries(m.playerPositions)){const A=H.x+i,M=H.y+i,U=I-A,v=T-M,Y=U*U+v*v;Y<R&&(R=Y,E={x:A,y:M})}return E?{x1:I,y1:T,x2:E.x,y2:E.y}:null});let c=[],f=null;const u=a.subscribe(h=>t(0,c=h)),d=s.subscribe(h=>t(1,f=h));return at(()=>{u(),d()}),[c,f,n,l]}class pp extends ye{constructor(e){super(),we(this,e,mp,up,ke,{})}}const ve={isPanning:!1,lastX:0,lastY:0,pinchStartDist:0,pinchStartScale:1,rotationStartAngle:0,pinchCenter:{x:0,y:0}};function gp(o,e){Gn()||wa(o.target)||(o.pointerType==="mouse"||o.pointerType==="pen")&&o.button===0&&(ve.isPanning=!0,ve.lastX=o.clientX,ve.lastY=o.clientY,e.setPointerCapture(o.pointerId))}function _p(o){if(ve.isPanning){const e=o.clientX-ve.lastX,t=o.clientY-ve.lastY;bt.update(n=>({...n,x:n.x+e,y:n.y+t})),ve.lastX=o.clientX,ve.lastY=o.clientY}}function bp(o,e){ve.isPanning=!1,e.releasePointerCapture(o.pointerId)}function kp(o,e){if(!Gn()&&!wa(o.target)){if(o.touches.length===1)ve.isPanning=!0,ve.lastX=o.touches[0].clientX,ve.lastY=o.touches[0].clientY;else if(o.touches.length===2){ve.isPanning=!1,ve.pinchStartDist=ba(o.touches[0],o.touches[1]),ve.pinchStartScale=re(bt).scale,ve.rotationStartAngle=ka(o.touches[0],o.touches[1]);const t=e.getBoundingClientRect();ve.pinchCenter={x:(o.touches[0].clientX+o.touches[1].clientX)/2-t.left,y:(o.touches[0].clientY+o.touches[1].clientY)/2-t.top}}}}function wp(o){if(!Gn()){if(o.touches.length===1&&ve.isPanning){const e=o.touches[0].clientX-ve.lastX,t=o.touches[0].clientY-ve.lastY;bt.update(n=>({...n,x:n.x+e,y:n.y+t})),ve.lastX=o.touches[0].clientX,ve.lastY=o.touches[0].clientY}else if(o.touches.length===2){const e=ba(o.touches[0],o.touches[1]),t=e/ve.pinchStartDist,n=ka(o.touches[0],o.touches[1]),i=n-ve.rotationStartAngle,{x:r,y:l}=ve.pinchCenter;bt.update(a=>{const s=a.scale,c=ve.pinchStartScale*t;let f=(a.x-r)*(c/s)+r,u=(a.y-l)*(c/s)+l;const d=i*Math.PI/180,h=Math.cos(d),m=Math.sin(d),k=f-r,w=u-l;return f=r+k*h-w*m,u=l+k*m+w*h,{...a,x:f,y:u,scale:c,rotation:a.rotation+i}}),ve.rotationStartAngle=n,ve.pinchStartDist=e,ve.pinchStartScale=re(bt).scale}o.preventDefault()}}function yp(o){o.touches.length<2&&(ve.isPanning=!1)}function $p(o,e){if(Gn())return;o.preventDefault();const t=e.getBoundingClientRect(),n=o.clientX-t.left,i=o.clientY-t.top;if(o.altKey){const r=-o.deltaY*.1*(Math.PI/180),l=Math.cos(r),a=Math.sin(r);bt.update(s=>{const c=s.x-n,f=s.y-i,u=c*l-f*a,d=c*a+f*l;return{...s,x:n+u,y:i+d,rotation:s.rotation+r*(180/Math.PI)}})}else{const r=Math.exp(-o.deltaY*.001);bt.update(l=>{const a=l.scale*r;return{...l,x:(l.x-n)*r+n,y:(l.y-i)*r+i,scale:a}})}}function Gn(){const o=re(q);return!!(o.draggingPlayer||o.draggingReminder)}function ws(o,e,t){const n=o.slice();return n[19]=e[t],n}function ys(o){let e,t,n,i;e=new pp({});let r=o[0].showNightLines&&$s();return{c(){j(e.$$.fragment),t=D(),r&&r.c(),n=de()},m(l,a){G(e,l,a),_(l,t,a),r&&r.m(l,a),_(l,n,a),i=!0},p(l,a){l[0].showNightLines?r?a&1&&y(r,1):(r=$s(),r.c(),y(r,1),r.m(n.parentNode,n)):r&&(ne(),N(r,1,1,()=>{r=null}),oe())},i(l){i||(y(e.$$.fragment,l),y(r),i=!0)},o(l){N(e.$$.fragment,l),N(r),i=!1},d(l){l&&(g(t),g(n)),F(e,l),r&&r.d(l)}}}function $s(o){let e,t;return e=new cp({}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function vs(o){return{c:te,m:te,d:te}}function vp(o){let e=[],t=new Map,n,i,r=X(o[5].playerTokens);const l=a=>a[19].id;for(let a=0;a<r.length;a+=1){let s=ws(o,r,a),c=l(s);t.set(c,e[a]=Ns(c,s))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=de()},m(a,s){for(let c=0;c<e.length;c+=1)e[c]&&e[c].m(a,s);_(a,n,s),i=!0},p(a,s){s&32&&(r=X(a[5].playerTokens),ne(),e=He(e,s,l,1,a,r,t,n.parentNode,Ve,Ns,n,ws),oe())},i(a){if(!i){for(let s=0;s<r.length;s+=1)y(e[s]);i=!0}},o(a){for(let s=0;s<e.length;s+=1)N(e[s]);i=!1},d(a){a&&g(n);for(let s=0;s<e.length;s+=1)e[s].d(a)}}}function Np(o){let e;return{c(){e=$("div"),e.innerHTML="",p(e,"class","empty-board svelte-11qug6z")},m(t,n){_(t,e,n)},p:te,i:te,o:te,d(t){t&&g(e)}}}function Ns(o,e){let t,n,i;return n=new ep({props:{player:e[19]}}),{key:o,first:null,c(){t=de(),j(n.$$.fragment),this.first=t},m(r,l){_(r,t,l),G(n,r,l),i=!0},p(r,l){e=r;const a={};l&32&&(a.player=e[19]),n.$set(a)},i(r){i||(y(n.$$.fragment,r),i=!0)},o(r){N(n.$$.fragment,r),i=!1},d(r){r&&g(t),F(n,r)}}}function Ip(o){let e,t,n,i,r,l,a,s,c,f=o[0].showHiddenTokens&&ys(o),u=o[0].showBackground&&vs();const d=[Np,vp],h=[];function m(k,w){return k[5].playerTokens.length?1:0}return r=m(o),l=h[r]=d[r](o),{c(){e=$("div"),t=$("div"),f&&f.c(),n=D(),u&&u.c(),i=D(),l.c(),p(t,"class","board-content svelte-11qug6z"),ce(t,"transform","translate("+o[4].x+"px, "+o[4].y+"px) rotate("+o[4].rotation+"deg) scale("+o[4].scale+")"),ce(t,"transform-origin","0 0"),p(e,"role","application"),p(e,"class","board svelte-11qug6z"),ce(e,"filter",o[3]),ce(e,"transition","filter 0.2s ease"),ce(e,"--reminder-opacity",o[2])},m(k,w){_(k,e,w),b(e,t),f&&f.m(t,null),b(t,n),u&&u.m(t,null),b(t,i),h[r].m(t,null),o[7](e),a=!0,s||(c=[ee(e,"dblclick",Tt(o[6])),ee(e,"pointerdown",o[8]),ee(e,"pointermove",_p),ee(e,"pointerup",o[9]),ee(e,"touchstart",o[10]),ee(e,"touchmove",wp),ee(e,"touchend",yp),ee(e,"wheel",o[11])],s=!0)},p(k,[w]){k[0].showHiddenTokens?f?(f.p(k,w),w&1&&y(f,1)):(f=ys(k),f.c(),y(f,1),f.m(t,n)):f&&(ne(),N(f,1,1,()=>{f=null}),oe()),k[0].showBackground?u||(u=vs(),u.c(),u.m(t,i)):u&&(u.d(1),u=null);let O=r;r=m(k),r===O?h[r].p(k,w):(ne(),N(h[O],1,1,()=>{h[O]=null}),oe(),l=h[r],l?l.p(k,w):(l=h[r]=d[r](k),l.c()),y(l,1),l.m(t,null)),(!a||w&16)&&ce(t,"transform","translate("+k[4].x+"px, "+k[4].y+"px) rotate("+k[4].rotation+"deg) scale("+k[4].scale+")"),(!a||w&8)&&ce(e,"filter",k[3]),(!a||w&4)&&ce(e,"--reminder-opacity",k[2])},i(k){a||(y(f),y(l),a=!0)},o(k){N(f),N(l),a=!1},d(k){k&&g(e),f&&f.d(),u&&u.d(),h[r].d(),o[7](null),s=!1,$e(c)}}}function Op(o,e,t){let n,i,r,l,a,s;se(o,q,T=>t(0,l=T)),se(o,bt,T=>t(4,a=T)),se(o,ae,T=>t(5,s=T));let c,f,u=null;mt(()=>{c.clientWidth,c.clientHeight,f=new ResizeObserver(T=>{for(const E of T){const{width:R,height:H}=E.contentRect}}),f.observe(c)}),at(()=>{f.disconnect(),u==null||u.release()});async function d(){const T=!n;if(q.update(E=>({...E,keepAwake:T})),T)try{u=await navigator.wakeLock.request("screen"),u.addEventListener("release",()=>q.update(E=>({...E,keepAwake:!1})))}catch(E){console.error("Wake Lock failed:",E)}else await(u==null?void 0:u.release()),u=null}async function h(){q.update(T=>({...T,showHiddenTokens:!T.showHiddenTokens})),n||await d()}function m(T){et[T?"unshift":"push"](()=>{c=T,t(1,c)})}const k=T=>gp(T,c),w=T=>bp(T,c),O=T=>kp(T,c),I=T=>$p(T,c);return o.$$.update=()=>{o.$$.dirty&1&&(n=l.keepAwake??!1),o.$$.dirty&1&&t(3,i=l.showHiddenTokens?"none":"blur(0) brightness(0.7)"),o.$$.dirty&1&&t(2,r=l.showHiddenTokens?1:0)},[l,c,r,i,a,s,h,m,k,w,O,I]}class Rp extends ye{constructor(e){super(),we(this,e,Op,Ip,ke,{})}}function Is(o,e,t){const n=o.slice();return n[14]=e[t],n[15]=e,n[16]=t,n}function Os(o){let e,t;return e=new De({props:{show:!0,title:"Assign Names or Swap Roles",onClose:o[7],$$slots:{footer:[Mp],"footer-left":[Sp],default:[Ap]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&131079&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Tp(o){let e=o[4](o[14].roleId)+"",t;return{c(){t=C(e)},m(n,i){_(n,t,i)},p(n,i){i&4&&e!==(e=n[4](n[14].roleId)+"")&&J(t,e)},d(n){n&&g(t)}}}function Ep(o){let e;return{c(){e=C("???")},m(t,n){_(t,e,n)},p:te,d(t){t&&g(e)}}}function Dp(o){let e;function t(r,l){return r[1]?Ep:Tp}let n=t(o),i=n(o);return{c(){i.c(),e=de()},m(r,l){i.m(r,l),_(r,e,l)},p(r,l){n===(n=t(r))&&i?i.p(r,l):(i.d(1),i=n(r),i&&(i.c(),i.m(e.parentNode,e)))},d(r){r&&g(e),i.d(r)}}}function Rs(o,e){let t,n,i,r,l,a,s,c,f;function u(){return e[10](e[14])}n=new Z({props:{$$slots:{default:[Dp]},$$scope:{ctx:e}}}),n.$on("click",u);function d(){e[11].call(r,e[15],e[16])}function h(...m){return e[12](e[14],...m)}return{key:o,first:null,c(){t=$("div"),j(n.$$.fragment),i=D(),r=$("input"),l=D(),p(r,"class","name-input svelte-13vg9sk"),p(r,"type","text"),p(r,"placeholder","Enter name..."),p(t,"class",a="grid-row "+(e[0]===e[14].id?"selected":"")+" svelte-13vg9sk"),this.first=t},m(m,k){_(m,t,k),G(n,t,null),b(t,i),b(t,r),Ne(r,e[14].playerName),b(t,l),s=!0,c||(f=[ee(r,"input",d),ee(r,"input",h)],c=!0)},p(m,k){e=m;const w={};k&131078&&(w.$$scope={dirty:k,ctx:e}),n.$set(w),k&4&&r.value!==e[14].playerName&&Ne(r,e[14].playerName),(!s||k&5&&a!==(a="grid-row "+(e[0]===e[14].id?"selected":"")+" svelte-13vg9sk"))&&p(t,"class",a)},i(m){s||(y(n.$$.fragment,m),s=!0)},o(m){N(n.$$.fragment,m),s=!1},d(m){m&&g(t),F(n),c=!1,$e(f)}}}function Ap(o){let e,t=[],n=new Map,i,r=X(o[2]);const l=a=>a[14].id;for(let a=0;a<r.length;a+=1){let s=Is(o,r,a),c=l(s);n.set(c,t[a]=Rs(c,s))}return{c(){e=$("div");for(let a=0;a<t.length;a+=1)t[a].c();p(e,"class","name-assigner-grid svelte-13vg9sk")},m(a,s){_(a,e,s);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);i=!0},p(a,s){s&119&&(r=X(a[2]),ne(),t=He(t,s,l,1,a,r,n,e,Ve,Rs,null,Is),oe())},i(a){if(!i){for(let s=0;s<r.length;s+=1)y(t[s]);i=!0}},o(a){for(let s=0;s<t.length;s+=1)N(t[s]);i=!1},d(a){a&&g(e);for(let s=0;s<t.length;s+=1)t[s].d()}}}function Sp(o){let e,t,n,i,r,l;return{c(){e=$("div"),t=$("label"),n=$("input"),i=C(`
        Hide Role Names`),p(n,"type","checkbox"),p(t,"class","checkbox-label svelte-13vg9sk"),p(e,"slot","footer-left"),p(e,"class","footer-controls svelte-13vg9sk")},m(a,s){_(a,e,s),b(e,t),b(t,n),n.checked=o[1],b(t,i),r||(l=ee(n,"change",o[9]),r=!0)},p(a,s){s&2&&(n.checked=a[1])},d(a){a&&g(e),r=!1,l()}}}function Cp(o){let e;return{c(){e=C("Close")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Mp(o){let e,t,n;return t=new Z({props:{$$slots:{default:[Cp]},$$scope:{ctx:o}}}),t.$on("click",o[7]),{c(){e=$("div"),j(t.$$.fragment),p(e,"slot","footer"),p(e,"class","footer-controls svelte-13vg9sk")},m(i,r){_(i,e,r),G(t,e,null),n=!0},p(i,r){const l={};r&131072&&(l.$$scope={dirty:r,ctx:i}),t.$set(l)},i(i){n||(y(t.$$.fragment,i),n=!0)},o(i){N(t.$$.fragment,i),n=!1},d(i){i&&g(e),F(t)}}}function Lp(o){let e,t,n=o[3].showNameAssignerModal&&Os(o);return{c(){n&&n.c(),e=de()},m(i,r){n&&n.m(i,r),_(i,e,r),t=!0},p(i,[r]){i[3].showNameAssignerModal?n?(n.p(i,r),r&8&&y(n,1)):(n=Os(i),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(ne(),N(n,1,1,()=>{n=null}),oe())},i(i){t||(y(n),t=!0)},o(i){N(n),t=!1},d(i){i&&g(e),n&&n.d(i)}}}function Up(o,e,t){let n,i,r,l;se(o,Re,O=>t(13,i=O)),se(o,ae,O=>t(8,r=O)),se(o,q,O=>t(3,l=O));let a=null,s=!0;function c(O){const I=i==null?void 0:i[O];return I?I.name:"(No role)"}function f(O){a===null?t(0,a=O):(a===O||Ea(a,O),t(0,a=null))}function u(O,I){ae.update(T=>({...T,playerTokens:T.playerTokens.map(E=>E.id===O?{...E,playerName:I}:E)}))}function d(){q.update(O=>({...O,showNameAssignerModal:!1}))}function h(){s=this.checked,t(1,s)}const m=O=>f(O.id);function k(O,I){O[I].playerName=this.value,t(2,n),t(8,r)}const w=(O,I)=>u(O.id,I.currentTarget.value);return o.$$.update=()=>{o.$$.dirty&256&&t(2,n=r.playerTokens??[])},[a,s,n,l,c,f,u,d,r,h,m,k,w]}class Pp extends ye{constructor(e){super(),we(this,e,Up,Lp,ke,{})}}function Bp(o){let e;return{c(){e=C("Show")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Yp(o){let e;return{c(){e=C("Hide")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Hp(o){let e,t,n;function i(a,s){return a[7]?Yp:Bp}let r=i(o),l=r(o);return{c(){e=$("span"),e.textContent="🙈",t=D(),l.c(),n=C(" Nametags"),p(e,"class","btn-icon svelte-5f1pd8")},m(a,s){_(a,e,s),_(a,t,s),l.m(a,s),_(a,n,s)},p(a,s){r!==(r=i(a))&&(l.d(1),l=r(a),l&&(l.c(),l.m(n.parentNode,n)))},d(a){a&&(g(e),g(t),g(n)),l.d(a)}}}function Gp(o){let e;return{c(){e=C("Show")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Fp(o){let e;return{c(){e=C("Hide")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function jp(o){let e,t,n;function i(a,s){return a[6]?Fp:Gp}let r=i(o),l=r(o);return{c(){e=$("span"),e.textContent="🙊",t=D(),l.c(),n=C(" Role names"),p(e,"class","btn-icon svelte-5f1pd8")},m(a,s){_(a,e,s),_(a,t,s),l.m(a,s),_(a,n,s)},p(a,s){r!==(r=i(a))&&(l.d(1),l=r(a),l&&(l.c(),l.m(n.parentNode,n)))},d(a){a&&(g(e),g(t),g(n)),l.d(a)}}}function zp(o){let e;return{c(){e=C("Show")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Kp(o){let e;return{c(){e=C("Hide")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Wp(o){let e,t,n;function i(a,s){return a[5]?Kp:zp}let r=i(o),l=r(o);return{c(){e=$("span"),e.textContent="🏷️",t=D(),l.c(),n=C(" Ability tags"),p(e,"class","btn-icon svelte-5f1pd8")},m(a,s){_(a,e,s),_(a,t,s),l.m(a,s),_(a,n,s)},p(a,s){r!==(r=i(a))&&(l.d(1),l=r(a),l&&(l.c(),l.m(n.parentNode,n)))},d(a){a&&(g(e),g(t),g(n)),l.d(a)}}}function qp(o){let e;return{c(){e=C("Show")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Vp(o){let e;return{c(){e=C("Hide")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Xp(o){let e,t,n;function i(a,s){return a[4]?Vp:qp}let r=i(o),l=r(o);return{c(){e=$("span"),e.textContent="🌙",t=D(),l.c(),n=C(" Night-order Lines"),p(e,"class","btn-icon svelte-5f1pd8")},m(a,s){_(a,e,s),_(a,t,s),l.m(a,s),_(a,n,s)},p(a,s){r!==(r=i(a))&&(l.d(1),l=r(a),l&&(l.c(),l.m(n.parentNode,n)))},d(a){a&&(g(e),g(t),g(n)),l.d(a)}}}function Jp(o){let e;return{c(){e=C("Show")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Zp(o){let e;return{c(){e=C("Hide")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Qp(o){let e,t,n;function i(a,s){return a[3]?Zp:Jp}let r=i(o),l=r(o);return{c(){e=$("span"),e.textContent="🔕",t=D(),l.c(),n=C(" Reminder Lines"),p(e,"class","btn-icon svelte-5f1pd8")},m(a,s){_(a,e,s),_(a,t,s),l.m(a,s),_(a,n,s)},p(a,s){r!==(r=i(a))&&(l.d(1),l=r(a),l&&(l.c(),l.m(n.parentNode,n)))},d(a){a&&(g(e),g(t),g(n)),l.d(a)}}}function xp(o){let e;return{c(){e=C("Show")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function eg(o){let e;return{c(){e=C("Hide")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function tg(o){let e,t,n;function i(a,s){return a[2]?eg:xp}let r=i(o),l=r(o);return{c(){e=$("span"),e.textContent="🖼️",t=D(),l.c(),n=C(" Background"),p(e,"class","btn-icon svelte-5f1pd8")},m(a,s){_(a,e,s),_(a,t,s),l.m(a,s),_(a,n,s)},p(a,s){r!==(r=i(a))&&(l.d(1),l=r(a),l&&(l.c(),l.m(n.parentNode,n)))},d(a){a&&(g(e),g(t),g(n)),l.d(a)}}}function ng(o){let e,t;return{c(){e=$("span"),e.textContent="🖥️",t=C(`
      Toggle Fullscreen`),p(e,"class","btn-icon svelte-5f1pd8")},m(n,i){_(n,e,i),_(n,t,i)},p:te,d(n){n&&(g(e),g(t))}}}function og(o){let e;return{c(){e=C("Enable")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function ig(o){let e;return{c(){e=C("Disable")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function rg(o){let e,t,n;function i(a,s){return a[1]?ig:og}let r=i(o),l=r(o);return{c(){e=$("span"),e.textContent="☕️",t=D(),l.c(),n=C(" Screen Awake"),p(e,"class","btn-icon svelte-5f1pd8")},m(a,s){_(a,e,s),_(a,t,s),l.m(a,s),_(a,n,s)},p(a,s){r!==(r=i(a))&&(l.d(1),l=r(a),l&&(l.c(),l.m(n.parentNode,n)))},d(a){a&&(g(e),g(t),g(n)),l.d(a)}}}function lg(o){let e,t;return{c(){e=$("span"),e.textContent="🧑‍🤝‍🧑",t=C(`
      Open Name Assigner`),p(e,"class","btn-icon svelte-5f1pd8")},m(n,i){_(n,e,i),_(n,t,i)},p:te,d(n){n&&(g(e),g(t))}}}function sg(o){let e,t;return{c(){e=$("span"),e.textContent="🧑‍🤝‍🧑",t=C(`
      Open Player Arrangement`),p(e,"class","btn-icon svelte-5f1pd8")},m(n,i){_(n,e,i),_(n,t,i)},p:te,d(n){n&&(g(e),g(t))}}}function ag(o){let e;return{c(){e=C("Show")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function cg(o){let e;return{c(){e=C("Hide")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function fg(o){let e,t,n;function i(a,s){return a[0].showHiddenTokens?cg:ag}let r=i(o),l=r(o);return{c(){e=$("span"),e.textContent="🎭",t=D(),l.c(),n=C(" Hidden Roles"),p(e,"class","btn-icon svelte-5f1pd8")},m(a,s){_(a,e,s),_(a,t,s),l.m(a,s),_(a,n,s)},p(a,s){r!==(r=i(a))&&(l.d(1),l=r(a),l&&(l.c(),l.m(n.parentNode,n)))},d(a){a&&(g(e),g(t),g(n)),l.d(a)}}}function ug(o){let e;return{c(){e=C("Open Notes")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function dg(o){let e,t,n,i,r,l,a,s,c,f,u,d,h,m,k,w,O,I,T,E,R,H,A,M,U;return t=new Z({props:{$$slots:{default:[Hp]},$$scope:{ctx:o}}}),t.$on("click",o[10]),i=new Z({props:{$$slots:{default:[jp]},$$scope:{ctx:o}}}),i.$on("click",o[11]),l=new Z({props:{$$slots:{default:[Wp]},$$scope:{ctx:o}}}),l.$on("click",o[12]),s=new Z({props:{$$slots:{default:[Xp]},$$scope:{ctx:o}}}),s.$on("click",o[13]),f=new Z({props:{$$slots:{default:[Qp]},$$scope:{ctx:o}}}),f.$on("click",o[14]),d=new Z({props:{$$slots:{default:[tg]},$$scope:{ctx:o}}}),d.$on("click",o[15]),m=new Z({props:{$$slots:{default:[ng]},$$scope:{ctx:o}}}),m.$on("click",gg),w=new Z({props:{$$slots:{default:[rg]},$$scope:{ctx:o}}}),w.$on("click",o[17]),I=new Z({props:{$$slots:{default:[lg]},$$scope:{ctx:o}}}),I.$on("click",o[18]),E=new Z({props:{$$slots:{default:[sg]},$$scope:{ctx:o}}}),E.$on("click",o[19]),H=new Z({props:{$$slots:{default:[fg]},$$scope:{ctx:o}}}),H.$on("click",o[16]),M=new Z({props:{$$slots:{default:[ug]},$$scope:{ctx:o}}}),M.$on("click",o[21]),{c(){e=$("div"),j(t.$$.fragment),n=D(),j(i.$$.fragment),r=D(),j(l.$$.fragment),a=D(),j(s.$$.fragment),c=D(),j(f.$$.fragment),u=D(),j(d.$$.fragment),h=D(),j(m.$$.fragment),k=D(),j(w.$$.fragment),O=D(),j(I.$$.fragment),T=D(),j(E.$$.fragment),R=D(),j(H.$$.fragment),A=D(),j(M.$$.fragment),p(e,"class","settings-content svelte-5f1pd8")},m(v,Y){_(v,e,Y),G(t,e,null),b(e,n),G(i,e,null),b(e,r),G(l,e,null),b(e,a),G(s,e,null),b(e,c),G(f,e,null),b(e,u),G(d,e,null),b(e,h),G(m,e,null),b(e,k),G(w,e,null),b(e,O),G(I,e,null),b(e,T),G(E,e,null),b(e,R),G(H,e,null),b(e,A),G(M,e,null),U=!0},p(v,Y){const W={};Y&16777344&&(W.$$scope={dirty:Y,ctx:v}),t.$set(W);const z={};Y&16777280&&(z.$$scope={dirty:Y,ctx:v}),i.$set(z);const B={};Y&16777248&&(B.$$scope={dirty:Y,ctx:v}),l.$set(B);const L={};Y&16777232&&(L.$$scope={dirty:Y,ctx:v}),s.$set(L);const S={};Y&16777224&&(S.$$scope={dirty:Y,ctx:v}),f.$set(S);const P={};Y&16777220&&(P.$$scope={dirty:Y,ctx:v}),d.$set(P);const K={};Y&16777216&&(K.$$scope={dirty:Y,ctx:v}),m.$set(K);const V={};Y&16777218&&(V.$$scope={dirty:Y,ctx:v}),w.$set(V);const le={};Y&16777216&&(le.$$scope={dirty:Y,ctx:v}),I.$set(le);const he={};Y&16777216&&(he.$$scope={dirty:Y,ctx:v}),E.$set(he);const _e={};Y&16777217&&(_e.$$scope={dirty:Y,ctx:v}),H.$set(_e);const Ie={};Y&16777216&&(Ie.$$scope={dirty:Y,ctx:v}),M.$set(Ie)},i(v){U||(y(t.$$.fragment,v),y(i.$$.fragment,v),y(l.$$.fragment,v),y(s.$$.fragment,v),y(f.$$.fragment,v),y(d.$$.fragment,v),y(m.$$.fragment,v),y(w.$$.fragment,v),y(I.$$.fragment,v),y(E.$$.fragment,v),y(H.$$.fragment,v),y(M.$$.fragment,v),U=!0)},o(v){N(t.$$.fragment,v),N(i.$$.fragment,v),N(l.$$.fragment,v),N(s.$$.fragment,v),N(f.$$.fragment,v),N(d.$$.fragment,v),N(m.$$.fragment,v),N(w.$$.fragment,v),N(I.$$.fragment,v),N(E.$$.fragment,v),N(H.$$.fragment,v),N(M.$$.fragment,v),U=!1},d(v){v&&g(e),F(t),F(i),F(l),F(s),F(f),F(d),F(m),F(w),F(I),F(E),F(H),F(M)}}}function hg(o){let e;return{c(){e=C("Close")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function mg(o){let e,t;return e=new Z({props:{$$slots:{default:[hg]},$$scope:{ctx:o}}}),e.$on("click",o[9]),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&16777216&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function pg(o){let e,t,n,i,r,l;return e=new Pp({}),n=new Aa({props:{show:o[0].showArrangePlayersModal,onClose:o[20]}}),r=new De({props:{show:o[8],title:"Settings",onClose:o[9],$$slots:{footer:[mg],default:[dg]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment),t=D(),j(n.$$.fragment),i=D(),j(r.$$.fragment)},m(a,s){G(e,a,s),_(a,t,s),G(n,a,s),_(a,i,s),G(r,a,s),l=!0},p(a,[s]){const c={};s&1&&(c.show=a[0].showArrangePlayersModal),n.$set(c);const f={};s&256&&(f.show=a[8]),s&16777471&&(f.$$scope={dirty:s,ctx:a}),r.$set(f)},i(a){l||(y(e.$$.fragment,a),y(n.$$.fragment,a),y(r.$$.fragment,a),l=!0)},o(a){N(e.$$.fragment,a),N(n.$$.fragment,a),N(r.$$.fragment,a),l=!1},d(a){a&&(g(t),g(i)),F(e,a),F(n,a),F(r,a)}}}function gg(){document.fullscreenElement?document.exitFullscreen().catch(console.error):document.documentElement.requestFullscreen().catch(console.error)}function _g(o,e,t){let n,i,r,l,a,s,c,f,u;se(o,q,v=>t(0,u=v));let d=null;function h(){q.update(v=>({...v,showSettingsModal:!1}))}function m(){q.update(v=>({...v,showNametags:!v.showNametags}))}function k(){q.update(v=>({...v,showRolenames:!v.showRolenames}))}function w(){q.update(v=>({...v,showAbilityTags:!v.showAbilityTags}))}function O(){q.update(v=>({...v,showNightLines:!v.showNightLines}))}function I(){q.update(v=>({...v,showReminderLines:!v.showReminderLines}))}function T(){q.update(v=>({...v,showBackground:!v.showBackground}))}async function E(){q.update(v=>({...v,showHiddenTokens:!v.showHiddenTokens}))}async function R(){const v=!c;if(q.update(Y=>({...Y,keepAwake:v})),v)try{d=await navigator.wakeLock.request("screen"),d.addEventListener("release",()=>q.update(Y=>({...Y,keepAwake:!1})))}catch(Y){console.error("Wake Lock failed:",Y)}else await(d==null?void 0:d.release()),d=null}function H(){q.update(v=>({...v,showNameAssignerModal:!0}))}function A(){q.update(v=>({...v,showArrangePlayersModal:!0}))}at(()=>{d==null||d.release()});const M=()=>q.update(v=>({...v,showArrangePlayersModal:!1})),U=()=>q.update(v=>({...v,showNotesModal:!0}));return o.$$.update=()=>{o.$$.dirty&1&&t(8,n=u.showSettingsModal),o.$$.dirty&1&&t(7,i=u.showNametags),o.$$.dirty&1&&t(6,r=u.showRolenames),o.$$.dirty&1&&t(5,l=u.showAbilityTags),o.$$.dirty&1&&t(4,a=u.showNightLines),o.$$.dirty&1&&t(3,s=u.showReminderLines),o.$$.dirty&1&&t(1,c=u.keepAwake??!1),o.$$.dirty&1&&t(2,f=u.showBackground),o.$$.dirty&1&&u.activeSessionUuid},[u,c,f,s,a,l,r,i,n,h,m,k,w,O,I,T,E,R,H,A,M,U]}class bg extends ye{constructor(e){super(),we(this,e,_g,pg,ke,{})}}function kg(o){let e,t,n,i,r,l,a;return i=new bg({}),{c(){e=$("div"),t=$("button"),t.textContent="⚙",n=D(),j(i.$$.fragment),p(t,"class","settings-button svelte-l4qw6x"),p(e,"class","settings-fab svelte-l4qw6x")},m(s,c){_(s,e,c),b(e,t),_(s,n,c),G(i,s,c),r=!0,l||(a=ee(t,"click",o[0]),l=!0)},p:te,i(s){r||(y(i.$$.fragment,s),r=!0)},o(s){N(i.$$.fragment,s),r=!1},d(s){s&&(g(e),g(n)),F(i,s),l=!1,a()}}}function wg(o){return[()=>q.update(t=>({...t,showSettingsModal:!0}))]}class yg extends ye{constructor(e){super(),we(this,e,wg,kg,ke,{})}}function Ts(o,e,t){const n=o.slice();return n[27]=e[t].playerId,n[28]=e[t].roleId,n[30]=t,n}function Es(o){let e,t;return e=new De({props:{show:!0,fullscreen:!0,showFooterInFullscreen:!0,backdropClosable:!0,focusmodeAllowed:!1,title:"",onClose:o[11],$$slots:{footer:[Dg],default:[Tg]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i[0]&2015|i[1]&1&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function $g(o){let e;return{c(){e=$("p"),e.textContent="Storyteller only: Tap outside to exit",p(e,"class","info svelte-15x2c4n")},m(t,n){_(t,e,n)},p:te,i:te,o:te,d(t){t&&g(e)}}}function vg(o){let e,t,n=[],i=new Map,r;function l(u,d){return u[2]?Ng:Ig}let a=l(o),s=a(o),c=X(o[3]);const f=u=>u[27];for(let u=0;u<c.length;u+=1){let d=Ts(o,c,u),h=f(d);i.set(h,n[u]=Ds(h,d))}return{c(){s.c(),e=D(),t=$("div");for(let u=0;u<n.length;u+=1)n[u].c();p(t,"class","stack-container svelte-15x2c4n")},m(u,d){s.m(u,d),_(u,e,d),_(u,t,d);for(let h=0;h<n.length;h+=1)n[h]&&n[h].m(t,null);r=!0},p(u,d){a!==(a=l(u))&&(s.d(1),s=a(u),s&&(s.c(),s.m(e.parentNode,e))),d[0]&6107&&(c=X(u[3]),ne(),n=He(n,d,f,1,u,c,i,t,Ve,Ds,null,Ts),oe())},i(u){if(!r){for(let d=0;d<c.length;d+=1)y(n[d]);r=!0}},o(u){for(let d=0;d<n.length;d+=1)N(n[d]);r=!1},d(u){u&&(g(e),g(t)),s.d(u);for(let d=0;d<n.length;d+=1)n[d].d()}}}function Ng(o){let e;return{c(){e=$("p"),e.textContent="Swipe when you have seen your role",p(e,"class","info svelte-15x2c4n")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Ig(o){let e;return{c(){e=$("p"),e.textContent="Pull or tap to see your role",p(e,"class","info svelte-15x2c4n")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Og(o){let e,t,n;return{c(){e=$("div"),t=$("div"),t.innerHTML="<span>?</span>",n=D(),p(t,"class","back-side svelte-15x2c4n"),p(e,"class","card svelte-15x2c4n"),ce(e,"transform","translate(-50%, -50%) translateX("+o[8][o[30]].dx+"px) translateY("+o[8][o[30]].dy+"px) translateZ("+o[30]*-2+"px) rotateZ("+o[8][o[30]].rot+"deg)"),ce(e,"z-index",o[3].length-o[30])},m(i,r){_(i,e,r),b(e,t),b(e,n)},p(i,r){r[0]&264&&ce(e,"transform","translate(-50%, -50%) translateX("+i[8][i[30]].dx+"px) translateY("+i[8][i[30]].dy+"px) translateZ("+i[30]*-2+"px) rotateZ("+i[8][i[30]].rot+"deg)"),r[0]&8&&ce(e,"z-index",i[3].length-i[30])},i:te,o:te,d(i){i&&g(e)}}}function Rg(o){let e,t,n,i,r,l,a,s,c;return r=new Ut({props:{role:o[4][o[28]],size:"big"}}),{c(){e=$("div"),t=$("div"),t.innerHTML="<span>?</span>",n=D(),i=$("div"),j(r.$$.fragment),l=D(),p(t,"class","back-side svelte-15x2c4n"),p(i,"class","face-side svelte-15x2c4n"),ce(i,"opacity",o[9]),ce(i,"transform","rotate3d("+o[6]+", "+o[7]+", 0, 180deg)"),p(e,"class","card active svelte-15x2c4n"),ce(e,"transform","translate(-50%, -50%) translateX("+(o[8][o[30]].dx+o[0])+"px) translateY("+(o[8][o[30]].dy+o[1])+"px) translateZ("+o[30]*-2+"px) rotate3d("+o[6]+", "+o[7]+", 0, "+o[10]+"deg)"),ce(e,"z-index",o[3].length)},m(f,u){_(f,e,u),b(e,t),b(e,n),b(e,i),G(r,i,null),b(e,l),a=!0,s||(c=ee(e,"pointerdown",o[12]),s=!0)},p(f,u){const d={};u[0]&24&&(d.role=f[4][f[28]]),r.$set(d),(!a||u[0]&512)&&ce(i,"opacity",f[9]),(!a||u[0]&192)&&ce(i,"transform","rotate3d("+f[6]+", "+f[7]+", 0, 180deg)"),(!a||u[0]&1483)&&ce(e,"transform","translate(-50%, -50%) translateX("+(f[8][f[30]].dx+f[0])+"px) translateY("+(f[8][f[30]].dy+f[1])+"px) translateZ("+f[30]*-2+"px) rotate3d("+f[6]+", "+f[7]+", 0, "+f[10]+"deg)"),(!a||u[0]&8)&&ce(e,"z-index",f[3].length)},i(f){a||(y(r.$$.fragment,f),a=!0)},o(f){N(r.$$.fragment,f),a=!1},d(f){f&&g(e),F(r),s=!1,c()}}}function Ds(o,e){let t,n,i,r,l;const a=[Rg,Og],s=[];function c(f,u){return f[30]===0?0:1}return n=c(e),i=s[n]=a[n](e),{key:o,first:null,c(){t=de(),i.c(),r=de(),this.first=t},m(f,u){_(f,t,u),s[n].m(f,u),_(f,r,u),l=!0},p(f,u){e=f;let d=n;n=c(e),n===d?s[n].p(e,u):(ne(),N(s[d],1,1,()=>{s[d]=null}),oe(),i=s[n],i?i.p(e,u):(i=s[n]=a[n](e),i.c()),y(i,1),i.m(r.parentNode,r))},i(f){l||(y(i),l=!0)},o(f){N(i),l=!1},d(f){f&&(g(t),g(r)),s[n].d(f)}}}function Tg(o){let e,t,n,i,r,l;const a=[vg,$g],s=[];function c(f,u){return f[3].length>0?0:1}return i=c(o),r=s[i]=a[i](o),{c(){e=$("div"),t=$("h2"),t.textContent="Token Bag",n=D(),r.c(),p(t,"class","sr-only svelte-15x2c4n"),p(e,"class","tokenbag-body svelte-15x2c4n")},m(f,u){_(f,e,u),b(e,t),b(e,n),s[i].m(e,null),l=!0},p(f,u){let d=i;i=c(f),i===d?s[i].p(f,u):(ne(),N(s[d],1,1,()=>{s[d]=null}),oe(),r=s[i],r?r.p(f,u):(r=s[i]=a[i](f),r.c()),y(r,1),r.m(e,null))},i(f){l||(y(r),l=!0)},o(f){N(r),l=!1},d(f){f&&g(e),s[i].d()}}}function Eg(o){let e;return{c(){e=C("Exit Token Bag")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Dg(o){let e,t;return e=new Z({props:{type:"cancel",$$slots:{default:[Eg]},$$scope:{ctx:o}}}),e.$on("click",o[11]),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i[1]&1&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Ag(o){let e,t,n=o[5]&&Es(o);return{c(){n&&n.c(),e=de()},m(i,r){n&&n.m(i,r),_(i,e,r),t=!0},p(i,r){i[5]?n?(n.p(i,r),r[0]&32&&y(n,1)):(n=Es(i),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(ne(),N(n,1,1,()=>{n=null}),oe())},i(i){t||(y(n),t=!0)},o(i){N(n),t=!1},d(i){i&&g(e),n&&n.d(i)}}}const As=1,nn=150,Sg=10,Ss=0,Cg=0;function Mg(o,e,t){let n,i,r,l,a,s,c,f,u;se(o,q,B=>t(15,f=B)),se(o,ae,B=>t(16,u=B));let d,h,m=0,k=0,w=!1,O=!1,I=!1,T=!1,E=0,R=1,H=null;function A(){q.update(B=>({...B,showTokenBagModal:!1})),M(),t(2,T=!1)}function M(){w=!1,t(0,m=t(1,k=0)),O=!1,I=!1}function U(B){B.stopPropagation(),B.preventDefault();const L=B.currentTarget;L.setPointerCapture(B.pointerId),H=L,w=!0,O=!1,I=!1,d=B.clientX,h=B.clientY,window.addEventListener("pointermove",v,{passive:!1}),window.addEventListener("pointerup",Y)}function v(B){if(!w)return;const L=B.clientX-d,S=B.clientY-h,P=Math.hypot(L,S);!O&&P<Sg||(O||(O=!0,!T&&P>0&&(t(6,E=S/P),t(7,R=-L/P))),t(0,m=L*As),t(1,k=S*As),!I&&P>=nn&&(I=!0,T?(window.removeEventListener("pointermove",v),window.removeEventListener("pointerup",Y),setTimeout(W,200)):(t(2,T=!0),t(0,m=t(1,k=0)),window.removeEventListener("pointermove",v))))}function Y(B){H&&(H.releasePointerCapture(B.pointerId),H=null),window.removeEventListener("pointermove",v),window.removeEventListener("pointerup",Y);const L=Math.hypot(m,k);if(!O){T?W():t(2,T=!0),M();return}T?L>nn&&W():L>nn/4&&t(2,T=!0),M()}function W(){const[B]=a;B&&(q.update(L=>({...L,tokenBagSwiped:[...L.tokenBagSwiped,B.playerId]})),t(2,T=!1),M())}let z=[];return at(()=>{H&&(H=null),M(),t(2,T=!1)}),o.$$.update=()=>{o.$$.dirty[0]&32768&&t(5,n=f.showTokenBagModal),o.$$.dirty[0]&32&&n&&q.update(B=>({...B,showHiddenTokens:!1})),o.$$.dirty[0]&65536&&t(14,i=u.playerTokens.map((B,L)=>({playerId:String(B.id??L),roleId:B.roleId}))),o.$$.dirty[0]&32768&&t(13,r=f.tokenBagSwiped),o.$$.dirty[0]&24592&&t(3,a=i.filter(({playerId:B})=>!r.includes(B)).filter(({roleId:B})=>{var S;const L=(S=l[B])==null?void 0:S.category;return L!=="Traveller"&&L!=="Fabled"})),o.$$.dirty[0]&7&&t(10,s=T?180:Math.min(Math.hypot(m,k)/nn*180,180)),o.$$.dirty[0]&7&&t(9,c=T?1-Math.min(Math.hypot(m,k)/nn,1):1),o.$$.dirty[0]&8&&a&&t(8,z=a.map(()=>({dx:(Math.random()*2-1)*Ss,dy:(Math.random()*2-1)*Ss,rot:(Math.random()*2-1)*Cg})))},t(4,l=re(Re)),[m,k,T,a,l,n,E,R,z,c,s,A,U,r,i,f,u]}class Lg extends ye{constructor(e){super(),we(this,e,Mg,Ag,ke,{},null,[-1,-1])}}function Cs(o,e,t){const n=o.slice();return n[45]=e[t],n[47]=t,n}function Ug(o){let e;return{c(){e=C(o[13])},m(t,n){_(t,e,n)},p(t,n){n[0]&8192&&J(e,t[13])},d(t){t&&g(e)}}}function Pg(o){let e,t,n;return{c(){e=C("Welcome to"),t=$("br"),n=C("Smart Grimoire!")},m(i,r){_(i,e,r),_(i,t,r),_(i,n,r)},p:te,d(i){i&&(g(e),g(t),g(n))}}}function Ms(o){let e,t,n,i;return{c(){e=$("br"),t=D(),n=$("span"),i=C(o[12]),p(n,"class","info svelte-1tuc7xf")},m(r,l){_(r,e,l),_(r,t,l),_(r,n,l),b(n,i)},p(r,l){l[0]&4096&&J(i,r[12])},d(r){r&&(g(e),g(t),g(n))}}}function Ls(o){let e,t,n,i;const r=[Yg,Bg],l=[];function a(s,c){return s[10]?0:1}return e=a(o),t=l[e]=r[e](o),{c(){t.c(),n=de()},m(s,c){l[e].m(s,c),_(s,n,c),i=!0},p(s,c){let f=e;e=a(s),e===f?l[e].p(s,c):(ne(),N(l[f],1,1,()=>{l[f]=null}),oe(),t=l[e],t?t.p(s,c):(t=l[e]=r[e](s),t.c()),y(t,1),t.m(n.parentNode,n))},i(s){i||(y(t),i=!0)},o(s){N(t),i=!1},d(s){s&&g(n),l[e].d(s)}}}function Bg(o){let e,t,n,i,r,l,a,s,c=o[7]&&Us(o);t=new Z({props:{$$slots:{default:[Hg]},$$scope:{ctx:o}}}),t.$on("click",o[20]);let f=o[9]&&Ps(o),u=o[8]&&Bs(o),d=o[11]&&Ys(o),h=o[8]&&Hs(o);return{c(){c&&c.c(),e=D(),j(t.$$.fragment),n=D(),f&&f.c(),i=D(),u&&u.c(),r=D(),d&&d.c(),l=D(),h&&h.c(),a=de()},m(m,k){c&&c.m(m,k),_(m,e,k),G(t,m,k),_(m,n,k),f&&f.m(m,k),_(m,i,k),u&&u.m(m,k),_(m,r,k),d&&d.m(m,k),_(m,l,k),h&&h.m(m,k),_(m,a,k),s=!0},p(m,k){m[7]?c?c.p(m,k):(c=Us(m),c.c(),c.m(e.parentNode,e)):c&&(c.d(1),c=null);const w={};k[0]&64|k[1]&131072&&(w.$$scope={dirty:k,ctx:m}),t.$set(w),m[9]?f?k[0]&512&&y(f,1):(f=Ps(m),f.c(),y(f,1),f.m(i.parentNode,i)):f&&(ne(),N(f,1,1,()=>{f=null}),oe()),m[8]?u?u.p(m,k):(u=Bs(m),u.c(),u.m(r.parentNode,r)):u&&(u.d(1),u=null),m[11]?d?d.p(m,k):(d=Ys(m),d.c(),d.m(l.parentNode,l)):d&&(d.d(1),d=null),m[8]?h?(h.p(m,k),k[0]&256&&y(h,1)):(h=Hs(m),h.c(),y(h,1),h.m(a.parentNode,a)):h&&(ne(),N(h,1,1,()=>{h=null}),oe())},i(m){s||(y(t.$$.fragment,m),y(f),y(h),s=!0)},o(m){N(t.$$.fragment,m),N(f),N(h),s=!1},d(m){m&&(g(e),g(n),g(i),g(r),g(l),g(a)),c&&c.d(m),F(t,m),f&&f.d(m),u&&u.d(m),d&&d.d(m),h&&h.d(m)}}}function Yg(o){let e,t,n,i,r;function l(c,f){if(c[2]<Xt)return qg;if(c[0]==="preparation")return Wg}let a=l(o),s=a&&a(o);return t=new Z({props:{$$slots:{default:[Vg]},$$scope:{ctx:o}}}),t.$on("click",o[20]),i=new Z({props:{$$slots:{default:[Xg]},$$scope:{ctx:o}}}),i.$on("click",o[31]),{c(){s&&s.c(),e=D(),j(t.$$.fragment),n=D(),j(i.$$.fragment)},m(c,f){s&&s.m(c,f),_(c,e,f),G(t,c,f),_(c,n,f),G(i,c,f),r=!0},p(c,f){a===(a=l(c))&&s?s.p(c,f):(s&&s.d(1),s=a&&a(c),s&&(s.c(),s.m(e.parentNode,e)));const u={};f[0]&64|f[1]&131072&&(u.$$scope={dirty:f,ctx:c}),t.$set(u);const d={};f[1]&131072&&(d.$$scope={dirty:f,ctx:c}),i.$set(d)},i(c){r||(y(t.$$.fragment,c),y(i.$$.fragment,c),r=!0)},o(c){N(t.$$.fragment,c),N(i.$$.fragment,c),r=!1},d(c){c&&(g(e),g(n)),s&&s.d(c),F(t,c),F(i,c)}}}function Us(o){let e,t;return{c(){e=$("p"),t=C(o[7]),p(e,"class","info svelte-1tuc7xf")},m(n,i){_(n,e,i),b(e,t)},p(n,i){i[0]&128&&J(t,n[7])},d(n){n&&g(e)}}}function Hg(o){let e;return{c(){e=C(o[6])},m(t,n){_(t,e,n)},p(t,n){n[0]&64&&J(e,t[6])},d(t){t&&g(e)}}}function Ps(o){let e,t;return e=new Z({props:{$$slots:{default:[Gg]},$$scope:{ctx:o}}}),e.$on("click",o[32]),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Gg(o){let e;return{c(){e=C("Night Order & Cards")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Bs(o){let e,t,n,i,r;return{c(){e=$("p"),t=C(o[1]),n=C(" Alive — "),i=C(o[14]),r=C(" Votes Required"),p(e,"class","info svelte-1tuc7xf")},m(l,a){_(l,e,a),b(e,t),b(e,n),b(e,i),b(e,r)},p(l,a){a[0]&2&&J(t,l[1]),a[0]&16384&&J(i,l[14])},d(l){l&&g(e)}}}function Ys(o){let e,t=o[11].text+"",n;return{c(){e=$("p"),n=C(t),p(e,"class","info svelte-1tuc7xf"),ce(e,"color",o[11].color)},m(i,r){_(i,e,r),b(e,n)},p(i,r){r[0]&2048&&t!==(t=i[11].text+"")&&J(n,t),r[0]&2048&&ce(e,"color",i[11].color)},d(i){i&&g(e)}}}function Hs(o){let e,t,n,i;t=new Z({props:{$$slots:{default:[Fg]},$$scope:{ctx:o}}}),t.$on("click",o[15]);let r=X(o[5]),l=[];for(let s=0;s<r.length;s+=1)l[s]=Gs(Cs(o,r,s));const a=s=>N(l[s],1,1,()=>{l[s]=null});return{c(){e=$("div"),j(t.$$.fragment),n=D();for(let s=0;s<l.length;s+=1)l[s].c();p(e,"class","tally-panel svelte-1tuc7xf")},m(s,c){_(s,e,c),G(t,e,null),b(e,n);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(e,null);i=!0},p(s,c){const f={};if(c[1]&131072&&(f.$$scope={dirty:c,ctx:s}),t.$set(f),c[0]&458784){r=X(s[5]);let u;for(u=0;u<r.length;u+=1){const d=Cs(s,r,u);l[u]?(l[u].p(d,c),y(l[u],1)):(l[u]=Gs(d),l[u].c(),y(l[u],1),l[u].m(e,null))}for(ne(),u=r.length;u<l.length;u+=1)a(u);oe()}},i(s){if(!i){y(t.$$.fragment,s);for(let c=0;c<r.length;c+=1)y(l[c]);i=!0}},o(s){N(t.$$.fragment,s),l=l.filter(Boolean);for(let c=0;c<l.length;c+=1)N(l[c]);i=!1},d(s){s&&g(e),F(t),me(l,s)}}}function Fg(o){let e;return{c(){e=C("Add vote counter")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function jg(o){let e;return{c(){e=C("-")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function zg(o){let e;return{c(){e=C("+")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Kg(o){let e;return{c(){e=C("×")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Gs(o){let e,t,n,i,r=o[45]+"",l,a,s,c,f,u,d;function h(){return o[33](o[47])}t=new Z({props:{$$slots:{default:[jg]},$$scope:{ctx:o}}}),t.$on("click",h);function m(){return o[34](o[47])}s=new Z({props:{$$slots:{default:[zg]},$$scope:{ctx:o}}}),s.$on("click",m);function k(){return o[35](o[47])}return f=new Z({props:{$$slots:{default:[Kg]},$$scope:{ctx:o}}}),f.$on("click",k),{c(){e=$("div"),j(t.$$.fragment),n=D(),i=$("span"),l=C(r),a=D(),j(s.$$.fragment),c=D(),j(f.$$.fragment),u=D(),p(i,"class","count svelte-1tuc7xf"),p(e,"class","tally-row svelte-1tuc7xf")},m(w,O){_(w,e,O),G(t,e,null),b(e,n),b(e,i),b(i,l),b(e,a),G(s,e,null),b(e,c),G(f,e,null),b(e,u),d=!0},p(w,O){o=w;const I={};O[1]&131072&&(I.$$scope={dirty:O,ctx:o}),t.$set(I),(!d||O[0]&32)&&r!==(r=o[45]+"")&&J(l,r);const T={};O[1]&131072&&(T.$$scope={dirty:O,ctx:o}),s.$set(T);const E={};O[1]&131072&&(E.$$scope={dirty:O,ctx:o}),f.$set(E)},i(w){d||(y(t.$$.fragment,w),y(s.$$.fragment,w),y(f.$$.fragment,w),d=!0)},o(w){N(t.$$.fragment,w),N(s.$$.fragment,w),N(f.$$.fragment,w),d=!1},d(w){w&&g(e),F(t),F(s),F(f)}}}function Wg(o){let e;return{c(){e=$("p"),e.textContent="Final preparations: Assign reminder tokens and organize Grimoire.",p(e,"class","info svelte-1tuc7xf")},m(t,n){_(t,e,n)},p:te,d(t){t&&g(e)}}}function qg(o){let e;return{c(){e=$("p"),e.textContent=`Open the Setup panel and add ${Xt} or more players to continue.`,p(e,"class","info svelte-1tuc7xf")},m(t,n){_(t,e,n)},p:te,d(t){t&&g(e)}}}function Vg(o){let e;return{c(){e=C(o[6])},m(t,n){_(t,e,n)},p(t,n){n[0]&64&&J(e,t[6])},d(t){t&&g(e)}}}function Xg(o){let e;return{c(){e=C("Setup")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function Jg(o){let e,t,n,i,r,l,a,s;function c(m,k){return m[2]<Xt?Pg:Ug}let f=c(o),u=f(o),d=o[12]&&!o[4]&&o[2]>=Xt&&Ms(o),h=!o[4]&&Ls(o);return{c(){e=$("div"),t=$("div"),n=$("div"),u.c(),i=D(),d&&d.c(),r=D(),h&&h.c(),p(n,"role","button"),p(n,"tabindex","0"),p(n,"class","script-name svelte-1tuc7xf"),p(t,"class","center-header svelte-1tuc7xf"),p(e,"class","center-panel svelte-1tuc7xf"),Oe(e,"hidden",!o[3].showHiddenTokens)},m(m,k){_(m,e,k),b(e,t),b(t,n),u.m(n,null),b(t,i),d&&d.m(t,null),b(e,r),h&&h.m(e,null),l=!0,a||(s=[ee(n,"click",o[19]),ee(n,"keydown",o[30])],a=!0)},p(m,k){f===(f=c(m))&&u?u.p(m,k):(u.d(1),u=f(m),u&&(u.c(),u.m(n,null))),m[12]&&!m[4]&&m[2]>=Xt?d?d.p(m,k):(d=Ms(m),d.c(),d.m(t,null)):d&&(d.d(1),d=null),m[4]?h&&(ne(),N(h,1,1,()=>{h=null}),oe()):h?(h.p(m,k),k[0]&16&&y(h,1)):(h=Ls(m),h.c(),y(h,1),h.m(e,null)),(!l||k[0]&8)&&Oe(e,"hidden",!m[3].showHiddenTokens)},i(m){l||(y(h),l=!0)},o(m){N(h),l=!1},d(m){m&&g(e),u.d(),d&&d.d(),h&&h.d(),a=!1,$e(s)}}}const Xt=5;function Zg(o,e,t){let n,i,r,l,a,s,c,f,u,d,h,m,k,w,O,I,T,E;se(o,q,ue=>t(3,O=ue)),se(o,ae,ue=>t(27,I=ue)),se(o,yc,ue=>t(28,T=ue)),se(o,wc,ue=>t(29,E=ue));let R="preparation",H=!1,A=0,M=0,U=null,v=Date.now(),Y=0,W=null,z=[];const B=()=>t(5,z=[...z,0]),L=ue=>t(5,z=z.filter((Q,fe)=>fe!==ue)),S=ue=>{t(5,z[ue]++,z),t(5,z=[...z])},P=ue=>{z[ue]>0&&(t(5,z[ue]--,z),t(5,z=[...z]))},K=ue=>{const Q=Math.floor(ue/60).toString().padStart(2,"0"),fe=(ue%60).toString().padStart(2,"0");return`${Q}:${fe}`},V=ue=>ue.filter(Q=>Q.alive&&ga(Q.roleId)!=="Fabled").length;function le(){t(4,H=!H)}function he(){_e(),U=setInterval(()=>{var ue,Q;t(22,M=Math.max(0,M-1)),M===Math.ceil(A/2)&&((ue=navigator.vibrate)==null||ue.call(navigator,[200,100,200,100,200])),M===0&&(_e(),t(0,R="dayOver"),(Q=navigator.vibrate)==null||Q.call(navigator,[200,100,200,100,200,100,200,100,200,100,200]))},1e3)}function _e(){U&&(clearInterval(U),U=null)}mt(()=>{W=setInterval(()=>{R==="night"&&t(23,Y=Math.floor((Date.now()-v)/1e3))},1e3),R==="preparation"&&q.update(ue=>({...ue,showNightLines:!1}))}),at(()=>{_e(),W&&clearInterval(W)});function Ie(ue){switch(ue){case"TO_NIGHT":t(0,R="night"),v=Date.now(),t(23,Y=0),q.update(Q=>({...Q,showNightLines:!0}));break;case"START":O.currentNightType==="first"&&q.update(Q=>({...Q,currentNightType:"other"})),q.update(Q=>({...Q,showNightLines:!1})),t(21,A=Math.max(0,i)*30),t(22,M=A),he(),t(0,R="running");break;case"PAUSE":_e(),t(0,R="paused");break;case"RESUME":he(),t(0,R="running");break;case"END":_e(),q.update(Q=>({...Q,showNightLines:!0})),t(21,A=0),t(22,M=0),t(0,R="night"),v=Date.now(),t(23,Y=0);break}}const rt={preparation:()=>Ie("TO_NIGHT"),night:()=>Ie("START"),running:()=>Ie("PAUSE"),paused:()=>Ie("RESUME"),dayOver:()=>Ie("END")};function Xe(){var ue;(ue=rt[R])==null||ue.call(rt)}const tt=ue=>(ue.key==="Enter"||ue.key===" ")&&le(),pt=()=>q.update(ue=>({...ue,showSetupModal:!0})),Be=()=>q.update(ue=>({...ue,showNightOrderModal:!0})),Je=ue=>P(ue),Ze=ue=>S(ue),Qe=ue=>L(ue);return o.$$.update=()=>{o.$$.dirty[0]&134217728&&t(2,n=I.playerTokens.length),o.$$.dirty[0]&134217728&&t(1,i=V(I.playerTokens)),o.$$.dirty[0]&2&&t(14,r=Math.ceil(i/2)),o.$$.dirty[0]&134217728&&t(13,l=I.script.meta.name),o.$$.dirty[0]&536870912&&t(26,a=E),o.$$.dirty[0]&67108864&&t(12,s=(()=>{try{const ue=hn(a);return`${ue.Townsfolk}-${ue.Outsiders}-${ue.Minions}-${ue.Demons}`}catch{return null}})()),o.$$.dirty[0]&67108864&&t(25,c=(()=>{try{return hn(a).Demons}catch{return 0}})()),o.$$.dirty[0]&301989888&&t(24,f=c>0&&T===0),o.$$.dirty[0]&150994944&&t(11,u=(()=>{const ue=I.playerTokens.filter(Q=>Q.alive);return f?{text:"Good victory",color:"teal"}:ue.length===4?{text:"Final Four",color:"darkred"}:ue.length===3?{text:"Final Three",color:"red"}:ue.length<=2&&!f?{text:"Evil victory",color:"red"}:null})()),o.$$.dirty[0]&5&&t(10,d=R==="preparation"||n<Xt),o.$$.dirty[0]&1&&t(9,h=R==="night"),o.$$.dirty[0]&1&&t(8,m=R==="running"||R==="paused"),o.$$.dirty[0]&6291465&&t(7,k=R==="preparation"?"Final preparations: Assign reminder tokens and organize Grimoire.":O.showHiddenTokens?R==="night"&&O.currentNightType==="first"&&O.showHiddenTokens?"The purple line shows who to wake in what order. Open Night Order button.":R==="running"?M>Math.ceil(A/2)?"It is morning. Reveal who died last night, if any.":"Mid-day. Open for nominations if you haven't yet.":R==="paused"?"Optionally prohibit spoken communication during pauses":R==="dayOver"?"The sun has set. Finish any executions. Put the town to sleep.":"":"Double-tap board to toggle hiding roles"),o.$$.dirty[0]&12582921&&t(6,w=(()=>{switch(R){case"preparation":return"Start first night";case"night":return`${O.currentNightType==="first"?"End First Night":"End Night"} — ${K(Y)}`;case"running":return`${K(M)} Until Sunset`;case"paused":return"Timer paused";case"dayOver":return"End Day, Start Night"}})())},[R,i,n,O,H,z,w,k,m,h,d,u,s,l,r,B,L,S,P,le,Xe,A,M,Y,f,c,a,I,T,E,tt,pt,Be,Je,Ze,Qe]}class Qg extends ye{constructor(e){super(),we(this,e,Zg,Jg,ke,{},null,[-1,-1])}}function xg(o){let e,t,n,i;return{c(){e=$("div"),t=$("textarea"),p(t,"placeholder","Write your notes here…"),p(t,"class","svelte-1otdae1"),p(e,"class","notes-content svelte-1otdae1")},m(r,l){_(r,e,l),b(e,t),Ne(t,o[1]),n||(i=[ee(t,"input",o[5]),ee(t,"input",o[2])],n=!0)},p(r,l){l&2&&Ne(t,r[1])},d(r){r&&g(e),n=!1,$e(i)}}}function e1(o){let e;return{c(){e=C("Close")},m(t,n){_(t,e,n)},d(t){t&&g(e)}}}function t1(o){let e,t;return e=new Z({props:{$$slots:{default:[e1]},$$scope:{ctx:o}}}),e.$on("click",o[3]),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&128&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function n1(o){let e,t;return e=new De({props:{show:o[0].showNotesModal,title:"Notes",onClose:o[3],$$slots:{footer:[t1],default:[xg]},$$scope:{ctx:o}}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,[i]){const r={};i&1&&(r.show=n[0].showNotesModal),i&130&&(r.$$scope={dirty:i,ctx:n}),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function o1(o,e,t){let n;se(o,q,f=>t(0,n=f));let i="",r=null,l;l||(l=Ke.subscribe(f=>{if(!r)return;const u=f.find(h=>h.uuid===r),d=(u==null?void 0:u.notes)??"";d!==i&&t(1,i=d)})),at(()=>l==null?void 0:l());function a(f){t(1,i=f.target.value),r&&Ke.update(u=>u.map(d=>d.uuid===r?{...d,notes:i}:d))}function s(){q.update(f=>({...f,showNotesModal:!1}))}function c(){i=this.value,t(1,i),t(0,n),t(4,r)}return o.$$.update=()=>{if(o.$$.dirty&17){const f=n.activeSessionUuid;if(f!==r){t(4,r=f);const d=re(Ke).find(h=>h.uuid===f);t(1,i=(d==null?void 0:d.notes)??"")}}},[n,i,a,s,r,c]}class i1 extends ye{constructor(e){super(),we(this,e,o1,n1,ke,{})}}function Fs(o){let e,t;return e=new Bf({}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function js(o){let e,t;return e=new Ru({}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function zs(o){let e,t;return e=new gm({}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Ks(o){let e,t;return e=new Da({}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Ws(o){let e,t;return e=new Wu({}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function qs(o){let e,t;return e=new Lh({}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Vs(o){let e,t;return e=new Zh({props:{script:o[1].script.roles}}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},p(n,i){const r={};i&2&&(r.script=n[1].script.roles),e.$set(r)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Xs(o){let e,t;return e=new cm({}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Js(o){let e,t;return e=new Lg({}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Zs(o){let e,t;return e=new Xm({}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Qs(o){let e,t;return e=new i1({}),{c(){j(e.$$.fragment)},m(n,i){G(e,n,i),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function r1(o){let e,t,n,i,r,l,a,s,c,f,u,d,h,m,k,w,O,I,T,E,R,H;t=new vf({}),i=new Rp({}),l=new yg({}),s=new Qg({});let A=o[0].showNightOrderModal&&Fs(),M=o[0].showEditModal&&js(),U=o[0].showScriptAlmanacModal&&zs(),v=o[0].showCardSelectionModal&&Ks(),Y=o[0].showCardModal&&o[0].currentCard&&Ws(),W=o[0].showSetupModal&&qs(),z=o[0].showRoleSelectionModal&&Vs(o),B=o[0].showAddReminderModal&&Xs(),L=o[0].showTokenBagModal&&Js(),S=o[0].showBluffsModal&&Zs(),P=o[0].showNotesModal&&Qs();return R=new Sm({}),{c(){e=$("main"),j(t.$$.fragment),n=D(),j(i.$$.fragment),r=D(),j(l.$$.fragment),a=D(),j(s.$$.fragment),c=D(),A&&A.c(),f=D(),M&&M.c(),u=D(),U&&U.c(),d=D(),v&&v.c(),h=D(),Y&&Y.c(),m=D(),W&&W.c(),k=D(),z&&z.c(),w=D(),B&&B.c(),O=D(),L&&L.c(),I=D(),S&&S.c(),T=D(),P&&P.c(),E=D(),j(R.$$.fragment),p(e,"class","main dark svelte-19lgug0")},m(K,V){_(K,e,V),G(t,e,null),b(e,n),G(i,e,null),b(e,r),G(l,e,null),b(e,a),G(s,e,null),b(e,c),A&&A.m(e,null),b(e,f),M&&M.m(e,null),b(e,u),U&&U.m(e,null),b(e,d),v&&v.m(e,null),b(e,h),Y&&Y.m(e,null),b(e,m),W&&W.m(e,null),b(e,k),z&&z.m(e,null),b(e,w),B&&B.m(e,null),b(e,O),L&&L.m(e,null),b(e,I),S&&S.m(e,null),b(e,T),P&&P.m(e,null),b(e,E),G(R,e,null),H=!0},p(K,[V]){K[0].showNightOrderModal?A?V&1&&y(A,1):(A=Fs(),A.c(),y(A,1),A.m(e,f)):A&&(ne(),N(A,1,1,()=>{A=null}),oe()),K[0].showEditModal?M?V&1&&y(M,1):(M=js(),M.c(),y(M,1),M.m(e,u)):M&&(ne(),N(M,1,1,()=>{M=null}),oe()),K[0].showScriptAlmanacModal?U?V&1&&y(U,1):(U=zs(),U.c(),y(U,1),U.m(e,d)):U&&(ne(),N(U,1,1,()=>{U=null}),oe()),K[0].showCardSelectionModal?v?V&1&&y(v,1):(v=Ks(),v.c(),y(v,1),v.m(e,h)):v&&(ne(),N(v,1,1,()=>{v=null}),oe()),K[0].showCardModal&&K[0].currentCard?Y?V&1&&y(Y,1):(Y=Ws(),Y.c(),y(Y,1),Y.m(e,m)):Y&&(ne(),N(Y,1,1,()=>{Y=null}),oe()),K[0].showSetupModal?W?V&1&&y(W,1):(W=qs(),W.c(),y(W,1),W.m(e,k)):W&&(ne(),N(W,1,1,()=>{W=null}),oe()),K[0].showRoleSelectionModal?z?(z.p(K,V),V&1&&y(z,1)):(z=Vs(K),z.c(),y(z,1),z.m(e,w)):z&&(ne(),N(z,1,1,()=>{z=null}),oe()),K[0].showAddReminderModal?B?V&1&&y(B,1):(B=Xs(),B.c(),y(B,1),B.m(e,O)):B&&(ne(),N(B,1,1,()=>{B=null}),oe()),K[0].showTokenBagModal?L?V&1&&y(L,1):(L=Js(),L.c(),y(L,1),L.m(e,I)):L&&(ne(),N(L,1,1,()=>{L=null}),oe()),K[0].showBluffsModal?S?V&1&&y(S,1):(S=Zs(),S.c(),y(S,1),S.m(e,T)):S&&(ne(),N(S,1,1,()=>{S=null}),oe()),K[0].showNotesModal?P?V&1&&y(P,1):(P=Qs(),P.c(),y(P,1),P.m(e,E)):P&&(ne(),N(P,1,1,()=>{P=null}),oe())},i(K){H||(y(t.$$.fragment,K),y(i.$$.fragment,K),y(l.$$.fragment,K),y(s.$$.fragment,K),y(A),y(M),y(U),y(v),y(Y),y(W),y(z),y(B),y(L),y(S),y(P),y(R.$$.fragment,K),H=!0)},o(K){N(t.$$.fragment,K),N(i.$$.fragment,K),N(l.$$.fragment,K),N(s.$$.fragment,K),N(A),N(M),N(U),N(v),N(Y),N(W),N(z),N(B),N(L),N(S),N(P),N(R.$$.fragment,K),H=!1},d(K){K&&g(e),F(t),F(i),F(l),F(s),A&&A.d(),M&&M.d(),U&&U.d(),v&&v.d(),Y&&Y.d(),W&&W.d(),z&&z.d(),B&&B.d(),L&&L.d(),S&&S.d(),P&&P.d(),F(R)}}}function l1(o,e,t){let n,i;return se(o,q,r=>t(0,n=r)),se(o,ae,r=>t(1,i=r)),mt(()=>{var l;yf();const r=re(ae);if(!((l=r.script.roles)!=null&&l.length)){const a=kc("Trouble Brewing")??Bn[0];ae.update(s=>({...s,script:{meta:{...a.meta},roles:[...a.roles]}}))}if(r.playerTokens.length){const a=Math.max(...r.playerTokens.map(s=>s.id));q.update(s=>({...s,counters:{...s.counters,playerId:a+1}}))}if(!r.ReminderTokens)ae.update(a=>({...a,ReminderTokens:[]}));else if(r.ReminderTokens.length){const a=Math.max(...r.ReminderTokens.map(s=>s.id));q.update(s=>({...s,counters:{...s.counters,reminderId:a+1}}))}on()}),at(mc),[n,i]}class s1 extends ye{constructor(e){super(),we(this,e,l1,r1,ke,{})}}new s1({target:document.getElementById("app")});
